import{p as D,s as N,r as k,a as f,o as i,c as v,w as s,Q as B,Z as I,S as U,d as t,e as a,q as x,i as m,t as Q,v as r,z,f as A,g as E,m as _,y as l,K as d,M as S,L,l as C}from"./index.351af1d7.js";import{Q as p,a as O,b as R,c as F}from"./QTable.7c6f0bf6.js";import{Q as j}from"./QCard.03e4047e.js";import{Q as K}from"./QImg.e803a09f.js";import{Q as M}from"./QResponsive.4435ee0f.js";import{u as Z}from"./use-quasar.22aafa5d.js";const G={id:"myheader",class:"row justify-end items-center",style:{width:"100%"}},H=_(" \u56DE\u524D\u53F0 "),J=_(" \u767B\u51FA "),W={id:"mycontent",class:""},X=t("div",{class:"row justify-between"},[t("div",{class:"col-auto text-h3 text-secondary q-my-sm"},"\u8A02\u55AE\u7BA1\u7406")],-1),Y={class:"col-12 q-pa-md",style:{width:"100%"}},tt={class:"row justify-center"},et=_("\u8A02\u55AE\u8A73\u60C5"),st={class:"full-width row flex-center text-accent text-h5 q-gutter-sm"},ot={class:"col-12 col-sm-6 col-md-4 col-lg-3 q-pa-sm cursor-pointer"},at={key:0,class:"text-left q-mx-auto"},lt={class:"row justify-between items-center"},ct={class:"text-accent"},it={class:"text-secondary text-body2 text-right ellipsis-3-lines"},nt={key:1,class:"text-left q-mx-auto"},dt={class:"row justify-between"},rt={class:"text-accent"},_t={class:"text-secondary text-body2 text-right text-wrap"},ut={key:2,class:"text-left q-mx-auto"},mt={class:"row justify-between"},ht={class:"text-accent"},xt={class:"text-secondary text-body2 text-right text-wrap"},gt={key:3,class:"text-left q-mx-auto"},ft={class:"row justify-between"},vt={class:"text-accent"},pt={class:"text-secondary text-right ellipsis-3-lines"},wt={key:4,class:"text-left q-mx-auto"},yt={class:"row justify-between"},bt={class:"text-accent"},qt=_("\u8A02\u55AE\u8A73\u60C5"),kt=t("div",{class:"col-12 text-center text-h3 text-accent q-pb-md"},"\u8A02\u55AE\u8A73\u60C5",-1),Qt={class:"row q-pa-md",style:{width:"100%",border:"1px solid #1E1918"}},St={class:"col-12 row"},Lt=t("div",{class:"col-12 col-sm-auto text-h6 text-accent"},"\u8A02\u55AE\u7DE8\u865F\uFF1A",-1),Ct={class:"col-12 col-sm-auto text-sm-h6 text-dark"},jt={class:"col-12 row"},Pt=t("div",{class:"col-12 col-sm-auto text-h6 text-accent"},"\u8A02\u8CFC\u6703\u54E1\uFF1A",-1),Vt={class:"col-12 col-sm-auto text-sm-h6 text-dark"},Tt={class:"col-12 row"},$t=t("div",{class:"col-12 col-sm-auto text-h6 text-accent"},"\u8A02\u55AE\u65E5\u671F\uFF1A",-1),Dt={class:"col-12 col-sm-auto text-sm-h6 text-dark"},Nt={class:"row"},Bt={class:"col-12 col-lg-3"},It={class:"col-12 col-lg-9 row q-px-lg-lg"},Ut={class:"col-12 row"},zt=t("div",{class:"col-12 col-sm-auto text-h6 text-accent"},"\u5546\u54C1\u540D\u7A31\uFF1A\xA0",-1),At={class:"col-12 col-sm text-sm-h6 text-dark"},Et={class:"col-12 row"},Ot=t("div",{class:"col-12 col-sm-auto text-h6 text-accent"},"\u5546\u54C1\u91D1\u984D\uFF1A\xA0 ",-1),Rt={class:"col-12 col-sm text-sm-h6 text-dark"},Ft={class:"col-12 row"},Kt=t("div",{class:"col-12 col-sm-auto text-h6 text-accent"},"\u8A02\u8CFC\u6578\u91CF\uFF1A\xA0",-1),Mt={class:"col-12 col-sm text-sm-h6 text-dark"},Zt={class:"col-12 text-h6 text-accent text-right"},Gt=_("\u5C0F\u8A08\uFF1A\xA0"),Ht={class:"text-dark"},Jt={class:"col-12 row justify-end q-px-lg-lg"},Wt=t("div",{class:"col-12 col-lg-auto text-h4 text-accent q-my-sm"},"\u8A02\u55AE\u91D1\u984D\uFF1A",-1),Xt={class:"col-12 col-lg-auto text-h4 text-warning text-right q-my-sm"},Yt={class:"col-12 row justify-around"},de={__name:"AdminOrderView",setup(te){const w=D(),{logout:P}=w,{isLogin:y}=N(w),g=k(""),V=Z(),T=f({items:[],page:1,rowsPerPage:0}),b=f([]),h=f({dialog:!1}),u=k(""),q=c=>{u.value=c,h.dialog=!0},$=[{name:"date",label:"\u8A02\u55AE\u65E5\u671F",field:c=>c.date,required:!0,align:"center"},{name:"id",label:"\u8A02\u55AE\u7DE8\u865F",field:c=>c._id,required:!0,align:"center"},{name:"account",label:"\u8A02\u8CFC\u6703\u54E1",field:c=>c.user.account,required:!0,align:"center"},{name:"totalPrice",label:"\u8A02\u55AE\u91D1\u984D",field:c=>c.totalPrice,align:"center"},{name:"detail",label:"\u8A02\u55AE\u8A73\u60C5",align:"center"}];return(async()=>{try{const{data:c}=await I.get("/orders/all");b.push(...c.result.map(n=>(n.totalPrice=n.products.reduce((e,o)=>e+o.price*o.quantity,0),n)))}catch(c){console.log(c),U.fire({icon:"error",title:"\u5931\u6557",text:"\u7121\u6CD5\u53D6\u5F97\u8A02\u55AE"})}})(),(c,n)=>(i(),v(B,{class:"column"},{default:s(()=>[t("div",G,[a(z,{class:"text-h5 text-secondary mobile-none"},{default:s(()=>[x(y)?(i(),v(m,{key:0,round:"",dense:"",flat:"",icon:"fa-solid fa-house",to:"/",class:"q-mx-xs"},{default:s(()=>[a(Q,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:s(()=>[H]),_:1})]),_:1})):r("",!0),x(y)?(i(),v(m,{key:1,round:"",dense:"",flat:"",icon:"fa-solid fa-right-from-bracket",onClick:x(P),class:"q-ml-xl q-mr-lg"},{default:s(()=>[a(Q,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:s(()=>[J]),_:1})]),_:1},8,["onClick"])):r("",!0)]),_:1})]),t("div",W,[X,t("div",Y,[a(R,{grid:x(V).screen.lt.xl,columns:$,rows:b,"row-key":"name",square:"",bordered:"","wrap-cells":"","binary-state-sort":"",dense:"",filter:g.value,loading:c.loading,pagination:T,"no-data-label":"\u76EE\u524D\u6C92\u6709\u4EFB\u4F55\u8A02\u55AE","rows-per-page-label":"\u6BCF\u9801\u986F\u793A\u7B46\u6578","no-results-label":"Oops...\u627E\u4E0D\u5230\u8A72\u7B46\u8A02\u55AE"},{"top-right":s(()=>[a(A,{borderless:"",dense:"",debounce:"300",modelValue:g.value,"onUpdate:modelValue":n[0]||(n[0]=e=>g.value=e),placeholder:"\xA0Search",class:"search"},{append:s(()=>[a(E,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-date":s(e=>[a(p,{date:e,align:"center"},{default:s(()=>[_(l(new Date(e.value).toLocaleString()),1)]),_:2},1032,["date"])]),"body-cell-totalPrice":s(e=>[a(p,{totalPrice:e,align:"center"},{default:s(()=>[_(" NT$ "+l(e.row.totalPrice.toLocaleString()),1)]),_:2},1032,["totalPrice"])]),"body-cell-detail":s(e=>[a(p,{detail:e},{default:s(()=>[t("div",tt,[a(m,{class:"col-auto q-mx-sm",onClick:o=>q(e),outline:""},{default:s(()=>[et]),_:2},1032,["onClick"])])]),_:2},1032,["detail"])]),"no-data":s(({message:e})=>[t("div",st,[t("span",null,l(e),1)])]),item:s(e=>[t("div",ot,[a(j,{onClick:o=>c.openDialog(e.row._id,e.rowIndex),square:"",bordered:"",class:"bg-primary shadow",style:{}},{default:s(()=>[(i(!0),d(L,null,S(e.cols,o=>(i(),d("div",{key:o.name,class:"q-pa-sm"},[o.name==="date"?(i(),d("div",at,[t("div",lt,[t("span",ct,l(o.label)+"\uFF1A",1),t("span",it,l(new Date(o.value).toLocaleString()),1)])])):r("",!0),o.name==="id"?(i(),d("div",nt,[t("div",dt,[t("span",rt,l(o.label)+"\uFF1A",1),t("span",_t,l(o.value),1)])])):r("",!0),o.name==="account"?(i(),d("div",ut,[t("div",mt,[t("span",ht,l(o.label)+"\uFF1A",1),t("span",xt,l(o.value),1)])])):r("",!0),o.name==="totalPrice"?(i(),d("div",gt,[t("div",ft,[t("span",vt,l(o.label)+"\uFF1A",1),t("span",pt,"NT$ "+l(o.value.toLocaleString()),1)])])):r("",!0),o.name==="detail"?(i(),d("div",wt,[t("div",yt,[t("span",bt,l(o.label)+"\uFF1A",1),a(m,{class:"col-auto text-secondary",style:{"font-size":"xx-small",padding:"0px 8px"},onClick:se=>q(e),outline:""},{default:s(()=>[qt]),_:2},1032,["onClick"])])])):r("",!0)]))),128))]),_:2},1032,["onClick"])])]),loading:s(()=>[a(O,{showing:"",dark:"","transition-show":"fade",color:"primary"})]),_:1},8,["grid","rows","filter","loading","pagination"])]),a(F,{modelValue:h.dialog,"onUpdate:modelValue":n[2]||(n[2]=e=>h.dialog=e),seamless:"",style:{width:"auto"}},{default:s(()=>[a(j,{square:"",class:"row justify-center bg-info q-pa-lg",style:{width:"100%"}},{default:s(()=>[kt,t("div",Qt,[t("div",St,[Lt,t("div",Ct,l(u.value.row._id),1)]),t("div",jt,[Pt,t("div",Vt,l(u.value.row.user.account),1)]),t("div",Tt,[$t,t("div",Dt,l(new Date(u.value.row.date).toLocaleString()),1)]),a(C,{class:"bg-dark text-center q-mx-auto q-my-sm",style:{width:"95%"}}),(i(!0),d(L,null,S(u.value.row.products,e=>(i(),d("div",{key:e._id,class:"col-12 text-accent"},[t("div",Nt,[t("div",Bt,[a(M,{ratio:3/2},{default:s(()=>[a(K,{src:e.product.image[0]},null,8,["src"])]),_:2},1024)]),t("div",It,[t("div",Ut,[zt,t("div",At,l(e.product.name),1)]),t("div",Et,[Ot,t("div",Rt,"NT$ "+l(e.price.toLocaleString()),1)]),t("div",Ft,[Kt,t("div",Mt,l(e.quantity),1)]),t("div",Zt,[Gt,t("span",Ht,"NT$ "+l((e.price*e.quantity).toLocaleString()),1)])])]),a(C,{class:"bg-dark text-center q-mx-auto q-my-sm",style:{width:"95%"}})]))),128)),t("div",Jt,[Wt,t("div",Xt,"NT$ "+l(u.value.row.totalPrice.toLocaleString()),1)])]),t("div",Yt,[a(m,{square:"",flat:"",outline:"",class:"col-4 bg-dark text-secondary q-my-sm",label:"\u95DC\u9589",onClick:n[1]||(n[1]=e=>h.dialog=!1)})])]),_:1})]),_:1},8,["modelValue"])])]),_:1}))}};export{de as default};
