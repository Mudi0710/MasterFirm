import{p as I,s as z,a as V,D as q,b as L,o as l,c as _,w as t,Q as N,aY as T,S,d as o,e as s,q as r,i as d,t as p,v as f,x as A,m as i,y as c,z as D,L as y,M as E,N as P}from"./index.6f5e4583.js";import{Q as v,a as R}from"./QBreadcrumbs.05e5237d.js";import{Q as F}from"./QAvatar.828127eb.js";import{Q as w}from"./QTd.b07258a5.js";import{Q as M}from"./QResponsive.863b432f.js";import{Q as U}from"./QCard.03892463.js";import{Q as Y,a as G}from"./QTable.e6f5120b.js";import"./QDialog.68934308.js";const H={id:"myheader",class:"row justify-end items-center",style:{width:"100%"}},J=i(" \u6703\u54E1\u8CC7\u6599 "),K=i(" \u8A02\u55AE\u67E5\u8A62 "),O=i(" \u8CFC\u7269\u8ECA "),W=i(" \u7BA1\u7406\u5F8C\u53F0 "),X=i(" \u8A3B\u518A "),Z=i(" \u767B\u5165 "),tt=i(" \u767B\u51FA "),et={id:"mycontent",class:"col-12 row content-start"},st=o("div",{class:"col-12 text-h4 text-xl-h3 text-secondary q-mb-md q-pl-md",style:{width:"100%"}},"\u8CFC\u7269\u8ECA",-1),at={class:"col-12 q-mt-md q-pl-lg",style:{width:"100%"}},ot={class:"col-12 q-pa-md",style:{width:"100%"}},nt=["src"],it={class:"row justify-end"},lt=i("-"),dt={class:"row justify-start"},rt=i("+"),ct={class:"row justify-center"},ut=i("\u522A\u9664\u5546\u54C1"),_t={class:"row justify-end content-end items-end q-mt-md",style:{width:"100%"}},ft=o("div",{class:"text-h4 text-accent",style:{width:"200px"}},"\u7E3D\u91D1\u984D\uFF1A",-1),mt={class:"text-h4"},ht={class:"col-12 row justify-between q-my-md"},pt=i("\u7E7C\u7E8C\u8CFC\u7269"),xt=i("\u7D50\u5E33 "),yt={class:"full-width row flex-center text-accent text-h5 q-gutter-sm"},wt={class:"col-12 col-sm-6 col-md-4 col-lg-3 q-pa-sm cursor-pointer"},gt=["src"],kt={key:1,class:"text-left q-mx-auto"},bt={class:"row justify-between"},qt={class:"text-accent"},vt={class:"text-secondary text-right"},Ct={key:2,class:"text-left q-mx-auto"},Qt={class:"row justify-between items-center"},jt={class:"text-accent"},$t={key:3,class:"text-left q-mx-auto"},Bt={class:"row justify-between items-center"},It={class:"text-accent"},zt=i("-"),Vt={class:"text-secondary text-right"},Lt=i("+"),Nt={key:4,class:"text-left q-mx-auto"},Tt={class:"row justify-between"},St={class:"text-accent"},At=i("\u522A\u9664\u5546\u54C1"),Jt={__name:"CartView",setup(Dt){const g=I(),{logout:C}=g,{isLogin:m,isAdmin:Q}=z(g),u=V([]),j=q(()=>u.reduce((a,h)=>a+h.product.price*h.quantity,0)),x=async(a,h)=>{await g.updateCart({product:u[a].product._id,quantity:h})&&(h===0?u.splice(a,1):u[a].quantity=h)},$=q(()=>u.length>0&&!u.some(a=>!a.product.sell)),B=[{name:"image",label:"\u5546\u54C1\u5716\u7247",field:a=>a.product.image[0],required:!0,align:"center"},{name:"name",label:"\u5546\u54C1\u540D\u7A31",field:a=>a.product.name,format:a=>`${a}`,required:!0,align:"center"},{name:"inventory",label:"\u5546\u54C1\u72C0\u614B",field:a=>a.product.inventory?"\u6709\u73FE\u8CA8":"\u8A02\u8CFC\u5F8C\u88FD\u4F5C",align:"center"},{name:"price",label:"\u5546\u54C1\u55AE\u50F9",field:a=>a.product.price,align:"center"},{name:"minus",align:"right"},{name:"quantity",label:"\u8A02\u8CFC\u6578\u91CF",field:a=>a.quantity,align:"center"},{name:"add",align:"left"},{name:"sum",label:"\u91D1\u984D\u5C0F\u8A08",field:a=>a.product.price*a.quantity,align:"center"},{name:"edit",label:"\u5546\u54C1\u7DE8\u8F2F",align:"center"}];return(async()=>{try{const{data:a}=await T.get("/users/cart");u.push(...a.result)}catch{S.fire({icon:"error",title:"\u5931\u6557",text:"\u4F3A\u670D\u5668\u932F\u8AA4"})}})(),(a,h)=>{const k=L("router-link");return l(),_(N,{id:"CartView",class:"column"},{default:t(()=>[o("div",H,[s(D,{class:"text-h5 text-secondary mobile-none"},{default:t(()=>[r(m)?(l(),_(d,{key:0,round:"",dense:"",flat:"",icon:"fa-solid fa-address-card",to:"/member",class:"q-mx-xs"},{default:t(()=>[s(p,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:t(()=>[J]),_:1})]),_:1})):f("",!0),r(m)?(l(),_(d,{key:1,round:"",dense:"",flat:"",icon:"fa-solid fa-receipt",to:"/order",class:"q-mx-xs"},{default:t(()=>[s(p,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:t(()=>[K]),_:1})]),_:1})):f("",!0),r(m)?(l(),_(d,{key:2,round:"",dense:"",flat:"",icon:"fa-solid fa-cart-shopping",to:"/cart",class:"q-mx-xs"},{default:t(()=>[s(p,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:t(()=>[O]),_:1}),u.length>0?(l(),_(A,{key:0,floating:"",color:"red",rounded:""},{default:t(()=>[i(c(u.length),1)]),_:1})):f("",!0)]),_:1})):f("",!0),r(m)&&r(Q)?(l(),_(d,{key:3,round:"",dense:"",flat:"",icon:"fa-solid fa-user-gear",to:"/admin",class:"q-mx-xs"},{default:t(()=>[s(p,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:t(()=>[W]),_:1})]),_:1})):f("",!0),r(m)?f("",!0):(l(),_(d,{key:4,round:"",dense:"",flat:"",icon:"fa-solid fa-user-plus",to:"/register",class:"q-mx-xs"},{default:t(()=>[s(p,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:t(()=>[X]),_:1})]),_:1})),r(m)?f("",!0):(l(),_(d,{key:5,round:"",dense:"",flat:"",icon:"fa-solid fa-right-to-bracket",to:"/login",class:"q-ml-xs q-mr-sm"},{default:t(()=>[s(p,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:t(()=>[Z]),_:1})]),_:1})),r(m)?(l(),_(d,{key:6,round:"",dense:"",flat:"",icon:"fa-solid fa-right-from-bracket",onClick:r(C),class:"q-ml-xl q-mr-md"},{default:t(()=>[s(p,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:t(()=>[tt]),_:1})]),_:1},8,["onClick"])):f("",!0)]),_:1})]),o("div",et,[st,o("div",at,[s(R,null,{default:t(()=>[s(v,{label:"\u9996\u9801",icon:"fa-solid fa-house",to:"/"}),s(v,{label:"\u8CFC\u7269\u8ECA",icon:"fa-solid fa-store"})]),_:1})]),o("div",ot,[s(G,{grid:a.$q.screen.lt.xl,columns:B,rows:u,"row-key":"name",square:"",bordered:"","wrap-cells":"","binary-state-sort":"",dense:"",loading:a.loading,"no-data-label":"\u76EE\u524D\u6C92\u6709\u9078\u8CFC\u4EFB\u4F55\u5546\u54C1","rows-per-page-label":"\u6BCF\u9801\u986F\u793A\u7B46\u6578"},{"body-cell-image":t(e=>[s(w,{img:e,align:"center",ellipsis:""},{default:t(()=>[s(F,{square:"",size:"100px"},{default:t(()=>[o("img",{src:e.row.product.image,class:"q-mb-xl",style:{"object-fit":"cover"}},null,8,nt)]),_:2},1024)]),_:2},1032,["img"])]),"body-cell-name":t(e=>[s(w,{name:e,align:"center",ellipsis:""},{default:t(()=>[s(k,{to:{name:"product",params:{id:e.row.product._id}}},{default:t(()=>[i(c(e.row.product.name),1)]),_:2},1032,["to"])]),_:2},1032,["name"])]),"body-cell-minus":t(e=>[s(w,{minus:e},{default:t(()=>[o("div",it,[s(d,{class:"col-auto",style:{"font-size":"xx-small",padding:"0px 8px"},onClick:n=>x(e.rowIndex,e.row.quantity-1),outline:""},{default:t(()=>[lt]),_:2},1032,["onClick"])])]),_:2},1032,["minus"])]),"body-cell-add":t(e=>[s(w,{add:e},{default:t(()=>[o("div",dt,[s(d,{class:"col-auto",style:{"font-size":"xx-small",padding:"0px 8px"},onClick:n=>x(e.rowIndex,e.row.quantity+1),outline:""},{default:t(()=>[rt]),_:2},1032,["onClick"])])]),_:2},1032,["add"])]),"body-cell-edit":t(e=>[s(w,{edit:e},{default:t(()=>[o("div",ct,[s(d,{class:"col-auto q-mx-sm",onClick:n=>x(e.rowIndex,0),outline:""},{default:t(()=>[ut]),_:2},1032,["onClick"])])]),_:2},1032,["edit"])]),bottom:t(()=>[o("div",_t,[ft,o("div",mt,c(r(j)),1)]),o("div",ht,[s(d,{square:"",class:"col-5 bg-secondary text-dark text-h6",style:{width:"auto"},to:"/products"},{default:t(()=>[pt]),_:1}),s(d,{square:"",class:"col-5 bg-secondary text-dark text-h6",style:{"min-width":"51.44px","max-width":"270px"},onClick:r(g).checkout,disabled:!r($)},{default:t(()=>[xt]),_:1},8,["onClick","disabled"])])]),"no-data":t(({message:e})=>[o("div",yt,[o("span",null,c(e),1)])]),item:t(e=>[o("div",wt,[s(U,{onClick:n=>a.openDialog(e.row._id,e.rowIndex),square:"",bordered:"",class:"bg-primary shadow"},{default:t(()=>[(l(!0),y(P,null,E(e.cols,n=>(l(),y("div",{key:n.name,class:"q-pa-sm"},[n.name=="image"?(l(),_(M,{key:0,ratio:3/2},{default:t(()=>[o("img",{src:e.row.product.image,class:"col",style:{width:"100%"}},null,8,gt)]),_:2},1024)):n.name!=="image"&&n.name!=="name"&&n.name!=="minus"&&n.name!=="quantity"&&n.name!=="add"&&n.name!=="edit"?(l(),y("div",kt,[o("div",bt,[o("span",qt,c(n.label)+"\uFF1A",1),o("span",vt,c(n.value),1)])])):n.name==="name"?(l(),y("div",Ct,[o("div",Qt,[o("span",jt,c(n.label)+"\uFF1A",1),s(k,{to:{name:"product",params:{id:e.row.product._id}},class:"text-secondary text-right"},{default:t(()=>[i(c(n.value),1)]),_:2},1032,["to"])])])):n.name==="quantity"?(l(),y("div",$t,[o("div",Bt,[o("span",It,c(n.label)+"\uFF1A",1),s(d,{class:"col-auto text-secondary",style:{"font-size":"xx-small",padding:"0px 8px"},onClick:b=>x(e.rowIndex,e.row.quantity-1),outline:""},{default:t(()=>[zt]),_:2},1032,["onClick"]),o("span",Vt,c(n.value),1),s(d,{class:"col-auto text-secondary",style:{"font-size":"xx-small",padding:"0px 8px"},onClick:b=>x(e.rowIndex,e.row.quantity+1),outline:""},{default:t(()=>[Lt]),_:2},1032,["onClick"])])])):n.name==="edit"?(l(),y("div",Nt,[o("div",Tt,[o("span",St,c(n.label)+"\uFF1A",1),s(d,{class:"col-auto text-secondary",style:{"font-size":"xx-small",padding:"0px 8px"},onClick:b=>x(e.rowIndex,0),outline:""},{default:t(()=>[At]),_:2},1032,["onClick"])])])):f("",!0)]))),128))]),_:2},1032,["onClick"])])]),loading:t(()=>[s(Y,{showing:"",dark:"","transition-show":"fade",color:"primary"})]),_:1},8,["grid","rows","loading"])])])]),_:1})}}};export{Jt as default};
