import{p as R,s as O,r as D,a as _,o as c,c as p,w as o,Q as G,aY as q,S as x,d as i,e as a,q as m,i as n,t as j,v as f,z as Y,m as r,y as g,L as v,M as H,N as J,k as K,j as W,f as X}from"./index.bd723817.js";import{Q as N}from"./QTd.4d4c3603.js";import{Q}from"./QCard.1f519bc5.js";import{Q as Z,a as ee}from"./QTable.1e7ee619.js";import{Q as te}from"./QEditor.b7808443.js";import{Q as I}from"./QDialog.8116c064.js";import{u as se}from"./use-quasar.21f5a986.js";const oe={id:"myheader",class:"row justify-end items-center",style:{width:"100%"}},ae=r(" \u56DE\u524D\u53F0 "),ie=r(" \u767B\u51FA "),le={id:"mycontent"},ne=i("div",{class:"row justify-between"},[i("div",{class:"col-auto text-h3 text-secondary q-my-sm q-pl-md"},"\u9810\u7D04\u7BA1\u7406")],-1),re={class:"q-pa-md"},de=i("div",{class:"bg-accent text-h5 text-dark q-my-sm",style:{height:"1px"}},null,-1),ce=i("div",{class:"text-h5 text-accent q-my-sm",style:{height:"40px","line-height":"1.6em"}},"\u9810\u7D04\u9808\u77E5",-1),ue=r("\u65B0\u589E\u9810\u7D04\u9808\u77E5"),me={class:"row justify-center"},fe=r(" \u4FEE\u6539\u9808\u77E5"),ge=r(" \u522A\u9664\u9808\u77E5"),_e={class:"full-width row flex-center text-accent q-gutter-sm"},pe={class:"col-12 q-pa-sm cursor-pointer"},xe={key:0,class:"row justify-between"},ye={class:"text-accent"},he={class:"text-secondary ellipsis-3-lines"},be={key:1,class:"row justify-start"},we={class:"col-12 row justify-between"},ke={class:"text-accent"},qe=r("\u4FEE\u6539\u9808\u77E5"),ve={class:"col-12 row justify-end q-my-sm",style:{height:"28.8px"}},Ce=r("\u522A\u9664\u9808\u77E5"),De=i("p",{class:"text-h6 text-dark"},"\u9808\u77E5\u6A19\u984C",-1),Ne=i("p",{class:"text-h6 text-dark"},"\u9808\u77E5\u5167\u5BB9",-1),Qe={class:"row justify-around"},Ve=i("div",{class:"col-12 text-center text-h3 text-red q-pb-md"},"\u8B66\u544A",-1),Pe={class:"col-12 text-center text-h6 text-dark q-pb-md"},ze=r("\u4F60\u78BA\u5B9A\u8981\u522A\u9664"),Se=i("br",null,null,-1),je=i("br",null,null,-1),Ie=r("\u522A\u9664\u5C07\u7121\u6CD5\u5FA9\u539F\uFF01"),Te={class:"col-12 row justify-around"},Re={__name:"AdminCaseView",setup(Ee){const V=R(),{logout:T}=V,{isLogin:P}=O(V),E=D(""),y=se(),F=D(!1),u=_([]),$=_({items:[],page:1,rowsPerPage:0}),l=_({_id:"",title:"",content:"",image:[],idx:-1,dialog:!1}),b=D(null),B=s=>{if(s.target.nodeName==="INPUT")return;let t,e;s.preventDefault(),s.stopPropagation(),s.originalEvent&&s.originalEvent.clipboardData.getData?(t=s.originalEvent.clipboardData.getData("text/plain"),b.value.runCmd("insertText",t)):s.clipboardData&&s.clipboardData.getData?(t=s.clipboardData.getData("text/plain"),b.value.runCmd("insertText",t)):window.clipboardData&&window.clipboardData.getData&&(e||(e=!0,b.value.runCmd("ms-pasteTextOnly",t)),e=!1)},z=_({required(s){return!!s||"\u5FC5\u586B\u6B04\u4F4D"},size(s){var t,e,d;return!s||!s.length||((e=(t=s[0])==null?void 0:t.type)==null?void 0:e.includes("image"))&&((d=s[0])==null?void 0:d.size)<=1024*1024*2||"\u6A94\u6848\u683C\u5F0F\u4E0D\u7B26\uFF08\u9808\u70BA\u5716\u7247\u6A94\uFF0C\u4E14\u6A94\u6848\u5927\u5C0F 2 MB \u4EE5\u4E0B\uFF09"}}),L=async()=>{const s=new FormData;for(const t in l)if(!["_id","idx","dialog"].includes(t))if(t==="image")for(const e of l.image)s.append(t,e);else s.append(t,l[t]);try{if(l._id.length===0){const{data:t}=await q.post("/notice",s);u.push(t.result),x.fire({icon:"success",title:"\u65B0\u589E\u6210\u529F",text:"\u60A8\u5DF2\u6210\u529F\u65B0\u589E\u4E00\u7B46\u9810\u7D04\u9808\u77E5\uFF01"}),k()}else{const{data:t}=await q.patch("/notice/"+l._id,s);u[l.idx]=t.result,x.fire({icon:"success",title:"\u4FEE\u6539\u6210\u529F",text:"\u60A8\u5DF2\u6210\u529F\u4FEE\u6539\u8A72\u7B46\u9810\u7D04\u9808\u77E5\uFF01"}),k()}l.dialog=!1}catch(t){x.fire({icon:"error",title:"\u65B0\u589E\u5931\u6557",text:t.isAxiosError?t.response.data.message:t.message})}},h=_({dialog:!1}),w=_({_id:"",title:""}),S=(s,t)=>{w._id=s,w.title=t,h.dialog=!0},A=async s=>{h.dialog=!1;try{await q.delete("/notice/"+s),await x.fire({icon:"success",title:"\u522A\u9664\u6210\u529F",text:"\u60A8\u5DF2\u6210\u529F\u522A\u9664\u8A72\u7B46\u9810\u7D04\u9808\u77E5\uFF01"}),k()}catch(t){x.fire({icon:"error",title:"\u522A\u9664\u5931\u6557",text:t.isAxiosError?t.response.data.message:t.message})}},C=(s,t)=>{l._id=s,t>-1?(l.title=u[t].title,l.content=u[t].content):(l.title="",l.content=""),l.image=[],l.idx=t,l.dialog=!0},U=[{name:"title",label:"\u9808\u77E5\u6A19\u984C",field:s=>s.title,align:"center"},{name:"content",label:"\u9808\u77E5\u5167\u5BB9",field:s=>s.content,align:"left"},{name:"edit",label:"\u9808\u77E5\u7DE8\u8F2F",align:"center"}],k=async()=>{try{const{data:s}=await q.get("/notice/all");u.splice(0,u.length),u.push(...s.result)}catch(s){x.fire({icon:"error",title:"\u5931\u6557",text:s.isAxiosError?s.response.data.message:s.message})}};return k(),(s,t)=>(c(),p(G,{class:"column"},{default:o(()=>[i("div",oe,[a(Y,{class:"text-h5 text-secondary mobile-none"},{default:o(()=>[m(P)?(c(),p(n,{key:0,round:"",dense:"",flat:"",icon:"fa-solid fa-house",to:"/",class:"q-mx-xs"},{default:o(()=>[a(j,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:o(()=>[ae]),_:1})]),_:1})):f("",!0),m(P)?(c(),p(n,{key:1,round:"",dense:"",flat:"",icon:"fa-solid fa-right-from-bracket",onClick:m(T),class:"q-ml-xl q-mr-lg"},{default:o(()=>[a(j,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:o(()=>[ie]),_:1})]),_:1},8,["onClick"])):f("",!0)]),_:1})]),i("div",le,[ne,i("div",re,[de,ce,a(ee,{grid:m(y).screen.lt.xl,columns:U,rows:u,"row-key":"title",separator:"cell",square:"",bordered:"","wrap-cells":"","binary-state-sort":"",dense:"",filter:E.value,loading:F.value,pagination:$,"rows-per-page-label":"\u6BCF\u9801\u986F\u793A\u7B46\u6578","no-data-label":"\u76EE\u524D\u6C92\u6709\u65B0\u589E\u4EFB\u4F55\u9810\u7D04\u9808\u77E5","no-results-label":"Oops...\u627E\u4E0D\u5230\u8A72\u7B46\u9810\u7D04\u9808\u77E5",class:"bg-transparent"},{"top-left":o(()=>[a(n,{onClick:t[0]||(t[0]=e=>C("",-1)),square:"",flat:"",disable:u.length>0,class:"col-auto q-mr-xl bg-secondary text-dark text-body1 q-my-sm createBtn"},{default:o(()=>[ue]),_:1},8,["disable"])]),"body-cell-title":o(e=>[a(N,{title:e,class:"ellipsis",style:{"max-width":"150px"}},{default:o(()=>[r(g(e.row.title),1)]),_:2},1032,["title"])]),"body-cell-content":o(e=>[a(N,{content:e,class:"ellipsis",style:{"max-width":"400px"}},{default:o(()=>[r(g(e.row.content),1)]),_:2},1032,["content"])]),"body-cell-edit":o(e=>[a(N,{edit:e,style:{"max-width":"150px"}},{default:o(()=>[i("div",me,[a(n,{class:"col-auto q-mx-sm q-my-xs",onClick:d=>C(e.row._id,e.rowIndex),outline:""},{default:o(()=>[fe]),_:2},1032,["onClick"]),a(n,{class:"col-auto q-mx-sm q-my-xs",onClick:d=>S(e.row._id,e.row.title),outline:""},{default:o(()=>[ge]),_:2},1032,["onClick"])])]),_:2},1032,["edit"])]),pagination:o(e=>[e.pagesNumber>1?(c(),p(n,{key:0,icon:"first_page",color:"secondary",round:"",dense:"",flat:"",disable:e.isFirstPage,onClick:e.firstPage},null,8,["disable","onClick"])):f("",!0),a(n,{icon:"chevron_left",color:"secondary",round:"",dense:"",flat:"",disable:e.isFirstPage,onClick:e.prevPage},null,8,["disable","onClick"]),a(n,{icon:"chevron_right",color:"secondary",round:"",dense:"",flat:"",disable:e.isLastPage,onClick:e.nextPage},null,8,["disable","onClick"]),e.pagesNumber>1?(c(),p(n,{key:1,icon:"last_page",color:"secondary",round:"",dense:"",flat:"",disable:e.isLastPage,onClick:e.lastPage},null,8,["disable","onClick"])):f("",!0)]),"no-data":o(({message:e})=>[i("div",_e,[i("span",null,g(e),1)])]),item:o(e=>[i("div",pe,[a(Q,{square:"",bordered:"",class:"bg-primary shadow"},{default:o(()=>[(c(!0),v(J,null,H(e.cols,d=>(c(),v("div",{key:d.name,class:"q-pa-sm"},[d.name!=="edit"?(c(),v("div",xe,[i("span",ye,g(d.label)+"\uFF1A",1),i("span",he,g(d.value),1)])):f("",!0),d.name==="edit"?(c(),v("div",be,[i("div",we,[i("span",ke,g(d.label)+"\uFF1A",1),a(n,{class:"col-auto text-secondary",style:{"font-size":"small",padding:"0px 8px"},onClick:M=>C(e.row._id,e.rowIndex),outline:""},{default:o(()=>[qe]),_:2},1032,["onClick"])]),i("div",ve,[a(n,{class:"col-auto text-secondary",style:{"font-size":"small",padding:"0px 8px"},onClick:M=>S(e.row._id,e.row.title),outline:""},{default:o(()=>[Ce]),_:2},1032,["onClick"])])])):f("",!0)]))),128))]),_:2},1024)])]),loading:o(()=>[a(Z,{showing:"",dark:"","transition-show":"fade",color:"primary"})]),_:1},8,["grid","rows","filter","loading","pagination"]),a(I,{modelValue:l.dialog,"onUpdate:modelValue":t[4]||(t[4]=e=>l.dialog=e),seamless:""},{default:o(()=>[l.dialog?(c(),p(Q,{key:0,id:"dialog",flat:"",square:"",bordered:"",persistent:"",class:"bg-info text-secondary shadow-white"},{default:o(()=>[a(K,{onSubmit:W(L,["prevent"]),class:"q-pa-md"},{default:o(()=>[De,a(X,{modelValue:l.title,"onUpdate:modelValue":t[1]||(t[1]=e=>l.title=e),rules:[z.required],type:"text",outlined:"",square:"",dense:""},null,8,["modelValue","rules"]),Ne,a(te,{model:"qeditor",modelValue:l.content,"onUpdate:modelValue":t[2]||(t[2]=e=>l.content=e),ref_key:"editorRef",ref:b,onPaste:B,rules:[z.required],outlined:"",square:"","content-class":"bg-dark","toolbar-bg":"secondary","toolbar-text-color":"dark",dense:m(y).screen.lt.lg,toolbar:[["bold","italic","strike","underline","subscript","superscript"],["left","center","right","justify"],["token","hr","link","custom_btn"],["print","fullscreen"],[{icon:m(y).iconSet.editor.formatting,fixedIcon:!1,list:"no-icons",options:["p","h1","h2","h3","h4","h5","h6","code"]},{icon:m(y).iconSet.editor.fontSize,fixedIcon:!1,list:"no-icons",options:["size-1","size-2","size-3","size-4","size-5","size-6","size-7"]},{icon:m(y).iconSet.editor.font,fixedIcon:!0,list:"no-icons",options:["default_font","arial","arial_black","comic_sans","courier_new","impact","lucida_grande","times_new_roman","verdana"]},"removeFormat"],["quote","unordered","ordered","outdent","indent"],["undo","redo"],["viewsource"]],fonts:{arial:"Arial",arial_black:"Arial Black",comic_sans:"Comic Sans MS",courier_new:"Courier New",impact:"Impact",lucida_grande:"Lucida Grande",times_new_roman:"Times New Roman",verdana:"Verdana"}},null,8,["modelValue","rules","dense","toolbar"]),i("div",Qe,[a(n,{square:"",flat:"",type:"submit",class:"col-4 bg-secondary text-dark q-my-sm",label:"\u9001\u51FA\u7DE8\u8F2F"}),a(n,{square:"",flat:"",outline:"",class:"col-4 bg-dark text-secondary q-my-sm",label:"\u53D6\u6D88",onClick:t[3]||(t[3]=e=>l.dialog=!1)})])]),_:1},8,["onSubmit"])]),_:1})):f("",!0)]),_:1},8,["modelValue"]),a(I,{modelValue:h.dialog,"onUpdate:modelValue":t[7]||(t[7]=e=>h.dialog=e),seamless:"",persistent:""},{default:o(()=>[a(Q,{square:"",class:"row justify-center bg-info q-pa-lg"},{default:o(()=>[Ve,i("div",Pe,[ze,Se,r("\u3010"+g(w.title)+"\u3011\u55CE\uFF1F",1),je,Ie]),i("div",Te,[a(n,{onClick:t[5]||(t[5]=e=>A(w._id)),square:"",flat:"",class:"col-4 bg-secondary text-dark q-my-sm",label:"\u522A\u9664"}),a(n,{square:"",flat:"",outline:"",class:"col-4 bg-dark text-secondary q-my-sm",label:"\u53D6\u6D88",onClick:t[6]||(t[6]=e=>h.dialog=!1)})])]),_:1})]),_:1},8,["modelValue"])])])]),_:1}))}};export{Re as default};
