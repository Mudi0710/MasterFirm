import{p as G,s as O,r as U,a as x,o as c,c as _,w as l,Q as Y,aY as C,S as h,d as a,e as i,q as f,i as r,t as L,v as g,z as H,f as k,g as Q,m,y as u,L as b,M as J,N as K,k as W,j,b6 as X}from"./index.9e1cd47a.js";import{Q as Z}from"./QAvatar.f31827cc.js";import{Q as q}from"./QTd.e7c93276.js";import{Q as ee}from"./QResponsive.5dafe5fc.js";import{Q as P}from"./QCard.04b288b7.js";import{Q as te,a as se,b as F}from"./QTable.06db76e8.js";import{Q as oe}from"./QFile.8a0e1a75.js";import{Q as ae}from"./QEditor.3f0f34f0.js";import{u as le}from"./use-quasar.3f2e43ad.js";const ie={id:"myheader",class:"row justify-end items-center",style:{width:"100%"}},ne=m(" \u56DE\u524D\u53F0 "),re=m(" \u767B\u51FA "),de={id:"mycontent"},ce=a("div",{class:"row justify-between"},[a("div",{class:"col-auto text-h3 text-secondary q-my-sm q-pl-md"},"\u670D\u52D9\u7BA1\u7406")],-1),ue={class:"q-pa-md"},me=a("div",{class:"bg-accent text-h5 text-dark q-mt-xl q-mb-sm",style:{height:"1px"}},null,-1),pe=a("div",{class:"text-h5 text-accent q-my-sm",style:{height:"40px","line-height":"1.6em"}},"\u670D\u52D9\u9805\u76EE",-1),fe=m("\u65B0\u589E\u670D\u52D9\u9805\u76EE"),ge=["src"],_e={class:"row justify-center content-center",style:{border:"3px solid","border-radius":"50%",width:"70px",height:"70px"}},xe={class:"row justify-center"},he=m(" \u4FEE\u6539\u9805\u76EE "),be=m(" \u522A\u9664\u9805\u76EE "),ye={class:"full-width row flex-center text-accent q-gutter-sm"},ve={class:"col-12 col-sm-6 col-md-4 col-lg-3 q-pa-sm cursor-pointer"},we=["src"],ke={key:1,class:"text-left q-mx-auto"},qe={class:"row justify-between"},Ve={class:"text-accent"},Ce={class:"text-secondary text-right"},Qe={key:2,class:"text-left q-mx-auto"},Se={class:"row justify-between"},ze={class:"text-accent"},je={class:"text-secondary text-right"},Pe={key:3,class:"text-left q-mx-auto"},$e={class:"row justify-between"},Ie={class:"text-accent"},Ne={class:"text-secondary text-right"},Ue={key:4,class:"text-left q-mx-auto"},Le={class:"row justify-between"},Fe={class:"text-accent"},Te=m("\u4FEE\u6539\u670D\u52D9\u9805\u76EE"),Ae={class:"row justify-end q-mt-sm"},Be=m("\u522A\u9664\u670D\u52D9\u9805\u76EE"),De=a("p",{class:"text-h6 text-dark"},"\u670D\u52D9\u540D\u7A31",-1),Me={class:"row"},Ee={class:"col-6"},Re=a("p",{class:"text-h6 text-dark"},"\u8AEE\u8A62\u8CBB\u7528",-1),Ge={class:"col-6"},Oe=a("p",{class:"text-h6 text-dark"},"\u8AEE\u8A62\u6642\u9593\uFF08\u5206\u9418\uFF09",-1),Ye=a("p",{class:"text-h6 text-dark"},"\u4E0A\u67B6\u72C0\u614B",-1),He=a("p",{class:"text-h6 text-dark"},"Icon",-1),Je=a("p",{class:"text-h6 text-dark"},"\u670D\u52D9\u5716\u7247",-1),Ke=a("p",{class:"text-h6 text-dark"},"\u670D\u52D9\u8AAA\u660E",-1),We={class:"row justify-around"},Xe=a("div",{class:"col-12 text-center text-h3 text-red q-pb-md"},"\u8B66\u544A",-1),Ze={class:"col-12 text-center text-h6 text-dark q-pb-md"},et=a("br",null,null,-1),tt={class:"col-12 row justify-around"},mt={__name:"AdminServiceView",setup(st){const $=G(),{logout:T}=$,{isLogin:I}=O($),S=U(""),y=le(),A=U(!1),d=x([]),B=x({items:[],page:1,rowsPerPage:10}),s=x({_id:"",name:"",description:"",sell:!1,price:0,time:0,icon:"",image:[],idx:-1,dialog:!1}),p=x({required(o){return!!o||"\u5FC5\u586B\u6B04\u4F4D"},price(o){return o>-1||"\u50F9\u683C\u5FC5\u9808\u5927\u65BC\u6216\u7B49\u65BC 0"},time(o){return o>-1||"\u6642\u9593\u5FC5\u9808\u5927\u65BC\u6216\u7B49\u65BC 0"},size(o){var t,e,n;return!o||!o.length||((e=(t=o[0])==null?void 0:t.type)==null?void 0:e.includes("image"))&&((n=o[0])==null?void 0:n.size)<=1024*1024*2||"\u6A94\u6848\u683C\u5F0F\u4E0D\u7B26\uFF08\u9808\u70BA\u5716\u7247\u6A94\uFF0C\u4E14\u6A94\u6848\u5927\u5C0F 2 MB \u4EE5\u4E0B\uFF09"}}),D=async()=>{const o=new FormData;for(const t in s)if(!["_id","idx","dialog"].includes(t))if(t==="image")for(const e of s.image)o.append(t,e);else o.append(t,s[t]);try{if(s._id.length===0){const{data:t}=await C.post("/services",o);d.push(t.result),h.fire({icon:"success",title:"\u65B0\u589E\u6210\u529F",text:"\u60A8\u5DF2\u6210\u529F\u65B0\u589E\u4E00\u7B46\u670D\u52D9\u9805\u76EE\uFF01"}),V()}else{const{data:t}=await C.patch("/services/"+s._id,o);d[s.idx]=t.result,h.fire({icon:"success",title:"\u4FEE\u6539\u6210\u529F",text:"\u60A8\u5DF2\u6210\u529F\u4FEE\u6539\u8A72\u7B46\u670D\u52D9\u9805\u76EE\uFF01"}),V()}s.dialog=!1}catch(t){h.fire({icon:"error",title:"\u65B0\u589E\u5931\u6557",text:t.isAxiosError?t.response.data.message:t.message})}},v=x({dialog:!1}),w=x({_id:"",name:""}),N=(o,t)=>{w._id=o,w.name=t,v.dialog=!0},M=async o=>{v.dialog=!1;try{await C.delete("/services/"+o),await h.fire({icon:"success",title:"\u522A\u9664\u6210\u529F",text:"\u60A8\u5DF2\u6210\u529F\u522A\u9664\u8A72\u7B46\u670D\u52D9\u9805\u76EE\uFF01"}),V()}catch(t){h.fire({icon:"error",title:"\u522A\u9664\u5931\u6557",text:t.isAxiosError?t.response.data.message:t.message})}},z=(o,t)=>{s._id=o,t>-1?(s.name=d[t].name,s.description=d[t].description,s.sell=d[t].sell,s.price=d[t].price,s.time=d[t].time,s.icon=d[t].icon):(s.name="",s.description="",s.sell=!1,s.price=0,s.time=0,s.icon=""),s.image=[],s.idx=t,s.dialog=!0},E=[{name:"image",label:"\u670D\u52D9\u5716\u7247",align:"center",field:o=>o.image[0],required:!0},{name:"icon",label:"Icon",field:o=>o.icon,align:"center",required:!0},{name:"name",label:"\u670D\u52D9\u540D\u7A31",field:o=>o.name,align:"center",required:!0},{name:"sell",label:"\u4E0A\u67B6\u72C0\u614B",field:o=>o.sell?"\u4E0A\u67B6":"\u4E0B\u67B6",align:"center"},{name:"price",label:"\u8AEE\u8A62\u8CBB\u7528",field:o=>o.price,align:"center"},{name:"time",label:"\u8AEE\u8A62\u6642\u9593",field:o=>o.time,align:"center"},{name:"edit",label:"\u9805\u76EE\u7DE8\u8F2F",align:"center"}],V=async()=>{try{const{data:o}=await C.get("/services/all");d.splice(0,d.length),d.push(...o.result),d.reverse()}catch(o){h.fire({icon:"error",title:"\u5931\u6557",text:o.isAxiosError?o.response.data.message:o.message})}};return V(),(o,t)=>(c(),_(Y,{class:"column"},{default:l(()=>[a("div",ie,[i(H,{class:"text-h5 text-secondary mobile-none"},{default:l(()=>[f(I)?(c(),_(r,{key:0,round:"",dense:"",flat:"",icon:"fa-solid fa-house",to:"/",class:"q-mx-xs"},{default:l(()=>[i(L,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:l(()=>[ne]),_:1})]),_:1})):g("",!0),f(I)?(c(),_(r,{key:1,round:"",dense:"",flat:"",icon:"fa-solid fa-right-from-bracket",onClick:f(T),class:"q-ml-xl q-mr-lg"},{default:l(()=>[i(L,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:l(()=>[re]),_:1})]),_:1},8,["onClick"])):g("",!0)]),_:1})]),a("div",de,[ce,a("div",ue,[me,pe,i(se,{grid:f(y).screen.lt.xl,columns:E,rows:d,"row-key":"name",square:"",bordered:"","wrap-cells":"","binary-state-sort":"",dense:"",filter:S.value,loading:A.value,pagination:B,"rows-per-page-label":"\u6BCF\u9801\u986F\u793A\u7B46\u6578","no-data-label":"\u76EE\u524D\u6C92\u6709\u65B0\u589E\u4EFB\u4F55\u670D\u52D9\u9805\u76EE","no-results-label":"Oops...\u627E\u4E0D\u5230\u8A72\u7B46\u670D\u52D9\u9805\u76EE",style:{width:"100%"}},{"top-left":l(()=>[i(r,{onClick:t[0]||(t[0]=e=>z("",-1)),square:"",flat:"",class:"col-auto q-mr-xl bg-secondary text-dark text-body1 q-my-sm createBtn"},{default:l(()=>[fe]),_:1})]),"top-right":l(()=>[i(k,{borderless:"",dense:"",debounce:"300",modelValue:S.value,"onUpdate:modelValue":t[1]||(t[1]=e=>S.value=e),placeholder:"\xA0Search",class:"search"},{append:l(()=>[i(Q,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-image":l(e=>[i(q,{img:e,align:"center",ellipsis:""},{default:l(()=>[i(Z,{square:"",size:"100px"},{default:l(()=>[a("img",{src:e.row.image,class:"q-mb-xl",style:{"object-fit":"cover"}},null,8,ge)]),_:2},1024)]),_:2},1032,["img"])]),"body-cell-icon":l(e=>[i(q,{img:e,align:"center",ellipsis:""},{default:l(()=>[a("div",_e,[i(Q,{name:e.row.icon,size:"xl"},null,8,["name"])])]),_:2},1032,["img"])]),"body-cell-price":l(e=>[i(q,{img:e,align:"center"},{default:l(()=>[m(" NT$ "+u(e.row.price.toLocaleString()),1)]),_:2},1032,["img"])]),"body-cell-time":l(e=>[i(q,{img:e,align:"center"},{default:l(()=>[m(u(e.row.time)+"\xA0\u5206\u9418 ",1)]),_:2},1032,["img"])]),"body-cell-edit":l(e=>[i(q,{edit:e},{default:l(()=>[a("div",xe,[i(r,{class:"col-auto q-mx-sm q-my-xs",onClick:n=>z(e.row._id,e.rowIndex),outline:""},{default:l(()=>[he]),_:2},1032,["onClick"]),i(r,{class:"col-auto q-mx-sm q-my-xs",onClick:n=>N(e.row._id,e.row.name),outline:""},{default:l(()=>[be]),_:2},1032,["onClick"])])]),_:2},1032,["edit"])]),pagination:l(e=>[e.pagesNumber>1?(c(),_(r,{key:0,icon:"first_page",color:"secondary",round:"",dense:"",flat:"",disable:e.isFirstPage,onClick:e.firstPage},null,8,["disable","onClick"])):g("",!0),i(r,{icon:"chevron_left",color:"secondary",round:"",dense:"",flat:"",disable:e.isFirstPage,onClick:e.prevPage},null,8,["disable","onClick"]),i(r,{icon:"chevron_right",color:"secondary",round:"",dense:"",flat:"",disable:e.isLastPage,onClick:e.nextPage},null,8,["disable","onClick"]),e.pagesNumber>1?(c(),_(r,{key:1,icon:"last_page",color:"secondary",round:"",dense:"",flat:"",disable:e.isLastPage,onClick:e.lastPage},null,8,["disable","onClick"])):g("",!0)]),"no-data":l(({message:e})=>[a("div",ye,[a("span",null,u(e),1)])]),item:l(e=>[a("div",ve,[i(P,{square:"",bordered:"",class:"bg-primary shadow"},{default:l(()=>[(c(!0),b(K,null,J(e.cols,n=>(c(),b("div",{key:n.name,class:"q-pa-sm"},[n.name=="image"?(c(),_(ee,{key:0,ratio:3/2},{default:l(()=>[a("img",{src:e.row[n.name],class:"col",style:{width:"100%"}},null,8,we)]),_:2},1024)):g("",!0),n.name==="price"?(c(),b("div",ke,[a("div",qe,[a("span",Ve,u(n.label)+"\uFF1A",1),a("span",Ce,"NT$ "+u(n.value.toLocaleString()),1)])])):g("",!0),n.name==="time"?(c(),b("div",Qe,[a("div",Se,[a("span",ze,u(n.label)+"\uFF1A",1),a("span",je,u(n.value)+"\xA0\u5206\u9418",1)])])):n.name!=="image"&&n.name!=="price"&&n.name!=="time"&&n.name!=="edit"?(c(),b("div",Pe,[a("div",$e,[a("span",Ie,u(n.label)+"\uFF1A",1),a("span",Ne,u(n.value),1)])])):n.name==="edit"?(c(),b("div",Ue,[a("div",Le,[a("span",Fe,u(n.label)+"\uFF1A",1),i(r,{class:"col-auto text-secondary",style:{"font-size":"xx-small",padding:"0px 8px"},onClick:R=>z(e.row._id,e.rowIndex),outline:""},{default:l(()=>[Te]),_:2},1032,["onClick"])]),a("div",Ae,[i(r,{class:"col-auto text-secondary",style:{"font-size":"xx-small",padding:"0px 8px"},onClick:R=>N(e.row._id,e.row.name),outline:""},{default:l(()=>[Be]),_:2},1032,["onClick"])])])):g("",!0)]))),128))]),_:2},1024)])]),loading:l(()=>[i(te,{showing:"",dark:"","transition-show":"fade",color:"primary"})]),_:1},8,["grid","rows","filter","loading","pagination"])]),i(F,{modelValue:s.dialog,"onUpdate:modelValue":t[12]||(t[12]=e=>s.dialog=e),seamless:""},{default:l(()=>[s.dialog?(c(),_(P,{key:0,id:"dialog",flat:"",square:"",bordered:"",persistent:"",class:"bg-info text-secondary shadow-white"},{default:l(()=>[i(W,{onSubmit:j(D,["prevent"]),class:"q-pa-md"},{default:l(()=>[De,i(k,{modelValue:s.name,"onUpdate:modelValue":t[2]||(t[2]=e=>s.name=e),rules:[p.required],type:"text",outlined:"",square:"",dense:""},null,8,["modelValue","rules"]),a("div",Me,[a("div",Ee,[Re,i(k,{class:"text-primary q-mr-sm",modelValue:s.price,"onUpdate:modelValue":t[3]||(t[3]=e=>s.price=e),modelModifiers:{number:!0},min:"0",rules:[p.required,p.price],outlined:"",square:"",dense:""},null,8,["modelValue","rules"])]),a("div",Ge,[Oe,i(k,{class:"text-primary q-mr-sm",modelValue:s.time,"onUpdate:modelValue":t[4]||(t[4]=e=>s.time=e),modelModifiers:{number:!0},min:"0",rules:[p.required,p.time],outlined:"",square:"",dense:""},null,8,["modelValue","rules"])])]),Ye,i(X,{class:"col-6 text-dark",modelValue:s.sell,"onUpdate:modelValue":t[5]||(t[5]=e=>s.sell=e),label:s.sell?"\u4E0A\u67B6":"\u4E0B\u67B6"},null,8,["modelValue","label"]),He,i(k,{modelValue:s.icon,"onUpdate:modelValue":t[6]||(t[6]=e=>s.icon=e),rules:[p.required],type:"text",outlined:"",square:"",dense:""},null,8,["modelValue","rules"]),Je,i(oe,{modelValue:s.image,"onUpdate:modelValue":t[9]||(t[9]=e=>s.image=e),multiple:"",rules:[p.size],accept:"image/*",filled:"","bottom-slots":"",counter:""},{prepend:l(()=>[i(Q,{name:"cloud_upload",onClick:t[7]||(t[7]=j(()=>{},["stop","prevent"]))})]),append:l(()=>[i(Q,{name:"close",onClick:t[8]||(t[8]=j(e=>o.model=null,["stop","prevent"])),class:"cursor-pointer"})]),hint:l(()=>[]),_:1},8,["modelValue","rules"]),Ke,i(ae,{model:"qeditor",modelValue:s.description,"onUpdate:modelValue":t[10]||(t[10]=e=>s.description=e),ref:"editorRef",onPaste:o.onPaste,rules:[p.required],outlined:"",square:"","content-class":"bg-dark","toolbar-bg":"secondary","toolbar-text-color":"dark",dense:f(y).screen.lt.lg,toolbar:[["bold","italic","strike","underline","subscript","superscript"],["left","center","right","justify"],["token","hr","link","custom_btn"],["print","fullscreen"],[{icon:f(y).iconSet.editor.formatting,fixedIcon:!1,list:"no-icons",options:["p","h1","h2","h3","h4","h5","h6","code"]},{icon:f(y).iconSet.editor.fontSize,fixedIcon:!1,list:"no-icons",options:["size-1","size-2","size-3","size-4","size-5","size-6","size-7"]},{icon:f(y).iconSet.editor.font,fixedIcon:!0,list:"no-icons",options:["default_font","arial","arial_black","comic_sans","courier_new","impact","lucida_grande","times_new_roman","verdana"]},"removeFormat"],["quote","unordered","ordered","outdent","indent"],["undo","redo"],["viewsource"]],fonts:{arial:"Arial",arial_black:"Arial Black",comic_sans:"Comic Sans MS",courier_new:"Courier New",impact:"Impact",lucida_grande:"Lucida Grande",times_new_roman:"Times New Roman",verdana:"Verdana"}},null,8,["modelValue","onPaste","rules","dense","toolbar"]),a("div",We,[i(r,{square:"",flat:"",type:"submit",class:"col-4 bg-secondary text-dark q-my-sm",label:"\u9001\u51FA\u7DE8\u8F2F"}),i(r,{square:"",flat:"",outline:"",class:"col-4 bg-dark text-secondary q-my-sm",label:"\u53D6\u6D88",onClick:t[11]||(t[11]=e=>s.dialog=!1)})])]),_:1},8,["onSubmit"])]),_:1})):g("",!0)]),_:1},8,["modelValue"]),i(F,{modelValue:v.dialog,"onUpdate:modelValue":t[15]||(t[15]=e=>v.dialog=e),seamless:"",persistent:""},{default:l(()=>[i(P,{square:"",class:"row justify-center bg-info q-pa-lg"},{default:l(()=>[Xe,a("div",Ze,[m("\u4F60\u78BA\u5B9A\u8981\u522A\u9664\u3010"+u(w.name)+"\u3011\u670D\u52D9\u9805\u76EE\u55CE\uFF1F",1),et,m("\u522A\u9664\u3010"+u(w.name)+"\u3011\u670D\u52D9\u9805\u76EE\u5C07\u7121\u6CD5\u5FA9\u539F\uFF01",1)]),a("div",tt,[i(r,{onClick:t[13]||(t[13]=e=>M(w._id)),square:"",flat:"",class:"col-4 bg-secondary text-dark q-my-sm",label:"\u78BA\u5B9A\u522A\u9664\u670D\u52D9\u9805\u76EE"}),i(r,{square:"",flat:"",outline:"",class:"col-4 bg-dark text-secondary q-my-sm",label:"\u53D6\u6D88",onClick:t[14]||(t[14]=e=>v.dialog=!1)})])]),_:1})]),_:1},8,["modelValue"])])]),_:1}))}};export{mt as default};
