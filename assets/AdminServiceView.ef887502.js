import{p as Y,s as H,r as P,a as x,o as u,c as _,w as l,Q as J,aY as Q,S as b,d as o,e as i,q as f,i as r,t as $,v as g,z as K,f as v,g as S,m as d,y as m,L as y,M as W,N as X,k as Z,j,bh as ee}from"./index.6f5e4583.js";import{Q as te}from"./QAvatar.828127eb.js";import{Q as k}from"./QTd.b07258a5.js";import{Q as se}from"./QResponsive.863b432f.js";import{Q as I}from"./QCard.03892463.js";import{Q as ae,a as oe}from"./QTable.e6f5120b.js";import{Q as le}from"./QFile.91bceafd.js";import{Q as ie}from"./QEditor.aa4f95b6.js";import{Q as F}from"./QDialog.68934308.js";import{u as ne}from"./use-quasar.7c136ebb.js";const re={id:"myheader",class:"row justify-end items-center",style:{width:"100%"}},de=d(" \u56DE\u524D\u53F0 "),ce=d(" \u767B\u51FA "),ue={id:"mycontent"},me=o("div",{class:"row justify-between"},[o("div",{class:"col-auto text-h3 text-secondary q-my-sm q-pl-md"},"\u670D\u52D9\u7BA1\u7406")],-1),pe={class:"q-pa-md"},fe=d("\u65B0\u589E\u670D\u52D9\u9805\u76EE"),ge=["src"],_e={class:"row justify-center content-center",style:{border:"3px solid","border-radius":"50%",width:"70px",height:"70px"}},xe={class:"row justify-center"},be=d(" \u4FEE\u6539\u9805\u76EE "),ye=d(" \u522A\u9664\u9805\u76EE "),he={class:"full-width row flex-center text-accent q-gutter-sm"},we={class:"col-12 col-sm-6 col-md-4 col-lg-3 q-pa-sm cursor-pointer"},ve=["src"],ke={key:1,class:"text-left q-mx-auto"},qe={class:"row justify-between"},Ve={class:"text-accent"},Ce={class:"text-secondary text-right"},Qe={key:2,class:"text-left q-mx-auto"},Se={class:"row justify-between"},De={class:"text-accent"},ze={class:"text-secondary text-right"},Pe={key:3,class:"text-left q-mx-auto"},je={class:"row justify-between"},Ie={class:"text-accent"},Ne={class:"text-secondary text-right"},Te={key:4,class:"text-left q-mx-auto"},Ue={class:"row justify-between"},$e={class:"text-accent"},Fe=d("\u4FEE\u6539\u670D\u52D9\u9805\u76EE"),Le={class:"row justify-end q-my-sm",style:{height:"28.8px"}},Ee=d("\u522A\u9664\u670D\u52D9\u9805\u76EE"),Ae=o("p",{class:"text-h6 text-dark"},"\u670D\u52D9\u540D\u7A31",-1),Be={class:"row"},Me={class:"col-6"},Re=o("p",{class:"text-h6 text-dark"},"\u8AEE\u8A62\u8CBB\u7528",-1),Oe={class:"col-6"},Ge=o("p",{class:"text-h6 text-dark"},[d("\u8AEE\u8A62\u6642\u9593"),o("span",{style:{"font-size":"xx-small"}},"(\u5206\u9418)")],-1),Ye=o("p",{class:"text-h6 text-dark"},"\u4E0A\u67B6\u72C0\u614B",-1),He=o("p",{class:"text-h6 text-dark"},[d("Icon"),o("a",{href:"http://fontawesome.com/search?m=free",target:"_blank"},"\xA0\u9019\u908A\u627E")],-1),Je=o("p",{class:"text-h6 text-dark"},"\u670D\u52D9\u5716\u7247",-1),Ke=o("p",{class:"text-h6 text-dark"},"\u670D\u52D9\u8AAA\u660E",-1),We={class:"row justify-around"},Xe=o("div",{class:"col-12 text-center text-h3 text-red q-pb-md"},"\u8B66\u544A",-1),Ze={class:"col-12 text-center text-h6 text-dark q-pb-md"},et=d("\u60A8\u78BA\u5B9A\u8981\u522A\u9664"),tt=o("br",null,null,-1),st=o("br",null,null,-1),at=d("\u522A\u9664\u5C07\u7121\u6CD5\u5FA9\u539F\uFF01"),ot={class:"col-12 row justify-around"},_t={__name:"AdminServiceView",setup(lt){const N=Y(),{logout:L}=N,{isLogin:T}=H(N),D=P(""),h=ne(),E=P(!1),c=x([]),A=x({items:[],page:1,rowsPerPage:10}),a=x({_id:"",name:"",description:"",sell:!1,price:0,time:0,icon:"",image:[],idx:-1,dialog:!1}),q=P(null),B=s=>{if(s.target.nodeName==="INPUT")return;let t,e;s.preventDefault(),s.stopPropagation(),s.originalEvent&&s.originalEvent.clipboardData.getData?(t=s.originalEvent.clipboardData.getData("text/plain"),q.value.runCmd("insertText",t)):s.clipboardData&&s.clipboardData.getData?(t=s.clipboardData.getData("text/plain"),q.value.runCmd("insertText",t)):window.clipboardData&&window.clipboardData.getData&&(e||(e=!0,q.value.runCmd("ms-pasteTextOnly",t)),e=!1)},p=x({required(s){return!!s||"\u5FC5\u586B\u6B04\u4F4D"},price(s){return s>-1||"\u50F9\u683C\u5FC5\u9808\u5927\u65BC\u6216\u7B49\u65BC 0"},time(s){return s>-1||"\u6642\u9593\u5FC5\u9808\u5927\u65BC\u6216\u7B49\u65BC 0"},size(s){var t,e,n;return!s||!s.length||((e=(t=s[0])==null?void 0:t.type)==null?void 0:e.includes("image"))&&((n=s[0])==null?void 0:n.size)<=1024*1024*2||"\u6A94\u6848\u683C\u5F0F\u4E0D\u7B26\uFF08\u9808\u70BA\u5716\u7247\u6A94\uFF0C\u4E14\u6A94\u6848\u5927\u5C0F 2 MB \u4EE5\u4E0B\uFF09"}}),M=async()=>{const s=new FormData;for(const t in a)if(!["_id","idx","dialog"].includes(t))if(t==="image")for(const e of a.image)s.append(t,e);else s.append(t,a[t]);try{if(a._id.length===0){const{data:t}=await Q.post("/services",s);c.push(t.result),b.fire({icon:"success",title:"\u65B0\u589E\u6210\u529F",text:"\u60A8\u5DF2\u6210\u529F\u65B0\u589E\u4E00\u7B46\u670D\u52D9\u9805\u76EE\uFF01"}),C()}else{const{data:t}=await Q.patch("/services/"+a._id,s);c[a.idx]=t.result,b.fire({icon:"success",title:"\u4FEE\u6539\u6210\u529F",text:"\u60A8\u5DF2\u6210\u529F\u4FEE\u6539\u8A72\u7B46\u670D\u52D9\u9805\u76EE\uFF01"}),C()}a.dialog=!1}catch(t){b.fire({icon:"error",title:"\u65B0\u589E\u5931\u6557",text:t.isAxiosError?t.response.data.message:t.message})}},w=x({dialog:!1}),V=x({_id:"",name:""}),U=(s,t)=>{V._id=s,V.name=t,w.dialog=!0},R=async s=>{w.dialog=!1;try{await Q.delete("/services/"+s),await b.fire({icon:"success",title:"\u522A\u9664\u6210\u529F",text:"\u60A8\u5DF2\u6210\u529F\u522A\u9664\u8A72\u7B46\u670D\u52D9\u9805\u76EE\uFF01"}),C()}catch(t){b.fire({icon:"error",title:"\u522A\u9664\u5931\u6557",text:t.isAxiosError?t.response.data.message:t.message})}},z=(s,t)=>{a._id=s,t>-1?(a.name=c[t].name,a.description=c[t].description,a.sell=c[t].sell,a.price=c[t].price,a.time=c[t].time,a.icon=c[t].icon):(a.name="",a.description="",a.sell=!1,a.price=0,a.time=0,a.icon=""),a.image=[],a.idx=t,a.dialog=!0},O=[{name:"image",label:"\u670D\u52D9\u5716\u7247",align:"center",field:s=>s.image[0],required:!0},{name:"icon",label:"Icon",field:s=>s.icon,align:"center",required:!0},{name:"name",label:"\u670D\u52D9\u540D\u7A31",field:s=>s.name,align:"center",required:!0},{name:"sell",label:"\u4E0A\u67B6\u72C0\u614B",field:s=>s.sell?"\u4E0A\u67B6":"\u4E0B\u67B6",align:"center"},{name:"price",label:"\u8AEE\u8A62\u8CBB\u7528",field:s=>s.price,align:"center"},{name:"time",label:"\u8AEE\u8A62\u6642\u9593",field:s=>s.time,align:"center"},{name:"edit",label:"\u9805\u76EE\u7DE8\u8F2F",align:"center"}],C=async()=>{try{const{data:s}=await Q.get("/services/all");c.splice(0,c.length),c.push(...s.result),c.reverse()}catch(s){b.fire({icon:"error",title:"\u5931\u6557",text:s.isAxiosError?s.response.data.message:s.message})}};return C(),(s,t)=>(u(),_(J,{class:"column"},{default:l(()=>[o("div",re,[i(K,{class:"text-h5 text-secondary mobile-none"},{default:l(()=>[f(T)?(u(),_(r,{key:0,round:"",dense:"",flat:"",icon:"fa-solid fa-house",to:"/",class:"q-mx-xs"},{default:l(()=>[i($,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:l(()=>[de]),_:1})]),_:1})):g("",!0),f(T)?(u(),_(r,{key:1,round:"",dense:"",flat:"",icon:"fa-solid fa-right-from-bracket",onClick:f(L),class:"q-ml-xl q-mr-lg"},{default:l(()=>[i($,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:l(()=>[ce]),_:1})]),_:1},8,["onClick"])):g("",!0)]),_:1})]),o("div",ue,[me,o("div",pe,[i(oe,{grid:f(h).screen.lt.xl,columns:O,rows:c,"row-key":"name",square:"",bordered:"","wrap-cells":"","binary-state-sort":"",dense:"",filter:D.value,loading:E.value,pagination:A,"rows-per-page-label":"\u6BCF\u9801\u986F\u793A\u7B46\u6578","no-data-label":"\u76EE\u524D\u6C92\u6709\u65B0\u589E\u4EFB\u4F55\u670D\u52D9\u9805\u76EE","no-results-label":"Oops...\u627E\u4E0D\u5230\u8A72\u7B46\u670D\u52D9\u9805\u76EE",style:{width:"100%"}},{"top-left":l(()=>[i(r,{onClick:t[0]||(t[0]=e=>z("",-1)),square:"",flat:"",class:"col-auto q-mr-xl bg-secondary text-dark text-body1 q-my-sm createBtn"},{default:l(()=>[fe]),_:1})]),"top-right":l(()=>[i(v,{borderless:"",dense:"",debounce:"300",modelValue:D.value,"onUpdate:modelValue":t[1]||(t[1]=e=>D.value=e),placeholder:"\xA0Search",class:"search"},{append:l(()=>[i(S,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-image":l(e=>[i(k,{img:e,align:"center",ellipsis:""},{default:l(()=>[i(te,{square:"",size:"100px"},{default:l(()=>[o("img",{src:e.row.image[0],class:"q-mb-xl",style:{"object-fit":"cover"}},null,8,ge)]),_:2},1024)]),_:2},1032,["img"])]),"body-cell-icon":l(e=>[i(k,{img:e,align:"center",ellipsis:""},{default:l(()=>[o("div",_e,[i(S,{name:e.row.icon,size:"xl"},null,8,["name"])])]),_:2},1032,["img"])]),"body-cell-price":l(e=>[i(k,{img:e,align:"center"},{default:l(()=>[d(" NT$ "+m(e.row.price.toLocaleString()),1)]),_:2},1032,["img"])]),"body-cell-time":l(e=>[i(k,{img:e,align:"center"},{default:l(()=>[d(m(e.row.time)+"\xA0\u5206\u9418 ",1)]),_:2},1032,["img"])]),"body-cell-edit":l(e=>[i(k,{edit:e},{default:l(()=>[o("div",xe,[i(r,{class:"col-auto q-mx-sm q-my-xs",onClick:n=>z(e.row._id,e.rowIndex),outline:""},{default:l(()=>[be]),_:2},1032,["onClick"]),i(r,{class:"col-auto q-mx-sm q-my-xs",onClick:n=>U(e.row._id,e.row.name),outline:""},{default:l(()=>[ye]),_:2},1032,["onClick"])])]),_:2},1032,["edit"])]),pagination:l(e=>[e.pagesNumber>1?(u(),_(r,{key:0,icon:"first_page",color:"secondary",round:"",dense:"",flat:"",disable:e.isFirstPage,onClick:e.firstPage},null,8,["disable","onClick"])):g("",!0),i(r,{icon:"chevron_left",color:"secondary",round:"",dense:"",flat:"",disable:e.isFirstPage,onClick:e.prevPage},null,8,["disable","onClick"]),i(r,{icon:"chevron_right",color:"secondary",round:"",dense:"",flat:"",disable:e.isLastPage,onClick:e.nextPage},null,8,["disable","onClick"]),e.pagesNumber>1?(u(),_(r,{key:1,icon:"last_page",color:"secondary",round:"",dense:"",flat:"",disable:e.isLastPage,onClick:e.lastPage},null,8,["disable","onClick"])):g("",!0)]),"no-data":l(({message:e})=>[o("div",he,[o("span",null,m(e),1)])]),item:l(e=>[o("div",we,[i(I,{square:"",bordered:"",class:"bg-primary shadow"},{default:l(()=>[(u(!0),y(X,null,W(e.cols,n=>(u(),y("div",{key:n.name,class:"q-pa-sm"},[n.name=="image"?(u(),_(se,{key:0,ratio:3/2},{default:l(()=>[o("img",{src:e.row[n.name][0],class:"col",style:{width:"100%","object-fit":"cover"}},null,8,ve)]),_:2},1024)):g("",!0),n.name==="price"?(u(),y("div",ke,[o("div",qe,[o("span",Ve,m(n.label)+"\uFF1A",1),o("span",Ce,"NT$ "+m(n.value.toLocaleString()),1)])])):g("",!0),n.name==="time"?(u(),y("div",Qe,[o("div",Se,[o("span",De,m(n.label)+"\uFF1A",1),o("span",ze,m(n.value)+"\xA0\u5206\u9418",1)])])):n.name!=="image"&&n.name!=="price"&&n.name!=="time"&&n.name!=="edit"?(u(),y("div",Pe,[o("div",je,[o("span",Ie,m(n.label)+"\uFF1A",1),o("span",Ne,m(n.value),1)])])):n.name==="edit"?(u(),y("div",Te,[o("div",Ue,[o("span",$e,m(n.label)+"\uFF1A",1),i(r,{class:"col-auto text-secondary",style:{"font-size":"small",padding:"0px 8px"},onClick:G=>z(e.row._id,e.rowIndex),outline:""},{default:l(()=>[Fe]),_:2},1032,["onClick"])]),o("div",Le,[i(r,{class:"col-auto text-secondary",style:{"font-size":"small",padding:"0px 8px"},onClick:G=>U(e.row._id,e.row.name),outline:""},{default:l(()=>[Ee]),_:2},1032,["onClick"])])])):g("",!0)]))),128))]),_:2},1024)])]),loading:l(()=>[i(ae,{showing:"",dark:"","transition-show":"fade",color:"primary"})]),_:1},8,["grid","rows","filter","loading","pagination"])]),i(F,{modelValue:a.dialog,"onUpdate:modelValue":t[12]||(t[12]=e=>a.dialog=e),seamless:""},{default:l(()=>[a.dialog?(u(),_(I,{key:0,id:"dialog",flat:"",square:"",bordered:"",persistent:"",class:"bg-info text-secondary shadow-white"},{default:l(()=>[i(Z,{onSubmit:j(M,["prevent"]),class:"q-pa-md"},{default:l(()=>[Ae,i(v,{modelValue:a.name,"onUpdate:modelValue":t[2]||(t[2]=e=>a.name=e),rules:[p.required],type:"text",outlined:"",square:"",dense:""},null,8,["modelValue","rules"]),o("div",Be,[o("div",Me,[Re,i(v,{class:"text-primary q-mr-sm",modelValue:a.price,"onUpdate:modelValue":t[3]||(t[3]=e=>a.price=e),modelModifiers:{number:!0},min:"0",rules:[p.required,p.price],outlined:"",square:"",dense:""},null,8,["modelValue","rules"])]),o("div",Oe,[Ge,i(v,{class:"text-primary q-mr-sm",modelValue:a.time,"onUpdate:modelValue":t[4]||(t[4]=e=>a.time=e),modelModifiers:{number:!0},min:"0",rules:[p.required,p.time],outlined:"",square:"",dense:""},null,8,["modelValue","rules"])])]),Ye,i(ee,{class:"col-6 text-dark",modelValue:a.sell,"onUpdate:modelValue":t[5]||(t[5]=e=>a.sell=e),label:a.sell?"\u4E0A\u67B6":"\u4E0B\u67B6"},null,8,["modelValue","label"]),He,i(v,{modelValue:a.icon,"onUpdate:modelValue":t[6]||(t[6]=e=>a.icon=e),rules:[p.required],type:"text",outlined:"",square:"",dense:""},null,8,["modelValue","rules"]),Je,i(le,{modelValue:a.image,"onUpdate:modelValue":t[9]||(t[9]=e=>a.image=e),multiple:"",rules:[p.size],accept:"image/*",filled:"","bottom-slots":"",counter:""},{prepend:l(()=>[i(S,{name:"cloud_upload",onClick:t[7]||(t[7]=j(()=>{},["stop","prevent"]))})]),append:l(()=>[i(S,{name:"close",onClick:t[8]||(t[8]=j(e=>s.model=null,["stop","prevent"])),class:"cursor-pointer"})]),hint:l(()=>[]),_:1},8,["modelValue","rules"]),Ke,i(ie,{model:"qeditor",modelValue:a.description,"onUpdate:modelValue":t[10]||(t[10]=e=>a.description=e),ref_key:"editorRef",ref:q,onPaste:B,rules:[p.required],outlined:"",square:"","content-class":"bg-dark","toolbar-bg":"secondary","toolbar-text-color":"dark",dense:f(h).screen.lt.lg,toolbar:[["bold","italic","strike","underline","subscript","superscript"],["left","center","right","justify"],["token","hr","link","custom_btn"],["print","fullscreen"],[{icon:f(h).iconSet.editor.formatting,fixedIcon:!1,list:"no-icons",options:["p","h1","h2","h3","h4","h5","h6","code"]},{icon:f(h).iconSet.editor.fontSize,fixedIcon:!1,list:"no-icons",options:["size-1","size-2","size-3","size-4","size-5","size-6","size-7"]},{icon:f(h).iconSet.editor.font,fixedIcon:!0,list:"no-icons",options:["default_font","arial","arial_black","comic_sans","courier_new","impact","lucida_grande","times_new_roman","verdana"]},"removeFormat"],["quote","unordered","ordered","outdent","indent"],["undo","redo"],["viewsource"]],fonts:{arial:"Arial",arial_black:"Arial Black",comic_sans:"Comic Sans MS",courier_new:"Courier New",impact:"Impact",lucida_grande:"Lucida Grande",times_new_roman:"Times New Roman",verdana:"Verdana"}},null,8,["modelValue","rules","dense","toolbar"]),o("div",We,[i(r,{square:"",flat:"",type:"submit",class:"col-4 bg-secondary text-dark q-my-sm",label:"\u9001\u51FA\u7DE8\u8F2F"}),i(r,{square:"",flat:"",outline:"",class:"col-4 bg-dark text-secondary q-my-sm",label:"\u53D6\u6D88",onClick:t[11]||(t[11]=e=>a.dialog=!1)})])]),_:1},8,["onSubmit"])]),_:1})):g("",!0)]),_:1},8,["modelValue"]),i(F,{modelValue:w.dialog,"onUpdate:modelValue":t[15]||(t[15]=e=>w.dialog=e),seamless:"",persistent:""},{default:l(()=>[i(I,{square:"",class:"row justify-center bg-info q-pa-lg"},{default:l(()=>[Xe,o("div",Ze,[et,tt,d("\u3010"+m(V.name)+"\u3011\u55CE\uFF1F",1),st,at]),o("div",ot,[i(r,{onClick:t[13]||(t[13]=e=>R(V._id)),square:"",flat:"",class:"col-4 bg-secondary text-dark q-my-sm",label:"\u522A\u9664"}),i(r,{square:"",flat:"",outline:"",class:"col-4 bg-dark text-secondary q-my-sm",label:"\u53D6\u6D88",onClick:t[14]||(t[14]=e=>w.dialog=!1)})])]),_:1})]),_:1},8,["modelValue"])])]),_:1}))}};export{_t as default};
