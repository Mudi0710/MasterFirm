import{p as I,s as E,r as S,a as y,o as i,c as m,w as e,Q as U,aY as z,S as A,d as t,e as o,q as d,i as u,t as x,v as r,x as O,m as c,y as a,z as R,f as F,g as M,L as f,M as C,N as L,l as V}from"./index.7e47edf0.js";import{Q as P,a as Y}from"./QBreadcrumbs.1bf9f26e.js";import{Q as v}from"./QTd.d8b566f6.js";import{Q as N}from"./QCard.f71d7d26.js";import{Q as G,a as H}from"./QTable.80afd137.js";import{Q as J}from"./QImg.ce1289a8.js";import{Q as K}from"./QResponsive.1cde13a0.js";import{Q as W}from"./QDialog.9d49b8f4.js";import{u as X}from"./use-quasar.4e6581ad.js";const Z={id:"myheader",class:"row justify-end items-center",style:{width:"100%"}},tt=c(" \u6703\u54E1\u8CC7\u6599 "),et=c(" \u8A02\u55AE\u67E5\u8A62 "),st=c(" \u8CFC\u7269\u8ECA "),ot=c(" \u7BA1\u7406\u5F8C\u53F0 "),at=c(" \u8A3B\u518A "),lt=c(" \u767B\u5165 "),it=c(" \u767B\u51FA "),nt={id:"mycontent",class:"col-12 row content-start"},ct=t("div",{class:"col-12 text-h4 text-xl-h3 text-secondary q-mb-md q-pl-md",style:{width:"100%"}},"\u8A02\u55AE\u67E5\u8A62",-1),dt={class:"col-12 q-mt-md q-pl-lg",style:{width:"100%"}},rt={class:"col-12 q-pa-md",style:{width:"100%"}},_t={class:"row justify-center"},ut=c("\u8A02\u55AE\u8A73\u60C5"),mt={class:"full-width row flex-center text-accent text-h5 q-gutter-sm"},ft={class:"col-12 col-sm-6 col-md-4 col-lg-3 q-pa-sm cursor-pointer"},ht={key:0,class:"text-left q-mx-auto"},xt={class:"row justify-between items-center"},gt={class:"text-accent"},pt={class:"text-secondary text-body2 text-right ellipsis-3-lines"},wt={key:1,class:"text-left q-mx-auto"},yt={class:"row justify-between"},vt={class:"text-accent"},qt={class:"text-secondary text-body2 text-right text-wrap"},bt={key:2,class:"text-left q-mx-auto"},kt={class:"row justify-between"},Qt={class:"text-accent"},St={class:"text-secondary text-right ellipsis-3-lines"},Ct={key:3,class:"text-left q-mx-auto"},Lt={class:"row justify-between"},Vt={class:"text-accent"},Pt=c("\u8A02\u55AE\u8A73\u60C5"),Nt=t("div",{class:"col-12 text-center text-h3 text-accent q-pb-md"},"\u8A02\u55AE\u8A73\u60C5",-1),Tt={class:"row q-pa-md",style:{width:"100%",border:"1px solid #1E1918"}},$t={class:"col-12 row"},jt=t("div",{class:"col-12 col-sm-auto text-h6 text-accent"},"\u8A02\u55AE\u7DE8\u865F\uFF1A",-1),Dt={class:"col-12 col-sm-auto text-sm-h6 text-dark"},Bt={class:"col-12 row"},It=t("div",{class:"col-12 col-sm-auto text-h6 text-accent"},"\u8A02\u55AE\u65E5\u671F\uFF1A",-1),Et={class:"col-12 col-sm-auto text-sm-h6 text-dark"},Ut={class:"row"},zt={class:"col-12 col-lg-3"},At={class:"col-12 col-lg-9 row q-px-lg-lg"},Ot={class:"col-12 row"},Rt=t("div",{class:"col-12 col-sm-auto text-h6 text-accent"},"\u5546\u54C1\u540D\u7A31\uFF1A\xA0",-1),Ft={class:"col-12 col-sm text-sm-h6 text-dark"},Mt={class:"col-12 row"},Yt=t("div",{class:"col-12 col-sm-auto text-h6 text-accent"},"\u5546\u54C1\u91D1\u984D\uFF1A\xA0 ",-1),Gt={class:"col-12 col-sm text-sm-h6 text-dark"},Ht={class:"col-12 row"},Jt=t("div",{class:"col-12 col-sm-auto text-h6 text-accent"},"\u8A02\u8CFC\u6578\u91CF\uFF1A\xA0",-1),Kt={class:"col-12 col-sm text-sm-h6 text-dark"},Wt={class:"col-12 text-h6 text-accent text-right"},Xt=c("\u5C0F\u8A08\uFF1A\xA0"),Zt={class:"text-dark"},te={class:"col-12 row justify-end q-px-lg-lg"},ee=t("div",{class:"col-12 col-lg-auto text-h4 text-accent q-my-sm"},"\u8A02\u55AE\u91D1\u984D\uFF1A",-1),se={class:"col-12 col-lg-auto text-h4 text-warning text-right q-my-sm"},oe={class:"col-12 row justify-around"},xe={__name:"OrderView",setup(ae){const q=I(),{logout:T}=q,{isLogin:h,isAdmin:$,cart:b}=E(q),w=S(""),j=X(),D=y({items:[],page:1,rowsPerPage:0}),k=y([]),p=y({dialog:!1}),g=S(""),Q=n=>{g.value=n,p.dialog=!0},B=[{name:"date",label:"\u8A02\u55AE\u65E5\u671F",field:n=>n.date,required:!0,align:"center"},{name:"id",label:"\u8A02\u55AE\u7DE8\u865F",field:n=>n._id,required:!0,align:"center"},{name:"totalPrice",label:"\u8A02\u55AE\u91D1\u984D",field:n=>n.totalPrice,align:"center"},{name:"detail",label:"\u8A02\u55AE\u8A73\u60C5",align:"center"}];return(async()=>{try{const{data:n}=await z.get("/orders");k.push(...n.result.map(_=>(_.totalPrice=_.products.reduce((s,l)=>s+l.price*l.quantity,0),_)))}catch(n){console.log(n),A.fire({icon:"error",title:"\u5931\u6557",text:"\u7121\u6CD5\u53D6\u5F97\u8A02\u55AE"})}})(),(n,_)=>(i(),m(U,{id:"CartView",class:"column"},{default:e(()=>[t("div",Z,[o(R,{class:"text-h5 text-secondary mobile-none"},{default:e(()=>[d(h)?(i(),m(u,{key:0,round:"",dense:"",flat:"",icon:"fa-solid fa-address-card",to:"/member",class:"q-mx-xs"},{default:e(()=>[o(x,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:e(()=>[tt]),_:1})]),_:1})):r("",!0),d(h)?(i(),m(u,{key:1,round:"",dense:"",flat:"",icon:"fa-solid fa-receipt",to:"/order",class:"q-mx-xs"},{default:e(()=>[o(x,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:e(()=>[et]),_:1})]),_:1})):r("",!0),d(h)?(i(),m(u,{key:2,round:"",dense:"",flat:"",icon:"fa-solid fa-cart-shopping",to:"/cart",class:"q-mx-xs"},{default:e(()=>[o(x,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:e(()=>[st]),_:1}),d(b)>0?(i(),m(O,{key:0,floating:"",color:"red",rounded:""},{default:e(()=>[c(a(d(b)),1)]),_:1})):r("",!0)]),_:1})):r("",!0),d(h)&&d($)?(i(),m(u,{key:3,round:"",dense:"",flat:"",icon:"fa-solid fa-user-gear",to:"/admin",class:"q-mx-xs"},{default:e(()=>[o(x,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:e(()=>[ot]),_:1})]),_:1})):r("",!0),d(h)?r("",!0):(i(),m(u,{key:4,round:"",dense:"",flat:"",icon:"fa-solid fa-user-plus",to:"/register",class:"q-mx-xs"},{default:e(()=>[o(x,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:e(()=>[at]),_:1})]),_:1})),d(h)?r("",!0):(i(),m(u,{key:5,round:"",dense:"",flat:"",icon:"fa-solid fa-right-to-bracket",to:"/login",class:"q-ml-xs q-mr-sm"},{default:e(()=>[o(x,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:e(()=>[lt]),_:1})]),_:1})),d(h)?(i(),m(u,{key:6,round:"",dense:"",flat:"",icon:"fa-solid fa-right-from-bracket",onClick:d(T),class:"q-ml-xl q-mr-md"},{default:e(()=>[o(x,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:e(()=>[it]),_:1})]),_:1},8,["onClick"])):r("",!0)]),_:1})]),t("div",nt,[ct,t("div",dt,[o(Y,null,{default:e(()=>[o(P,{label:"\u9996\u9801",icon:"fa-solid fa-house",to:"/"}),o(P,{label:"\u8A02\u55AE\u67E5\u8A62",icon:"fa-solid fa-receipt"})]),_:1})]),t("div",rt,[o(H,{grid:d(j).screen.lt.xl,columns:B,rows:k,"row-key":"name",square:"",bordered:"","wrap-cells":"","binary-state-sort":"",dense:"",filter:w.value,loading:n.loading,pagination:D,"no-data-label":"\u76EE\u524D\u6C92\u6709\u4EFB\u4F55\u8A02\u55AE","rows-per-page-label":"\u6BCF\u9801\u986F\u793A\u7B46\u6578","no-results-label":"Oops...\u627E\u4E0D\u5230\u8A72\u7B46\u8A02\u55AE"},{"top-right":e(()=>[o(F,{borderless:"",dense:"",debounce:"300",modelValue:w.value,"onUpdate:modelValue":_[0]||(_[0]=s=>w.value=s),placeholder:"\xA0Search",class:"search"},{append:e(()=>[o(M,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-date":e(s=>[o(v,{img:s,align:"center"},{default:e(()=>[c(a(new Date(s.value).toLocaleString()),1)]),_:2},1032,["img"])]),"body-cell-totalPrice":e(s=>[o(v,{totalPrice:s,align:"center"},{default:e(()=>[c(" NT$ "+a(s.row.totalPrice.toLocaleString()),1)]),_:2},1032,["totalPrice"])]),"body-cell-detail":e(s=>[o(v,{detail:s},{default:e(()=>[t("div",_t,[o(u,{class:"col-auto q-mx-sm",onClick:l=>Q(s),outline:""},{default:e(()=>[ut]),_:2},1032,["onClick"])])]),_:2},1032,["detail"])]),"no-data":e(({message:s})=>[t("div",mt,[t("span",null,a(s),1)])]),item:e(s=>[t("div",ft,[o(N,{onClick:l=>n.openDialog(s.row._id,s.rowIndex),square:"",bordered:"",class:"bg-primary shadow",style:{}},{default:e(()=>[(i(!0),f(L,null,C(s.cols,l=>(i(),f("div",{key:l.name,class:"q-pa-sm"},[l.name==="date"?(i(),f("div",ht,[t("div",xt,[t("span",gt,a(l.label)+"\uFF1A",1),t("span",pt,a(new Date(l.value).toLocaleString()),1)])])):r("",!0),l.name==="id"?(i(),f("div",wt,[t("div",yt,[t("span",vt,a(l.label)+"\uFF1A",1),t("span",qt,a(l.value),1)])])):r("",!0),l.name==="totalPrice"?(i(),f("div",bt,[t("div",kt,[t("span",Qt,a(l.label)+"\uFF1A",1),t("span",St,"NT$ "+a(l.value.toLocaleString()),1)])])):r("",!0),l.name==="detail"?(i(),f("div",Ct,[t("div",Lt,[t("span",Vt,a(l.label)+"\uFF1A",1),o(u,{class:"col-auto text-secondary",style:{"font-size":"xx-small",padding:"0px 8px"},onClick:ie=>Q(s),outline:""},{default:e(()=>[Pt]),_:2},1032,["onClick"])])])):r("",!0)]))),128))]),_:2},1032,["onClick"])])]),loading:e(()=>[o(G,{showing:"",dark:"","transition-show":"fade",color:"primary"})]),_:1},8,["grid","rows","filter","loading","pagination"])]),o(W,{modelValue:p.dialog,"onUpdate:modelValue":_[2]||(_[2]=s=>p.dialog=s),seamless:"",style:{width:"auto"}},{default:e(()=>[o(N,{square:"",class:"row justify-center bg-info q-pa-lg",style:{width:"100%"}},{default:e(()=>[Nt,t("div",Tt,[t("div",$t,[jt,t("div",Dt,a(g.value.row._id),1)]),t("div",Bt,[It,t("div",Et,a(new Date(g.value.row.date).toLocaleString()),1)]),o(V,{class:"bg-dark text-center q-mx-auto q-my-sm",style:{width:"95%"}}),(i(!0),f(L,null,C(g.value.row.products,s=>(i(),f("div",{key:s._id,class:"col-12 text-accent"},[t("div",Ut,[t("div",zt,[o(K,{ratio:3/2},{default:e(()=>[o(J,{src:s.product.image[0]},null,8,["src"])]),_:2},1024)]),t("div",At,[t("div",Ot,[Rt,t("div",Ft,a(s.product.name),1)]),t("div",Mt,[Yt,t("div",Gt,"NT$ "+a(s.price.toLocaleString()),1)]),t("div",Ht,[Jt,t("div",Kt,a(s.quantity),1)]),t("div",Wt,[Xt,t("span",Zt,"NT$ "+a((s.price*s.quantity).toLocaleString()),1)])])]),o(V,{class:"bg-dark text-center q-mx-auto q-my-sm",style:{width:"95%"}})]))),128)),t("div",te,[ee,t("div",se,"NT$ "+a(g.value.row.totalPrice.toLocaleString()),1)])]),t("div",oe,[o(u,{square:"",flat:"",outline:"",class:"col-4 bg-dark text-secondary q-my-sm",label:"\u95DC\u9589",onClick:_[1]||(_[1]=s=>p.dialog=!1)})])]),_:1})]),_:1},8,["modelValue"])])]),_:1}))}};export{xe as default};
