import{p as Y,s as Z,r as v,a as y,o as c,c as m,w as n,Q as G,aY as k,S as g,d as o,e as l,q,i as r,t as z,v as f,z as H,f as p,g as L,y as _,L as h,M as J,N as K,k as W,j as X,h as N,aZ as ee,m as u}from"./index.3e88b888.js";import{Q as te}from"./QAvatar.e6712b39.js";import{Q as S}from"./QTd.fd174d08.js";import{Q as se}from"./QResponsive.bb1b803d.js";import{Q as C}from"./QCard.9396e92a.js";import{Q as ae,a as le}from"./QTable.ae39d8b8.js";import{Q as oe,a as ne,C as ie}from"./ClosePopup.817f7d90.js";import{Q as A}from"./QDialog.a62687f9.js";import{u as re}from"./use-quasar.6192e987.js";const de={id:"myheader",class:"row justify-end items-center",style:{width:"100%"}},ce=u(" \u56DE\u524D\u53F0 "),ue=u(" \u767B\u51FA "),me={id:"mycontent",class:""},fe=o("div",{class:"row justify-between"},[o("div",{class:"col-auto text-h3 text-secondary q-my-sm q-pl-md"},"\u6703\u54E1\u7BA1\u7406")],-1),ge={class:"q-pa-md"},pe=["src"],_e={class:"row justify-center"},xe=u("\u7DE8\u8F2F\u6703\u54E1 "),ye=u("\u522A\u9664\u6703\u54E1"),he={class:"full-width row flex-center text-accent q-gutter-sm"},be={class:"col-12 col-sm-6 col-md-4 col-lg-3 q-pa-sm cursor-pointer"},we=["src"],ve={key:1,class:"text-left q-mx-auto"},ke={class:"row justify-between"},qe={class:"col-auto text-accent"},Ve={class:"col-auto text-secondary text-right q-ml-auto"},Ce={key:2,class:"text-left q-mx-auto"},Qe={class:"row justify-between"},je={class:"text-accent"},Pe={class:"text-secondary text-right"},Ue={key:3,class:"text-left q-mx-auto"},De={class:"row justify-between"},$e={class:"text-accent"},ze=u("\u7DE8\u8F2F\u6703\u54E1"),Le={class:"row justify-end q-my-sm",style:{height:"28.8px"}},Ne=u("\u522A\u9664\u6703\u54E1"),Se=o("p",{class:"text-h6 text-dark"},"\u6703\u54E1\u540D\u7A31",-1),Ae={class:"row col-6"},Be=o("div",{class:"col-12 text-h6 text-dark"},"\u6703\u54E1\u6027\u5225",-1),Fe={class:"col-12 row content-center q-my-sm",style:{height:"40px"}},Ie={class:"col-6 q-mr-xs"},Me=o("p",{class:"text-h6 text-dark"},"\u6703\u54E1\u751F\u65E5",-1),Te={class:"row items-center justify-end"},Ee=o("p",{class:"text-h6 text-dark"},"\u6703\u54E1\u624B\u6A5F",-1),Re=o("p",{class:"text-h6 text-dark"},"\u6703\u54E1\u4FE1\u7BB1",-1),Oe=o("p",{class:"text-h6 text-dark"},"\u6703\u54E1\u4F4F\u5740",-1),Ye={class:"row justify-around"},Ze=o("div",{class:"col-12 text-center text-h3 text-red q-pb-md"},"\u8B66\u544A",-1),Ge=o("div",{class:"col-12 text-center text-h6 text-dark q-pb-md"},[u("\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u6703\u54E1\u55CE\uFF1F"),o("br"),u("\u522A\u9664\u6703\u54E1\u5C07\u7121\u6CD5\u5FA9\u539F\uFF01")],-1),He={class:"col-12 row justify-around"},nt={__name:"AdminMemberView",setup(Je){const Q=Y(),{logout:B}=Q,{isLogin:j}=Z(Q),P=(a,t)=>"https://joeschmoe.io/api/v1//"+a+"/"+t;v(!0);const V=v(""),F=re(),I=v(!1),d=y([]),M=y({items:[],page:1,rowsPerPage:20}),s=y({_id:"",name:"",gender:1,birthday:"",email:"",tel:"",address:"",idx:-1,dialog:!1}),b=y({required(a){return!!a||"\u5FC5\u586B\u6B04\u4F4D"},price(a){return a>-1||"\u50F9\u683C\u5FC5\u9808\u5927\u65BC\u6216\u7B49\u65BC 0"},date(a){return t=>/^-?[\d]+\/[0-1]\d\/[0-3]\d$/.test(t)},size(a){var t,e,i;return!a||!a.length||((e=(t=a[0])==null?void 0:t.type)==null?void 0:e.includes("image"))&&((i=a[0])==null?void 0:i.size)<=1024*1024*2||"\u6A94\u6848\u683C\u5F0F\u4E0D\u7B26\uFF08\u9808\u70BA\u5716\u7247\u6A94\uFF0C\u4E14\u6A94\u6848\u5927\u5C0F 2 MB \u4EE5\u4E0B\uFF09"}}),T=async()=>{try{if(s._id.length===0){const{data:a}=await k.post("/users",s);d.push(a.result),g.fire({icon:"success",title:"\u65B0\u589E\u6210\u529F",text:"\u60A8\u5DF2\u6210\u529F\u65B0\u589E\u4E00\u540D\u6703\u54E1\uFF01"}),w()}else{const{data:a}=await k.patch("/users/"+s._id,s);d[s.idx]=a.result,g.fire({icon:"success",title:"\u4FEE\u6539\u6210\u529F",text:"\u60A8\u5DF2\u6210\u529F\u4FEE\u6539\u8A72\u540D\u6703\u54E1\uFF01"})}s.dialog=!1,w()}catch(a){g.fire({icon:"error",title:"\u65B0\u589E\u5931\u6557",text:a.isAxiosError?a.response.data.message:a.message})}},x=y({dialog:!1}),U=v(""),D=a=>{U.value=a,x.dialog=!0},E=async a=>{x.dialog=!1;try{await k.delete("/users/"+a),await g.fire({icon:"success",title:"\u522A\u9664\u6210\u529F",text:"\u60A8\u5DF2\u6210\u529F\u522A\u9664\u8A72\u540D\u6703\u54E1\uFF01"}),w()}catch(t){g.fire({icon:"error",title:"\u522A\u9664\u5931\u6557",text:t.isAxiosError?t.response.data.message:t.message})}},$=(a,t)=>{s._id=a,t>-1?(s.name=d[t].name,s.gender=d[t].gender,s.birthday=d[t].birthday,s.email=d[t].email,s.tel=d[t].tel,s.address=d[t].address):(s.name="",s.gender="",s.birthday="",s.email="",s.tel="",s.address=""),s.image=[],s.idx=t,s.dialog=!0},R=[{name:"image",label:"\u6703\u54E1\u7167\u7247",align:"center"},{name:"account",label:"\u6703\u54E1\u5E33\u865F",align:"center",field:a=>a.account},{name:"role",label:"\u6703\u54E1\u8EAB\u4EFD",align:"center",field:a=>a.role===1?"\u7BA1\u7406\u8005":"\u4E00\u822C\u6703\u54E1"},{name:"name",label:"\u6703\u54E1\u59D3\u540D",align:"center",field:a=>a.name},{name:"tel",label:"\u6703\u54E1\u624B\u6A5F",align:"center",field:a=>a.tel},{name:"email",label:"\u6703\u54E1\u4FE1\u7BB1",align:"center",field:a=>a.email},{name:"control",label:"\u6703\u54E1\u7BA1\u7406",align:"center"}],w=async()=>{try{const{data:a}=await k.get("/users/all");d.splice(0,d.length),d.push(...a.result)}catch(a){g.fire({icon:"error",title:"\u5931\u6557",text:a.isAxiosError?a.response.data.message:a.message})}};return w(),(a,t)=>(c(),m(G,{class:"column"},{default:n(()=>[o("div",de,[l(H,{class:"text-h5 text-secondary mobile-none"},{default:n(()=>[q(j)?(c(),m(r,{key:0,round:"",dense:"",flat:"",icon:"fa-solid fa-house",to:"/",class:"q-mx-xs"},{default:n(()=>[l(z,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:n(()=>[ce]),_:1})]),_:1})):f("",!0),q(j)?(c(),m(r,{key:1,round:"",dense:"",flat:"",icon:"fa-solid fa-right-from-bracket",onClick:q(B),class:"q-ml-xl q-mr-lg"},{default:n(()=>[l(z,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:n(()=>[ue]),_:1})]),_:1},8,["onClick"])):f("",!0)]),_:1})]),o("div",me,[fe,o("div",ge,[l(le,{grid:q(F).screen.lt.xl,columns:R,rows:d,"row-key":"name",square:"",bordered:"","wrap-cells":"","binary-state-sort":"",dense:"",filter:V.value,loading:I.value,pagination:M,"rows-per-page-label":"\u6BCF\u9801\u986F\u793A\u7B46\u6578","no-data-label":"\u76EE\u524D\u6C92\u6709\u65B0\u589E\u4EFB\u4F55\u6703\u54E1","no-results-label":"Oops...\u627E\u4E0D\u5230\u8A72\u6703\u54E1"},{"body-cell-image":n(e=>[l(S,{img:e,align:"center",ellipsis:""},{default:n(()=>[l(te,{square:"",size:"100px"},{default:n(()=>[o("img",{src:P(e.row.gender===1?"male":"female",e.row.account),class:"q-mb-xl",style:{"object-fit":"cover"}},null,8,pe)]),_:2},1024)]),_:2},1032,["img"])]),"top-right":n(()=>[l(p,{borderless:"",dense:"",debounce:"300",modelValue:V.value,"onUpdate:modelValue":t[0]||(t[0]=e=>V.value=e),placeholder:"\xA0Search",class:"search"},{append:n(()=>[l(L,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-control":n(e=>[l(S,{control:e},{default:n(()=>[o("div",_e,[l(r,{class:"col-auto q-mx-sm",onClick:i=>$(e.row._id,e.rowIndex),outline:""},{default:n(()=>[xe]),_:2},1032,["onClick"]),l(r,{class:"col-auto q-mx-sm",onClick:i=>D(e.row._id),outline:""},{default:n(()=>[ye]),_:2},1032,["onClick"])])]),_:2},1032,["control"])]),pagination:n(e=>[e.pagesNumber>1?(c(),m(r,{key:0,icon:"first_page",color:"secondary",round:"",dense:"",flat:"",disable:e.isFirstPage,onClick:e.firstPage},null,8,["disable","onClick"])):f("",!0),l(r,{icon:"chevron_left",color:"secondary",round:"",dense:"",flat:"",disable:e.isFirstPage,onClick:e.prevPage},null,8,["disable","onClick"]),l(r,{icon:"chevron_right",color:"secondary",round:"",dense:"",flat:"",disable:e.isLastPage,onClick:e.nextPage},null,8,["disable","onClick"]),e.pagesNumber>1?(c(),m(r,{key:1,icon:"last_page",color:"secondary",round:"",dense:"",flat:"",disable:e.isLastPage,onClick:e.lastPage},null,8,["disable","onClick"])):f("",!0)]),"no-data":n(({message:e})=>[o("div",he,[o("span",null,_(e),1)])]),item:n(e=>[o("div",be,[l(C,{square:"",bordered:"",class:"bg-primary shadow",style:{height:"100%"}},{default:n(()=>[(c(!0),h(K,null,J(e.cols,i=>(c(),h("div",{key:i.name,class:"q-pa-sm"},[i.name=="image"?(c(),m(se,{key:0,ratio:1/1},{default:n(()=>[o("img",{src:P(e.row.gender===1?"male":"female",e.row.account),class:"q-mb-xl",style:{"object-fit":"cover"}},null,8,we)]),_:2},1024)):f("",!0),i.name==="email"?(c(),h("div",ve,[o("div",ke,[o("span",qe,_(i.label)+"\uFF1A",1),o("span",Ve,_(i.value),1)])])):i.name!=="image"&&i.name!=="email"&&i.name!=="control"?(c(),h("div",Ce,[o("div",Qe,[o("span",je,_(i.label)+"\uFF1A",1),o("span",Pe,_(i.value),1)])])):i.name==="control"?(c(),h("div",Ue,[o("div",De,[o("span",$e,_(i.label)+"\uFF1A",1),l(r,{class:"col-auto text-secondary",style:{"font-size":"small",padding:"0px 8px"},onClick:O=>$(e.row._id,e.rowIndex),outline:""},{default:n(()=>[ze]),_:2},1032,["onClick"])]),o("div",Le,[l(r,{class:"col-auto text-secondary",style:{"font-size":"small",padding:"0px 8px"},onClick:O=>D(e.row._id),outline:""},{default:n(()=>[Ne]),_:2},1032,["onClick"])])])):f("",!0)]))),128))]),_:2},1024)])]),loading:n(()=>[l(ae,{showing:"",dark:"","transition-show":"fade",color:"primary"})]),_:1},8,["grid","rows","filter","loading","pagination"])]),l(A,{modelValue:s.dialog,"onUpdate:modelValue":t[10]||(t[10]=e=>s.dialog=e),seamless:""},{default:n(()=>[s.dialog?(c(),m(C,{key:0,id:"dialog",flat:"",square:"",bordered:"",persistent:"",class:"bg-info text-secondary shadow-white"},{default:n(()=>[l(W,{onSubmit:X(T,["prevent"]),class:"q-pa-md"},{default:n(()=>[Se,l(p,{modelValue:s.name,"onUpdate:modelValue":t[1]||(t[1]=e=>s.name=e),rules:[b.required],type:"text",outlined:"",square:"",dense:""},null,8,["modelValue","rules"]),o("div",Ae,[Be,o("div",Fe,[l(N,{dense:"",size:"xs",modelValue:s.gender,"onUpdate:modelValue":t[2]||(t[2]=e=>s.gender=e),val:1,label:"\u5148\u751F",class:"text-dark q-mr-xl"},null,8,["modelValue"]),l(N,{dense:"",size:"xs",modelValue:s.gender,"onUpdate:modelValue":t[3]||(t[3]=e=>s.gender=e),val:2,label:"\u5C0F\u59D0",class:"text-dark q-ml-xl"},null,8,["modelValue"])])]),o("div",Ie,[Me,l(p,{filled:"",modelValue:s.birthday,"onUpdate:modelValue":t[5]||(t[5]=e=>s.birthday=e),dense:"",mask:"date",rules:[b.date]},{append:n(()=>[l(L,{name:"event",class:"cursor-pointer"},{default:n(()=>[l(oe,{ref:"qDateProxy","transition-show":"scale","transition-hide":"scale"},{default:n(()=>[l(ne,{modelValue:s.birthday,"onUpdate:modelValue":t[4]||(t[4]=e=>s.birthday=e),title:s.name,subtitle:"\u8ACB\u9078\u64C7\u751F\u65E5",class:"bg-info"},{default:n(()=>[o("div",Te,[ee(l(r,{label:"\u95DC\u9589",color:"primary",flat:""},null,512),[[ie]])])]),_:1},8,["modelValue","title"])]),_:1},512)]),_:1})]),_:1},8,["modelValue","rules"])]),Ee,l(p,{modelValue:s.tel,"onUpdate:modelValue":t[6]||(t[6]=e=>s.tel=e),rules:[b.required],mask:"####-###-###",outlined:"",square:"",dense:"",class:"text-primary"},null,8,["modelValue","rules"]),Re,l(p,{modelValue:s.email,"onUpdate:modelValue":t[7]||(t[7]=e=>s.email=e),rules:[b.required],outlined:"",square:"",dense:"",class:"text-primary"},null,8,["modelValue","rules"]),Oe,l(p,{modelValue:s.address,"onUpdate:modelValue":t[8]||(t[8]=e=>s.address=e),outlined:"",square:"",dense:"",class:"text-primary"},null,8,["modelValue"]),o("div",Ye,[l(r,{square:"",flat:"",type:"submit",class:"col-4 bg-secondary text-dark q-my-sm",label:"\u9001\u51FA\u7DE8\u8F2F"}),l(r,{square:"",flat:"",outline:"",class:"col-4 bg-dark text-secondary q-my-sm",label:"\u53D6\u6D88",onClick:t[9]||(t[9]=e=>s.dialog=!1)})])]),_:1},8,["onSubmit"])]),_:1})):f("",!0)]),_:1},8,["modelValue"]),l(A,{modelValue:x.dialog,"onUpdate:modelValue":t[13]||(t[13]=e=>x.dialog=e),seamless:"",persistent:""},{default:n(()=>[l(C,{square:"",class:"row justify-center bg-info q-pa-lg"},{default:n(()=>[Ze,Ge,o("div",He,[l(r,{onClick:t[11]||(t[11]=e=>E(U.value)),square:"",flat:"",class:"col-4 bg-secondary text-dark q-my-sm",label:"\u522A\u9664"}),l(r,{square:"",flat:"",outline:"",class:"col-4 bg-dark text-secondary q-my-sm",label:"\u53D6\u6D88",onClick:t[12]||(t[12]=e=>x.dialog=!1)})])]),_:1})]),_:1},8,["modelValue"])])]),_:1}))}};export{nt as default};
