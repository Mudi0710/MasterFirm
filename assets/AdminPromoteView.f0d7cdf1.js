import{p as Y,s as H,r as Q,a as p,o as u,c as _,w as a,Q as J,aY as v,S as x,d as i,e as o,q as m,i as n,t as N,v as g,z as K,m as d,y as f,L as C,M as W,N as X,k as Z,j as S,f as F,g as T}from"./index.1dec3fce.js";import{Q as D}from"./QTd.2d266956.js";import{Q as P}from"./QCard.9aebe9b7.js";import{Q as ee,a as te,b as $}from"./QTable.1d8bce75.js";import{Q as se}from"./QFile.93fa895f.js";import{Q as ae}from"./QEditor.7f257ecf.js";import{u as oe}from"./use-quasar.18717ccc.js";const le={id:"myheader",class:"row justify-end items-center",style:{width:"100%"}},ie=d(" \u56DE\u524D\u53F0 "),ne=d(" \u767B\u51FA "),re={id:"mycontent",class:""},de=i("div",{class:"row justify-between"},[i("div",{class:"col-auto text-h3 text-secondary q-my-sm q-pl-md"},"\u63A8\u64AD\u7BA1\u7406")],-1),ce={class:"q-pa-md"},ue=i("div",{class:"bg-accent text-h5 text-dark q-my-sm",style:{height:"1px"}},null,-1),me=i("div",{class:"text-h5 text-accent q-my-sm",style:{height:"40px","line-height":"1.6em"}},"\u9996\u9801\u5BA3\u50B3\u6587\u6848",-1),fe=d("\u65B0\u589E\u5BA3\u50B3\u6587\u6848"),ge={class:"row justify-center"},pe=d(" \u4FEE\u6539\u6587\u6848"),_e=d(" \u522A\u9664\u6587\u6848"),xe={class:"full-width row flex-center text-accent q-gutter-sm"},be={class:"col-12 col-sm-6 col-md-4 col-lg-3 q-pa-sm cursor-pointer"},ye={key:0,class:"row justify-between"},he={class:"text-accent"},we={class:"text-secondary ellipsis",style:{"max-width":"300px"}},ke={key:1,class:"row justify-start"},qe={class:"col-12 row justify-between"},ve={class:"text-accent"},Ce=d("\u4FEE\u6539\u6587\u6848"),Ve={class:"col-12 row justify-end q-mt-sm"},Qe=d("\u522A\u9664\u6587\u6848"),Se=i("p",{class:"text-h6 text-dark"},"\u6587\u6848\u6A19\u984C",-1),De=i("p",{class:"text-h6 text-dark"},"\u6587\u6848\u526F\u6A19",-1),Pe=i("p",{class:"text-h6 text-dark"},"\u6587\u6848\u5716\u7247",-1),ze=i("p",{class:"text-h6 text-dark"},"\u6587\u6848\u5167\u5BB9",-1),je={class:"row justify-around"},Ie=i("div",{class:"col-12 text-center text-h3 text-red q-pb-md"},"\u8B66\u544A",-1),Ne={class:"col-12 text-center text-h6 text-dark q-pb-md"},Fe=i("br",null,null,-1),Te={class:"col-12 row justify-around"},Oe={__name:"AdminPromoteView",setup($e){const z=Y(),{logout:E}=z,{isLogin:j}=H(z),B=Q(""),b=oe(),L=Q(!1),c=p([]),U=p({items:[],page:1,rowsPerPage:0}),l=p({_id:"",title:"",subtitle:"",content:"",image:[],idx:-1,dialog:!1}),w=Q(null),A=s=>{if(s.target.nodeName==="INPUT")return;let e,t;s.preventDefault(),s.stopPropagation(),s.originalEvent&&s.originalEvent.clipboardData.getData?(e=s.originalEvent.clipboardData.getData("text/plain"),w.value.runCmd("insertText",e)):s.clipboardData&&s.clipboardData.getData?(e=s.clipboardData.getData("text/plain"),w.value.runCmd("insertText",e)):window.clipboardData&&window.clipboardData.getData&&(t||(t=!0,w.value.runCmd("ms-pasteTextOnly",e)),t=!1)},k=p({required(s){return!!s||"\u5FC5\u586B\u6B04\u4F4D"},size(s){var e,t,r;return!s||!s.length||((t=(e=s[0])==null?void 0:e.type)==null?void 0:t.includes("image"))&&((r=s[0])==null?void 0:r.size)<=1024*1024*2||"\u6A94\u6848\u683C\u5F0F\u4E0D\u7B26\uFF08\u9808\u70BA\u5716\u7247\u6A94\uFF0C\u4E14\u6A94\u6848\u5927\u5C0F 2 MB \u4EE5\u4E0B\uFF09"}}),M=async()=>{const s=new FormData;for(const e in l)if(!["_id","idx","dialog"].includes(e))if(e==="image")for(const t of l.image)s.append(e,t);else s.append(e,l[e]);try{if(l._id.length===0){const{data:e}=await v.post("/slogan",s);c.push(e.result),x.fire({icon:"success",title:"\u65B0\u589E\u6210\u529F",text:"\u60A8\u5DF2\u6210\u529F\u65B0\u589E\u4E00\u7B46\u5BA3\u50B3\u6587\u6848\uFF01"}),q()}else{const{data:e}=await v.patch("/slogan/"+l._id,s);c[l.idx]=e.result,x.fire({icon:"success",title:"\u4FEE\u6539\u6210\u529F",text:"\u60A8\u5DF2\u6210\u529F\u4FEE\u6539\u8A72\u7B46\u5BA3\u50B3\u6587\u6848\uFF01"}),q()}l.dialog=!1}catch(e){x.fire({icon:"error",title:"\u65B0\u589E\u5931\u6557",text:e.isAxiosError?e.response.data.message:e.message})}},y=p({dialog:!1}),h=p({_id:"",title:""}),I=(s,e)=>{h._id=s,h.title=e,y.dialog=!0},R=async s=>{y.dialog=!1;try{await v.delete("/slogan/"+s),await x.fire({icon:"success",title:"\u522A\u9664\u6210\u529F",text:"\u60A8\u5DF2\u6210\u529F\u522A\u9664\u8A72\u7B46\u5BA3\u50B3\u6587\u6848\uFF01"}),q()}catch(e){x.fire({icon:"error",title:"\u522A\u9664\u5931\u6557",text:e.isAxiosError?e.response.data.message:e.message})}},V=(s,e)=>{l._id=s,e>-1?(l.title=c[e].title,l.subtitle=c[e].subtitle,l.content=c[e].content):(l.title="",l.subtitle="",l.content=""),l.image=[],l.idx=e,l.dialog=!0},O=[{name:"title",label:"\u6587\u6848\u6A19\u984C",field:s=>s.title,align:"center"},{name:"subtitle",label:"\u6587\u6848\u526F\u6A19",field:s=>s.subtitle,align:"center"},{name:"edit",label:"\u6587\u6848\u7DE8\u8F2F",align:"center"}],q=async()=>{try{const{data:s}=await v.get("/slogan/all");c.splice(0,c.length),c.push(...s.result)}catch(s){x.fire({icon:"error",title:"\u5931\u6557",text:s.isAxiosError?s.response.data.message:s.message})}};return q(),(s,e)=>(u(),_(J,{class:"column"},{default:a(()=>[i("div",le,[o(K,{class:"text-h5 text-secondary mobile-none"},{default:a(()=>[m(j)?(u(),_(n,{key:0,round:"",dense:"",flat:"",icon:"fa-solid fa-house",to:"/",class:"q-mx-xs"},{default:a(()=>[o(N,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:a(()=>[ie]),_:1})]),_:1})):g("",!0),m(j)?(u(),_(n,{key:1,round:"",dense:"",flat:"",icon:"fa-solid fa-right-from-bracket",onClick:m(E),class:"q-ml-xl q-mr-lg"},{default:a(()=>[o(N,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:a(()=>[ne]),_:1})]),_:1},8,["onClick"])):g("",!0)]),_:1})]),i("div",re,[de,i("div",ce,[ue,me,o(te,{grid:m(b).screen.lt.xl,columns:O,rows:c,"row-key":"title",separator:"cell",square:"",bordered:"","wrap-cells":"","binary-state-sort":"",dense:"",filter:B.value,loading:L.value,pagination:U,"rows-per-page-label":"\u6BCF\u9801\u986F\u793A\u7B46\u6578","no-data-label":"\u76EE\u524D\u6C92\u6709\u65B0\u589E\u4EFB\u4F55\u5BA3\u50B3\u6587\u6848","no-results-label":"Oops...\u627E\u4E0D\u5230\u8A72\u7B46\u5BA3\u50B3\u6587\u6848",class:"bg-transparent"},{"top-left":a(()=>[o(n,{onClick:e[0]||(e[0]=t=>V("",-1)),square:"",flat:"",disable:c.length>0,class:"col-auto q-mr-xl bg-secondary text-dark text-body1 q-my-sm createBtn"},{default:a(()=>[fe]),_:1},8,["disable"])]),"body-cell-title":a(t=>[o(D,{title:t,class:"ellipsis",style:{"max-width":"150px"}},{default:a(()=>[d(f(t.row.title),1)]),_:2},1032,["title"])]),"body-cell-subtitle":a(t=>[o(D,{subtitle:t,class:"ellipsis",style:{"max-width":"400px"}},{default:a(()=>[d(f(t.row.subtitle),1)]),_:2},1032,["subtitle"])]),"body-cell-edit":a(t=>[o(D,{edit:t,style:{"max-width":"150px"}},{default:a(()=>[i("div",ge,[o(n,{class:"col-auto q-mx-sm q-my-xs",onClick:r=>V(t.row._id,t.rowIndex),outline:""},{default:a(()=>[pe]),_:2},1032,["onClick"]),o(n,{class:"col-auto q-mx-sm q-my-xs",onClick:r=>I(t.row._id,t.row.title),outline:""},{default:a(()=>[_e]),_:2},1032,["onClick"])])]),_:2},1032,["edit"])]),pagination:a(t=>[t.pagesNumber>1?(u(),_(n,{key:0,icon:"first_page",color:"secondary",round:"",dense:"",flat:"",disable:t.isFirstPage,onClick:t.firstPage},null,8,["disable","onClick"])):g("",!0),o(n,{icon:"chevron_left",color:"secondary",round:"",dense:"",flat:"",disable:t.isFirstPage,onClick:t.prevPage},null,8,["disable","onClick"]),o(n,{icon:"chevron_right",color:"secondary",round:"",dense:"",flat:"",disable:t.isLastPage,onClick:t.nextPage},null,8,["disable","onClick"]),t.pagesNumber>1?(u(),_(n,{key:1,icon:"last_page",color:"secondary",round:"",dense:"",flat:"",disable:t.isLastPage,onClick:t.lastPage},null,8,["disable","onClick"])):g("",!0)]),"no-data":a(({message:t})=>[i("div",xe,[i("span",null,f(t),1)])]),item:a(t=>[i("div",be,[o(P,{square:"",bordered:"",class:"bg-primary shadow",style:{width:"100%"}},{default:a(()=>[(u(!0),C(X,null,W(t.cols,r=>(u(),C("div",{key:r.name,class:"q-pa-sm"},[r.name!=="edit"?(u(),C("div",ye,[i("span",he,f(r.label)+"\uFF1A",1),i("span",we,f(r.value),1)])):g("",!0),r.name==="edit"?(u(),C("div",ke,[i("div",qe,[i("span",ve,f(r.label)+"\uFF1A",1),o(n,{class:"col-auto text-secondary",style:{"font-size":"xx-small",padding:"0px 8px"},onClick:G=>V(t.row._id,t.rowIndex),outline:""},{default:a(()=>[Ce]),_:2},1032,["onClick"])]),i("div",Ve,[o(n,{class:"col-auto text-secondary",style:{"font-size":"xx-small",padding:"0px 8px"},onClick:G=>I(t.row._id,t.row.title),outline:""},{default:a(()=>[Qe]),_:2},1032,["onClick"])])])):g("",!0)]))),128))]),_:2},1024)])]),loading:a(()=>[o(ee,{showing:"",dark:"","transition-show":"fade",color:"primary"})]),_:1},8,["grid","rows","filter","loading","pagination"]),o($,{modelValue:l.dialog,"onUpdate:modelValue":e[8]||(e[8]=t=>l.dialog=t),seamless:""},{default:a(()=>[l.dialog?(u(),_(P,{key:0,id:"dialog",flat:"",square:"",bordered:"",persistent:"",class:"bg-info text-secondary shadow-white"},{default:a(()=>[o(Z,{onSubmit:S(M,["prevent"]),class:"q-pa-md"},{default:a(()=>[Se,o(F,{modelValue:l.title,"onUpdate:modelValue":e[1]||(e[1]=t=>l.title=t),rules:[k.required],type:"text",outlined:"",square:"",dense:""},null,8,["modelValue","rules"]),De,o(F,{modelValue:l.subtitle,"onUpdate:modelValue":e[2]||(e[2]=t=>l.subtitle=t),rules:[k.required],type:"text",outlined:"",square:"",dense:""},null,8,["modelValue","rules"]),Pe,o(se,{modelValue:l.image,"onUpdate:modelValue":e[5]||(e[5]=t=>l.image=t),multiple:"",rules:[k.size],accept:"image/*",filled:"","bottom-slots":"",counter:""},{prepend:a(()=>[o(T,{name:"cloud_upload",onClick:e[3]||(e[3]=S(()=>{},["stop","prevent"]))})]),append:a(()=>[o(T,{name:"close",onClick:e[4]||(e[4]=S(t=>s.model=null,["stop","prevent"])),class:"cursor-pointer"})]),hint:a(()=>[]),_:1},8,["modelValue","rules"]),ze,o(ae,{model:"qeditor",modelValue:l.content,"onUpdate:modelValue":e[6]||(e[6]=t=>l.content=t),ref_key:"editorRef",ref:w,onPaste:A,rules:[k.required],outlined:"",square:"","content-class":"bg-dark","toolbar-bg":"secondary","toolbar-text-color":"dark",dense:m(b).screen.lt.lg,toolbar:[["bold","italic","strike","underline","subscript","superscript"],["left","center","right","justify"],["token","hr","link","custom_btn"],["print","fullscreen"],[{icon:m(b).iconSet.editor.formatting,fixedIcon:!1,list:"no-icons",options:["p","h1","h2","h3","h4","h5","h6","code"]},{icon:m(b).iconSet.editor.fontSize,fixedIcon:!1,list:"no-icons",options:["size-1","size-2","size-3","size-4","size-5","size-6","size-7"]},{icon:m(b).iconSet.editor.font,fixedIcon:!0,list:"no-icons",options:["default_font","arial","arial_black","comic_sans","courier_new","impact","lucida_grande","times_new_roman","verdana"]},"removeFormat"],["quote","unordered","ordered","outdent","indent"],["undo","redo"],["viewsource"]],fonts:{arial:"Arial",arial_black:"Arial Black",comic_sans:"Comic Sans MS",courier_new:"Courier New",impact:"Impact",lucida_grande:"Lucida Grande",times_new_roman:"Times New Roman",verdana:"Verdana"}},null,8,["modelValue","rules","dense","toolbar"]),i("div",je,[o(n,{square:"",flat:"",type:"submit",class:"col-4 bg-secondary text-dark q-my-sm",label:"\u9001\u51FA\u7DE8\u8F2F"}),o(n,{square:"",flat:"",outline:"",class:"col-4 bg-dark text-secondary q-my-sm",label:"\u53D6\u6D88",onClick:e[7]||(e[7]=t=>l.dialog=!1)})])]),_:1},8,["onSubmit"])]),_:1})):g("",!0)]),_:1},8,["modelValue"]),o($,{modelValue:y.dialog,"onUpdate:modelValue":e[11]||(e[11]=t=>y.dialog=t),seamless:"",persistent:""},{default:a(()=>[o(P,{square:"",class:"row justify-center bg-info q-pa-lg"},{default:a(()=>[Ie,i("div",Ne,[d("\u4F60\u78BA\u5B9A\u8981\u522A\u9664\u3010"+f(h.title)+"\u3011\u6587\u6848\u55CE\uFF1F",1),Fe,d("\u522A\u9664\u3010"+f(h.title)+"\u3011\u6587\u6848\u5C07\u7121\u6CD5\u5FA9\u539F\uFF01",1)]),i("div",Te,[o(n,{onClick:e[9]||(e[9]=t=>R(h._id)),square:"",flat:"",class:"col-4 bg-secondary text-dark q-my-sm",label:"\u78BA\u5B9A\u522A\u9664"}),o(n,{square:"",flat:"",outline:"",class:"col-4 bg-dark text-secondary q-my-sm",label:"\u53D6\u6D88",onClick:e[10]||(e[10]=t=>y.dialog=!1)})])]),_:1})]),_:1},8,["modelValue"])])])]),_:1}))}};export{Oe as default};
