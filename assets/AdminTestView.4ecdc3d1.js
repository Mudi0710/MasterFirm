import{p as z,s as M,r as q,a as f,o as r,c as p,w as t,Q as O,aY as h,S as _,d as l,e as a,q as b,i as n,t as j,v as m,z as R,y as x,L as w,M as Y,N as G,k as H,j as J,f as K,m as d}from"./index.e22ceb5a.js";import{Q as P}from"./QTd.a1961e4a.js";import{Q as v}from"./QCard.6c204a93.js";import{Q as W,a as X,b as $}from"./QTable.f0578d3a.js";import{u as Z}from"./use-quasar.5cdb8c52.js";const ee={id:"myheader",class:"row justify-end items-center",style:{width:"100%"}},te=d(" \u56DE\u524D\u53F0 "),se=d(" \u767B\u51FA "),ae={id:"mycontent",class:""},le=l("div",{class:"row justify-between"},[l("div",{class:"col-auto text-h3 text-secondary q-my-sm q-pl-md"},"\u63A8\u64AD\u7BA1\u7406")],-1),oe={class:"q-pa-md"},ie=l("div",{class:"bg-accent text-h5 text-dark q-my-sm",style:{height:"1px"}},null,-1),ne=l("div",{class:"text-h5 text-accent q-my-sm",style:{height:"40px","line-height":"1.6em"}},"\u806F\u7D61\u5730\u5716",-1),re=d("\u65B0\u589E\u806F\u7D61\u5730\u5716"),de={class:"ellipsis-3-lines"},ce={class:"row justify-center"},ue=d(" \u4FEE\u6539\u5730\u5716"),me=d(" \u522A\u9664\u5730\u5716"),fe={class:"full-width row flex-center text-accent q-gutter-sm"},pe={class:"col-12 col-lg-6 q-pa-sm cursor-pointer"},_e={key:0,class:"row justify-between"},ge={class:"col-12 text-accent"},xe={class:"col-12 text-secondary ellipsis-3-lines",style:{"max-width":"300px"}},ye={key:1,class:"row justify-start"},he={class:"col-12 row justify-between"},be={class:"text-accent"},we=d("\u4FEE\u6539\u5730\u5716"),ke={class:"col-12 row justify-end q-mt-sm"},qe=d("\u522A\u9664\u5730\u5716"),ve=l("p",{class:"text-h6 text-dark"},"\u806F\u7D61\u5730\u5716",-1),Ce={class:"row justify-around"},Le=l("div",{class:"col-12 text-center text-h3 text-red q-pb-md"},"\u8B66\u544A",-1),Qe=l("div",{class:"col-12 text-center text-h6 text-dark q-pb-md"},[d("\u4F60\u78BA\u5B9A\u8981\u522A\u9664\u806F\u7D61\u5730\u5716\u55CE\uFF1F"),l("br"),d("\u522A\u9664\u806F\u7D61\u5730\u5716\u5C07\u7121\u6CD5\u5FA9\u539F\uFF01")],-1),Ve={class:"col-12 row justify-around"},Fe={__name:"AdminTestView",setup(je){const C=z(),{logout:N}=C,{isLogin:L}=M(C),B=q(""),D=Z(),F=q(!1),c=f([]),S=f({items:[],page:1,rowsPerPage:0}),i=f({_id:"",localmap:"",idx:-1,dialog:!1});q(null);const T=f({required(s){return!!s||"\u5FC5\u586B\u6B04\u4F4D"}}),A=async()=>{try{if(i._id.length===0){const{data:s}=await h.post("/localmap",i);c.push(s.result),_.fire({icon:"success",title:"\u65B0\u589E\u6210\u529F",text:"\u60A8\u5DF2\u6210\u529F\u65B0\u589E\u4E00\u7B46\u806F\u7D61\u5730\u5716\uFF01"}),y()}else{const{data:s}=await h.patch("/localmap/"+i._id,i);c[i.idx]=s.result,_.fire({icon:"success",title:"\u4FEE\u6539\u6210\u529F",text:"\u60A8\u5DF2\u6210\u529F\u4FEE\u6539\u8A72\u7B46\u806F\u7D61\u5730\u5716\uFF01"}),y()}i.dialog=!1}catch(s){_.fire({icon:"error",title:"\u65B0\u589E\u5931\u6557",text:s.isAxiosError?s.response.data.message:s.message})}},g=f({dialog:!1}),Q=f({_id:"",title:""}),V=s=>{Q._id=s,g.dialog=!0},E=async s=>{g.dialog=!1;try{await h.delete("/localmap/"+s),await _.fire({icon:"success",title:"\u522A\u9664\u6210\u529F",text:"\u60A8\u5DF2\u6210\u529F\u522A\u9664\u8A72\u7B46\u806F\u7D61\u5730\u5716\uFF01"}),y()}catch(o){_.fire({icon:"error",title:"\u522A\u9664\u5931\u6557",text:o.isAxiosError?o.response.data.message:o.message})}},k=(s,o)=>{i._id=s,o>-1?i.localmap=c[o].localmap:i.localmap="",i.idx=o,i.dialog=!0},I=[{name:"localmap",label:"\u5730\u5716",field:s=>s.localmap,align:"left"},{name:"edit",label:"\u7DE8\u8F2F",align:"center"}],y=async()=>{try{const{data:s}=await h.get("/localmap/all");c.splice(0,c.length),c.push(...s.result)}catch(s){_.fire({icon:"error",title:"\u5931\u6557",text:s.isAxiosError?s.response.data.message:s.message})}};return y(),(s,o)=>(r(),p(O,{class:"column"},{default:t(()=>[l("div",ee,[a(R,{class:"text-h5 text-secondary mobile-none"},{default:t(()=>[b(L)?(r(),p(n,{key:0,round:"",dense:"",flat:"",icon:"fa-solid fa-house",to:"/",class:"q-mx-xs"},{default:t(()=>[a(j,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:t(()=>[te]),_:1})]),_:1})):m("",!0),b(L)?(r(),p(n,{key:1,round:"",dense:"",flat:"",icon:"fa-solid fa-right-from-bracket",onClick:b(N),class:"q-ml-xl q-mr-lg"},{default:t(()=>[a(j,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:t(()=>[se]),_:1})]),_:1},8,["onClick"])):m("",!0)]),_:1})]),l("div",ae,[le,l("div",oe,[ie,ne,a(X,{grid:b(D).screen.lt.xl,columns:I,rows:c,"row-key":"title",separator:"cell",square:"",bordered:"","wrap-cells":"","binary-state-sort":"",dense:"",filter:B.value,loading:F.value,pagination:S,"rows-per-page-label":"\u6BCF\u9801\u986F\u793A\u7B46\u6578","no-data-label":"\u76EE\u524D\u6C92\u6709\u65B0\u589E\u4EFB\u4F55\u806F\u7D61\u5730\u5716","no-results-label":"Oops...\u627E\u4E0D\u5230\u8A72\u7B46\u5BA3\u50B3\u806F\u7D61\u5730\u5716",class:"bg-transparent"},{"top-left":t(()=>[a(n,{onClick:o[0]||(o[0]=e=>k("",-1)),square:"",flat:"",disable:c.length>0,class:"col-auto q-mr-xl bg-secondary text-dark text-body1 q-my-sm createBtn"},{default:t(()=>[re]),_:1},8,["disable"])]),"body-cell-localmap":t(e=>[a(P,{localmap:e,style:{"max-width":"150px"}},{default:t(()=>[l("div",de,x(e.row.localmap),1)]),_:2},1032,["localmap"])]),"body-cell-edit":t(e=>[a(P,{edit:e,style:{"max-width":"150px"}},{default:t(()=>[l("div",ce,[a(n,{class:"col-auto q-mx-sm q-my-xs",onClick:u=>k(e.row._id,e.rowIndex),outline:""},{default:t(()=>[ue]),_:2},1032,["onClick"]),a(n,{class:"col-auto q-mx-sm q-my-xs",onClick:u=>V(e.row._id),outline:""},{default:t(()=>[me]),_:2},1032,["onClick"])])]),_:2},1032,["edit"])]),pagination:t(e=>[e.pagesNumber>1?(r(),p(n,{key:0,icon:"first_page",color:"secondary",round:"",dense:"",flat:"",disable:e.isFirstPage,onClick:e.firstPage},null,8,["disable","onClick"])):m("",!0),a(n,{icon:"chevron_left",color:"secondary",round:"",dense:"",flat:"",disable:e.isFirstPage,onClick:e.prevPage},null,8,["disable","onClick"]),a(n,{icon:"chevron_right",color:"secondary",round:"",dense:"",flat:"",disable:e.isLastPage,onClick:e.nextPage},null,8,["disable","onClick"]),e.pagesNumber>1?(r(),p(n,{key:1,icon:"last_page",color:"secondary",round:"",dense:"",flat:"",disable:e.isLastPage,onClick:e.lastPage},null,8,["disable","onClick"])):m("",!0)]),"no-data":t(({message:e})=>[l("div",fe,[l("span",null,x(e),1)])]),item:t(e=>[l("div",pe,[a(v,{square:"",bordered:"",class:"bg-primary shadow",style:{width:"100%",height:"100%"}},{default:t(()=>[(r(!0),w(G,null,Y(e.cols,u=>(r(),w("div",{key:u.name,class:"q-pa-sm"},[u.name==="localmap"?(r(),w("div",_e,[l("span",ge,x(u.label)+"\uFF1A",1),l("span",xe,x(u.value),1)])):m("",!0),u.name==="edit"?(r(),w("div",ye,[l("div",he,[l("span",be,x(u.label)+"\uFF1A",1),a(n,{class:"col-auto text-secondary",style:{"font-size":"xx-small",padding:"0px 8px"},onClick:U=>k(e.row._id,e.rowIndex),outline:""},{default:t(()=>[we]),_:2},1032,["onClick"])]),l("div",ke,[a(n,{class:"col-auto text-secondary",style:{"font-size":"xx-small",padding:"0px 8px"},onClick:U=>V(e.row._id),outline:""},{default:t(()=>[qe]),_:2},1032,["onClick"])])])):m("",!0)]))),128))]),_:2},1024)])]),loading:t(()=>[a(W,{showing:"",dark:"","transition-show":"fade",color:"primary"})]),_:1},8,["grid","rows","filter","loading","pagination"]),a($,{modelValue:i.dialog,"onUpdate:modelValue":o[3]||(o[3]=e=>i.dialog=e),seamless:""},{default:t(()=>[i.dialog?(r(),p(v,{key:0,id:"dialog",flat:"",square:"",bordered:"",persistent:"",class:"bg-info text-secondary shadow-white"},{default:t(()=>[a(H,{onSubmit:J(A,["prevent"]),class:"q-pa-md"},{default:t(()=>[ve,a(K,{modelValue:i.localmap,"onUpdate:modelValue":o[1]||(o[1]=e=>i.localmap=e),rules:[T.required],type:"textarea",outlined:"",square:"",dense:""},null,8,["modelValue","rules"]),l("div",Ce,[a(n,{square:"",flat:"",type:"submit",class:"col-4 bg-secondary text-dark q-my-sm",label:"\u9001\u51FA\u7DE8\u8F2F"}),a(n,{square:"",flat:"",outline:"",class:"col-4 bg-dark text-secondary q-my-sm",label:"\u53D6\u6D88",onClick:o[2]||(o[2]=e=>i.dialog=!1)})])]),_:1},8,["onSubmit"])]),_:1})):m("",!0)]),_:1},8,["modelValue"]),a($,{modelValue:g.dialog,"onUpdate:modelValue":o[6]||(o[6]=e=>g.dialog=e),seamless:"",persistent:""},{default:t(()=>[a(v,{square:"",class:"row justify-center bg-info q-pa-lg"},{default:t(()=>[Le,Qe,l("div",Ve,[a(n,{onClick:o[4]||(o[4]=e=>E(Q._id)),square:"",flat:"",class:"col-4 bg-secondary text-dark q-my-sm",label:"\u78BA\u5B9A\u522A\u9664"}),a(n,{square:"",flat:"",outline:"",class:"col-4 bg-dark text-secondary q-my-sm",label:"\u53D6\u6D88",onClick:o[5]||(o[5]=e=>g.dialog=!1)})])]),_:1})]),_:1},8,["modelValue"])])])]),_:1}))}};export{Fe as default};
