import{p as I,s as z,a as V,D as q,b as N,o as d,c,w as e,Q as T,Z as L,S,d as o,e as t,q as r,i as l,t as h,v as _,x as A,m as i,y as u,z as D,M as y,O as E,N as P}from"./index.004b1cd7.js";import{Q as v,a as R}from"./QBreadcrumbs.bd63e0e1.js";import{Q as F}from"./QAvatar.9b3a203c.js";import{Q as w,a as M,b as O}from"./QTable.3e6c3911.js";import{Q as U}from"./QResponsive.8046e0d8.js";import{Q as Z}from"./QCard.73803a70.js";const G={id:"myheader",class:"row justify-end items-center",style:{width:"100%"}},H=i(" \u6703\u54E1\u8CC7\u6599 "),J=i(" \u9810\u7D04\u67E5\u8A62 "),K=i(" \u8A02\u55AE\u67E5\u8A62 "),W=i(" \u8CFC\u7269\u8ECA "),X=i(" \u7BA1\u7406\u5F8C\u53F0 "),Y=i(" \u8A3B\u518A "),ee=i(" \u767B\u5165 "),te=i(" \u767B\u51FA "),se={id:"mycontent",class:"col-12 row content-start"},ae=o("div",{class:"col-12 text-h3 text-secondary q-mb-md",style:{width:"100%"}},"\u8CFC\u7269\u8ECA",-1),oe={class:"col-12 q-my-md",style:{width:"100%"}},ne={class:"col-12 q-pa-md",style:{width:"100%"}},ie=["src"],de={class:"row justify-end"},le=i("-"),re={class:"row justify-start"},ce=i("+"),ue={class:"row justify-center"},fe=i("\u522A\u9664\u5546\u54C1"),_e={class:"row justify-end content-end items-end q-mt-md",style:{width:"100%"}},me=o("div",{class:"text-h4 text-accent",style:{width:"200px"}},"\u7E3D\u91D1\u984D\uFF1A",-1),he={class:"text-h4"},pe={class:"col-12 row justify-between q-my-md"},xe=i("\u7E7C\u7E8C\u8CFC\u7269"),ye=i("\u7D50\u5E33 "),we={class:"full-width row flex-center text-accent text-h5 q-gutter-sm"},ge={class:"col-12 col-sm-6 col-md-4 col-lg-3 q-pa-sm cursor-pointer"},ke=["src"],be={key:1,class:"text-left q-mx-auto"},qe={class:"row justify-between"},ve={class:"text-accent"},Ce={class:"text-secondary text-right"},Qe={key:2,class:"text-left q-mx-auto"},je={class:"row justify-between items-center"},$e={class:"text-accent"},Be={key:3,class:"text-left q-mx-auto"},Ie={class:"row justify-between items-center"},ze={class:"text-accent"},Ve=i("-"),Ne={class:"text-secondary text-right"},Te=i("+"),Le={key:4,class:"text-left q-mx-auto"},Se={class:"row justify-between"},Ae={class:"text-accent"},De=i("\u522A\u9664\u5546\u54C1"),Ge={__name:"CartView",setup(Ee){const g=I(),{logout:C}=g,{isLogin:m,isAdmin:Q}=z(g),f=V([]),j=q(()=>f.reduce((a,p)=>a+p.product.price*p.quantity,0)),x=async(a,p)=>{await g.updateCart({product:f[a].product._id,quantity:p})&&(p===0?f.splice(a,1):f[a].quantity=p)},$=q(()=>f.length>0&&!f.some(a=>!a.product.sell)),B=[{name:"image",label:"\u5546\u54C1\u5716\u7247",field:a=>a.product.image[0],required:!0,align:"center"},{name:"name",label:"\u5546\u54C1\u540D\u7A31",field:a=>a.product.name,format:a=>`${a}`,required:!0,align:"center"},{name:"inventory",label:"\u5546\u54C1\u72C0\u614B",field:a=>a.product.inventory?"\u6709\u73FE\u8CA8":"\u8A02\u8CFC\u5F8C\u88FD\u4F5C",align:"center"},{name:"price",label:"\u5546\u54C1\u55AE\u50F9",field:a=>a.product.price,align:"center"},{name:"minus",align:"right"},{name:"quantity",label:"\u8A02\u8CFC\u6578\u91CF",field:a=>a.quantity,align:"center"},{name:"add",align:"left"},{name:"sum",label:"\u91D1\u984D\u5C0F\u8A08",field:a=>a.product.price*a.quantity,align:"center"},{name:"edit",label:"\u5546\u54C1\u7DE8\u8F2F",align:"center"}];return(async()=>{try{const{data:a}=await L.get("/users/cart");f.push(...a.result)}catch{S.fire({icon:"error",title:"\u5931\u6557",text:"\u4F3A\u670D\u5668\u932F\u8AA4"})}})(),(a,p)=>{const k=N("router-link");return d(),c(T,{id:"CartView",class:"column"},{default:e(()=>[o("div",G,[t(D,{class:"text-h5 text-secondary mobile-none"},{default:e(()=>[r(m)?(d(),c(l,{key:0,round:"",dense:"",flat:"",icon:"fa-solid fa-address-card",to:"/member",class:"q-mx-xs"},{default:e(()=>[t(h,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:e(()=>[H]),_:1})]),_:1})):_("",!0),r(m)?(d(),c(l,{key:1,round:"",dense:"",flat:"",icon:"fa-regular fa-calendar-days",to:"/booking",class:"q-mx-xs"},{default:e(()=>[t(h,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:e(()=>[J]),_:1})]),_:1})):_("",!0),r(m)?(d(),c(l,{key:2,round:"",dense:"",flat:"",icon:"fa-solid fa-receipt",to:"/order",class:"q-mx-xs"},{default:e(()=>[t(h,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:e(()=>[K]),_:1})]),_:1})):_("",!0),r(m)?(d(),c(l,{key:3,round:"",dense:"",flat:"",icon:"fa-solid fa-cart-shopping",to:"/cart",class:"q-mx-xs"},{default:e(()=>[t(h,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:e(()=>[W]),_:1}),f.length>0?(d(),c(A,{key:0,floating:"",color:"red",rounded:""},{default:e(()=>[i(u(f.length),1)]),_:1})):_("",!0)]),_:1})):_("",!0),r(m)&&r(Q)?(d(),c(l,{key:4,round:"",dense:"",flat:"",icon:"fa-solid fa-user-gear",to:"/admin",class:"q-mx-xs"},{default:e(()=>[t(h,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:e(()=>[X]),_:1})]),_:1})):_("",!0),r(m)?_("",!0):(d(),c(l,{key:5,round:"",dense:"",flat:"",icon:"fa-solid fa-user-plus",to:"/register",class:"q-mx-xs"},{default:e(()=>[t(h,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:e(()=>[Y]),_:1})]),_:1})),r(m)?_("",!0):(d(),c(l,{key:6,round:"",dense:"",flat:"",icon:"fa-solid fa-right-to-bracket",to:"/login",class:"q-ml-xs q-mr-sm"},{default:e(()=>[t(h,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:e(()=>[ee]),_:1})]),_:1})),r(m)?(d(),c(l,{key:7,round:"",dense:"",flat:"",icon:"fa-solid fa-right-from-bracket",onClick:r(C),class:"q-ml-xl q-mr-md"},{default:e(()=>[t(h,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:e(()=>[te]),_:1})]),_:1},8,["onClick"])):_("",!0)]),_:1})]),o("div",se,[ae,o("div",oe,[t(R,null,{default:e(()=>[t(v,{label:"\u9996\u9801",icon:"fa-solid fa-house",to:"/"}),t(v,{label:"\u8CFC\u7269\u8ECA",icon:"fa-solid fa-store"})]),_:1})]),o("div",ne,[t(O,{grid:a.$q.screen.lt.xl,columns:B,rows:f,"row-key":"name",square:"",bordered:"","wrap-cells":"","binary-state-sort":"",dense:"",loading:a.loading,"no-data-label":"\u76EE\u524D\u6C92\u6709\u9078\u8CFC\u4EFB\u4F55\u5546\u54C1","rows-per-page-label":"\u6BCF\u9801\u986F\u793A\u7B46\u6578"},{"body-cell-image":e(s=>[t(w,{img:s,align:"center",ellipsis:""},{default:e(()=>[t(F,{square:"",size:"100px"},{default:e(()=>[o("img",{src:s.row.product.image,class:"q-mb-xl",style:{"object-fit":"cover"}},null,8,ie)]),_:2},1024)]),_:2},1032,["img"])]),"body-cell-name":e(s=>[t(w,{name:s,align:"center",ellipsis:""},{default:e(()=>[t(k,{to:{name:"product",params:{id:s.row.product._id}}},{default:e(()=>[i(u(s.row.product.name),1)]),_:2},1032,["to"])]),_:2},1032,["name"])]),"body-cell-minus":e(s=>[t(w,{minus:s},{default:e(()=>[o("div",de,[t(l,{class:"col-auto",style:{"font-size":"xx-small",padding:"0px 8px"},onClick:n=>x(s.rowIndex,s.row.quantity-1),outline:""},{default:e(()=>[le]),_:2},1032,["onClick"])])]),_:2},1032,["minus"])]),"body-cell-add":e(s=>[t(w,{add:s},{default:e(()=>[o("div",re,[t(l,{class:"col-auto",style:{"font-size":"xx-small",padding:"0px 8px"},onClick:n=>x(s.rowIndex,s.row.quantity+1),outline:""},{default:e(()=>[ce]),_:2},1032,["onClick"])])]),_:2},1032,["add"])]),"body-cell-edit":e(s=>[t(w,{edit:s},{default:e(()=>[o("div",ue,[t(l,{class:"col-auto q-mx-sm",onClick:n=>x(s.rowIndex,0),outline:""},{default:e(()=>[fe]),_:2},1032,["onClick"])])]),_:2},1032,["edit"])]),bottom:e(()=>[o("div",_e,[me,o("div",he,u(r(j)),1)]),o("div",pe,[t(l,{square:"",class:"col-5 bg-secondary text-dark text-h6",style:{width:"auto"},to:"/products"},{default:e(()=>[xe]),_:1}),t(l,{square:"",class:"col-5 bg-secondary text-dark text-h6",style:{width:"270px"},onClick:r(g).checkout,disabled:!r($)},{default:e(()=>[ye]),_:1},8,["onClick","disabled"])])]),"no-data":e(({message:s})=>[o("div",we,[o("span",null,u(s),1)])]),item:e(s=>[o("div",ge,[t(Z,{onClick:n=>a.openDialog(s.row._id,s.rowIndex),square:"",bordered:"",class:"bg-primary shadow"},{default:e(()=>[(d(!0),y(P,null,E(s.cols,n=>(d(),y("div",{key:n.name,class:"q-pa-sm"},[n.name=="image"?(d(),c(U,{key:0,ratio:3/2},{default:e(()=>[o("img",{src:s.row.product.image,class:"col",style:{width:"100%"}},null,8,ke)]),_:2},1024)):n.name!=="image"&&n.name!=="name"&&n.name!=="minus"&&n.name!=="quantity"&&n.name!=="add"&&n.name!=="edit"?(d(),y("div",be,[o("div",qe,[o("span",ve,u(n.label)+"\uFF1A",1),o("span",Ce,u(n.value),1)])])):n.name==="name"?(d(),y("div",Qe,[o("div",je,[o("span",$e,u(n.label)+"\uFF1A",1),t(k,{to:{name:"product",params:{id:s.row.product._id}},class:"text-secondary text-right"},{default:e(()=>[i(u(n.value),1)]),_:2},1032,["to"])])])):n.name==="quantity"?(d(),y("div",Be,[o("div",Ie,[o("span",ze,u(n.label)+"\uFF1A",1),t(l,{class:"col-auto text-secondary",style:{"font-size":"xx-small",padding:"0px 8px"},onClick:b=>x(s.rowIndex,s.row.quantity-1),outline:""},{default:e(()=>[Ve]),_:2},1032,["onClick"]),o("span",Ne,u(n.value),1),t(l,{class:"col-auto text-secondary",style:{"font-size":"xx-small",padding:"0px 8px"},onClick:b=>x(s.rowIndex,s.row.quantity+1),outline:""},{default:e(()=>[Te]),_:2},1032,["onClick"])])])):n.name==="edit"?(d(),y("div",Le,[o("div",Se,[o("span",Ae,u(n.label)+"\uFF1A",1),t(l,{class:"col-auto text-secondary",style:{"font-size":"xx-small",padding:"0px 8px"},onClick:b=>x(s.rowIndex,0),outline:""},{default:e(()=>[De]),_:2},1032,["onClick"])])])):_("",!0)]))),128))]),_:2},1032,["onClick"])])]),loading:e(()=>[t(M,{showing:"",dark:"","transition-show":"fade",color:"primary"})]),_:1},8,["grid","rows","loading"])])])]),_:1})}}};export{Ge as default};
