import{p as Y,s as Z,r as h,a as x,o as c,c as m,w as o,Q as G,aY as w,S as f,d as n,e as l,q as k,i as r,t as z,v as g,z as H,f as p,g as L,y as v,L as q,M as J,N as K,k as W,j as X,h as N,aZ as ee,m as u}from"./index.a83bb1c5.js";import{Q as te}from"./QAvatar.9df710dd.js";import{Q as S}from"./QTd.c418dbb1.js";import{Q as se}from"./QResponsive.d7ed6a49.js";import{Q as C}from"./QCard.d5340fbb.js";import{Q as ae,a as le}from"./QTable.53a102c5.js";import{Q as oe,a as ne,C as re}from"./ClosePopup.599e126c.js";import{Q as A}from"./QDialog.3cee5be3.js";import{u as ie}from"./use-quasar.3dca3777.js";const de={id:"myheader",class:"row justify-end items-center",style:{width:"100%"}},ce=u(" \u56DE\u524D\u53F0 "),ue=u(" \u767B\u51FA "),me={id:"mycontent",class:""},fe=n("div",{class:"row justify-between"},[n("div",{class:"col-auto text-h3 text-secondary q-my-sm q-pl-md"},"\u6703\u54E1\u7BA1\u7406")],-1),ge={class:"q-pa-md"},pe=["src"],_e={class:"row justify-center"},xe=u("\u7DE8\u8F2F\u6703\u54E1 "),ye=u("\u522A\u9664\u6703\u54E1"),be={class:"full-width row flex-center text-accent q-gutter-sm"},he={class:"col-12 col-sm-6 col-md-4 col-lg-3 q-pa-sm cursor-pointer"},we=["src"],ke={key:1,class:"text-left q-mx-auto"},ve={class:"row justify-between"},qe={class:"text-accent"},Ve={class:"text-secondary text-right"},Ce={key:2,class:"text-left q-mx-auto"},Qe={class:"row justify-between"},Pe={class:"text-accent"},je=u("\u7DE8\u8F2F\u6703\u54E1"),Ue={class:"row justify-end q-mt-sm"},De=u("\u522A\u9664\u6703\u54E1"),$e=n("p",{class:"text-h6 text-dark"},"\u6703\u54E1\u540D\u7A31",-1),ze={class:"row col-6"},Le=n("div",{class:"col-12 text-h6 text-dark"},"\u6703\u54E1\u6027\u5225",-1),Ne={class:"col-12 row content-center q-my-sm",style:{height:"40px"}},Se={class:"col-6 q-mr-xs"},Ae=n("p",{class:"text-h6 text-dark"},"\u6703\u54E1\u751F\u65E5",-1),Be={class:"row items-center justify-end"},Fe=n("p",{class:"text-h6 text-dark"},"\u6703\u54E1\u624B\u6A5F",-1),Ie=n("p",{class:"text-h6 text-dark"},"\u6703\u54E1\u4FE1\u7BB1",-1),Me=n("p",{class:"text-h6 text-dark"},"\u6703\u54E1\u4F4F\u5740",-1),Te={class:"row justify-around"},Ee=n("div",{class:"col-12 text-center text-h3 text-red q-pb-md"},"\u8B66\u544A",-1),Re=n("div",{class:"col-12 text-center text-h6 text-dark q-pb-md"},[u("\u4F60\u78BA\u5B9A\u8981\u522A\u9664\u6703\u54E1\u55CE\uFF1F"),n("br"),u("\u522A\u9664\u6703\u54E1\u5C07\u7121\u6CD5\u5FA9\u539F\uFF01")],-1),Oe={class:"col-12 row justify-around"},st={__name:"AdminMemberView",setup(Ye){const Q=Y(),{logout:B}=Q,{isLogin:P}=Z(Q),j=(a,t)=>"https://joeschmoe.io/api/v1//"+a+"/"+t;h(!0);const V=h(""),F=ie(),I=h(!1),d=x([]),M=x({items:[],page:1,rowsPerPage:20}),s=x({_id:"",name:"",gender:1,birthday:"",email:"",tel:"",address:"",idx:-1,dialog:!1}),y=x({required(a){return!!a||"\u5FC5\u586B\u6B04\u4F4D"},price(a){return a>-1||"\u50F9\u683C\u5FC5\u9808\u5927\u65BC\u6216\u7B49\u65BC 0"},date(a){return t=>/^-?[\d]+\/[0-1]\d\/[0-3]\d$/.test(t)},size(a){var t,e,i;return!a||!a.length||((e=(t=a[0])==null?void 0:t.type)==null?void 0:e.includes("image"))&&((i=a[0])==null?void 0:i.size)<=1024*1024*2||"\u6A94\u6848\u683C\u5F0F\u4E0D\u7B26\uFF08\u9808\u70BA\u5716\u7247\u6A94\uFF0C\u4E14\u6A94\u6848\u5927\u5C0F 2 MB \u4EE5\u4E0B\uFF09"}}),T=async()=>{try{if(s._id.length===0){const{data:a}=await w.post("/users",s);d.push(a.result),f.fire({icon:"success",title:"\u65B0\u589E\u6210\u529F",text:"\u60A8\u5DF2\u6210\u529F\u65B0\u589E\u4E00\u540D\u6703\u54E1\uFF01"}),b()}else{const{data:a}=await w.patch("/users/"+s._id,s);d[s.idx]=a.result,f.fire({icon:"success",title:"\u4FEE\u6539\u6210\u529F",text:"\u60A8\u5DF2\u6210\u529F\u4FEE\u6539\u8A72\u540D\u6703\u54E1\uFF01"})}s.dialog=!1,b()}catch(a){f.fire({icon:"error",title:"\u65B0\u589E\u5931\u6557",text:a.isAxiosError?a.response.data.message:a.message})}},_=x({dialog:!1}),U=h(""),D=a=>{U.value=a,_.dialog=!0},E=async a=>{_.dialog=!1;try{await w.delete("/users/"+a),await f.fire({icon:"success",title:"\u522A\u9664\u6210\u529F",text:"\u60A8\u5DF2\u6210\u529F\u522A\u9664\u8A72\u540D\u6703\u54E1\uFF01"}),b()}catch(t){f.fire({icon:"error",title:"\u522A\u9664\u5931\u6557",text:t.isAxiosError?t.response.data.message:t.message})}},$=(a,t)=>{s._id=a,t>-1?(s.name=d[t].name,s.gender=d[t].gender,s.birthday=d[t].birthday,s.email=d[t].email,s.tel=d[t].tel,s.address=d[t].address):(s.name="",s.gender="",s.birthday="",s.email="",s.tel="",s.address=""),s.image=[],s.idx=t,s.dialog=!0},R=[{name:"image",label:"\u6703\u54E1\u7167\u7247",align:"center"},{name:"account",label:"\u6703\u54E1\u5E33\u865F",align:"center",field:a=>a.account},{name:"role",label:"\u6703\u54E1\u8EAB\u4EFD",align:"center",field:a=>a.role===1?"\u7BA1\u7406\u8005":"\u4E00\u822C\u6703\u54E1"},{name:"name",label:"\u6703\u54E1\u59D3\u540D",align:"center",field:a=>a.name},{name:"tel",label:"\u6703\u54E1\u624B\u6A5F",align:"center",field:a=>a.tel},{name:"email",label:"\u6703\u54E1\u4FE1\u7BB1",align:"center",field:a=>a.email},{name:"control",label:"\u6703\u54E1\u7BA1\u7406",align:"center"}],b=async()=>{try{const{data:a}=await w.get("/users/all");d.splice(0,d.length),d.push(...a.result)}catch(a){f.fire({icon:"error",title:"\u5931\u6557",text:a.isAxiosError?a.response.data.message:a.message})}};return b(),(a,t)=>(c(),m(G,{class:"column"},{default:o(()=>[n("div",de,[l(H,{class:"text-h5 text-secondary mobile-none"},{default:o(()=>[k(P)?(c(),m(r,{key:0,round:"",dense:"",flat:"",icon:"fa-solid fa-house",to:"/",class:"q-mx-xs"},{default:o(()=>[l(z,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:o(()=>[ce]),_:1})]),_:1})):g("",!0),k(P)?(c(),m(r,{key:1,round:"",dense:"",flat:"",icon:"fa-solid fa-right-from-bracket",onClick:k(B),class:"q-ml-xl q-mr-lg"},{default:o(()=>[l(z,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:o(()=>[ue]),_:1})]),_:1},8,["onClick"])):g("",!0)]),_:1})]),n("div",me,[fe,n("div",ge,[l(le,{grid:k(F).screen.lt.xl,columns:R,rows:d,"row-key":"name",square:"",bordered:"","wrap-cells":"","binary-state-sort":"",dense:"",filter:V.value,loading:I.value,pagination:M,"rows-per-page-label":"\u6BCF\u9801\u986F\u793A\u7B46\u6578","no-data-label":"\u76EE\u524D\u6C92\u6709\u65B0\u589E\u4EFB\u4F55\u6703\u54E1","no-results-label":"Oops...\u627E\u4E0D\u5230\u8A72\u6703\u54E1"},{"body-cell-image":o(e=>[l(S,{img:e,align:"center",ellipsis:""},{default:o(()=>[l(te,{square:"",size:"100px"},{default:o(()=>[n("img",{src:j(e.row.gender===1?"male":"female",e.row.account),class:"q-mb-xl",style:{"object-fit":"cover"}},null,8,pe)]),_:2},1024)]),_:2},1032,["img"])]),"top-right":o(()=>[l(p,{borderless:"",dense:"",debounce:"300",modelValue:V.value,"onUpdate:modelValue":t[0]||(t[0]=e=>V.value=e),placeholder:"\xA0Search",class:"search"},{append:o(()=>[l(L,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-control":o(e=>[l(S,{control:e},{default:o(()=>[n("div",_e,[l(r,{class:"col-auto q-mx-sm",onClick:i=>$(e.row._id,e.rowIndex),outline:""},{default:o(()=>[xe]),_:2},1032,["onClick"]),l(r,{class:"col-auto q-mx-sm",onClick:i=>D(e.row._id),outline:""},{default:o(()=>[ye]),_:2},1032,["onClick"])])]),_:2},1032,["control"])]),pagination:o(e=>[e.pagesNumber>1?(c(),m(r,{key:0,icon:"first_page",color:"secondary",round:"",dense:"",flat:"",disable:e.isFirstPage,onClick:e.firstPage},null,8,["disable","onClick"])):g("",!0),l(r,{icon:"chevron_left",color:"secondary",round:"",dense:"",flat:"",disable:e.isFirstPage,onClick:e.prevPage},null,8,["disable","onClick"]),l(r,{icon:"chevron_right",color:"secondary",round:"",dense:"",flat:"",disable:e.isLastPage,onClick:e.nextPage},null,8,["disable","onClick"]),e.pagesNumber>1?(c(),m(r,{key:1,icon:"last_page",color:"secondary",round:"",dense:"",flat:"",disable:e.isLastPage,onClick:e.lastPage},null,8,["disable","onClick"])):g("",!0)]),"no-data":o(({message:e})=>[n("div",be,[n("span",null,v(e),1)])]),item:o(e=>[n("div",he,[l(C,{square:"",bordered:"",class:"bg-primary shadow"},{default:o(()=>[(c(!0),q(K,null,J(e.cols,i=>(c(),q("div",{key:i.name,class:"q-pa-sm"},[i.name=="image"?(c(),m(se,{key:0,ratio:1/1},{default:o(()=>[n("img",{src:j(e.row.gender===1?"male":"female",e.row.account),class:"q-mb-xl",style:{"object-fit":"cover"}},null,8,we)]),_:2},1024)):i.name!=="image"&&i.name!=="control"?(c(),q("div",ke,[n("div",ve,[n("span",qe,v(i.label)+"\uFF1A",1),n("span",Ve,v(i.value),1)])])):i.name==="control"?(c(),q("div",Ce,[n("div",Qe,[n("span",Pe,v(i.label)+"\uFF1A",1),l(r,{class:"col-auto text-secondary",style:{"font-size":"xx-small",padding:"0px 8px"},onClick:O=>$(e.row._id,e.rowIndex),outline:""},{default:o(()=>[je]),_:2},1032,["onClick"])]),n("div",Ue,[l(r,{class:"col-auto text-secondary",style:{"font-size":"xx-small",padding:"0px 8px"},onClick:O=>D(e.row._id),outline:""},{default:o(()=>[De]),_:2},1032,["onClick"])])])):g("",!0)]))),128))]),_:2},1024)])]),loading:o(()=>[l(ae,{showing:"",dark:"","transition-show":"fade",color:"primary"})]),_:1},8,["grid","rows","filter","loading","pagination"])]),l(A,{modelValue:s.dialog,"onUpdate:modelValue":t[10]||(t[10]=e=>s.dialog=e),seamless:""},{default:o(()=>[s.dialog?(c(),m(C,{key:0,id:"dialog",flat:"",square:"",bordered:"",persistent:"",class:"bg-info text-secondary shadow-white"},{default:o(()=>[l(W,{onSubmit:X(T,["prevent"]),class:"q-pa-md"},{default:o(()=>[$e,l(p,{modelValue:s.name,"onUpdate:modelValue":t[1]||(t[1]=e=>s.name=e),rules:[y.required],type:"text",outlined:"",square:"",dense:""},null,8,["modelValue","rules"]),n("div",ze,[Le,n("div",Ne,[l(N,{dense:"",size:"xs",modelValue:s.gender,"onUpdate:modelValue":t[2]||(t[2]=e=>s.gender=e),val:1,label:"\u5148\u751F",class:"text-dark q-mr-xl"},null,8,["modelValue"]),l(N,{dense:"",size:"xs",modelValue:s.gender,"onUpdate:modelValue":t[3]||(t[3]=e=>s.gender=e),val:2,label:"\u5C0F\u59D0",class:"text-dark q-ml-xl"},null,8,["modelValue"])])]),n("div",Se,[Ae,l(p,{filled:"",modelValue:s.birthday,"onUpdate:modelValue":t[5]||(t[5]=e=>s.birthday=e),dense:"",mask:"date",rules:[y.date]},{append:o(()=>[l(L,{name:"event",class:"cursor-pointer"},{default:o(()=>[l(oe,{ref:"qDateProxy","transition-show":"scale","transition-hide":"scale"},{default:o(()=>[l(ne,{modelValue:s.birthday,"onUpdate:modelValue":t[4]||(t[4]=e=>s.birthday=e),title:s.name,subtitle:"\u8ACB\u9078\u64C7\u751F\u65E5",class:"bg-info"},{default:o(()=>[n("div",Be,[ee(l(r,{label:"\u95DC\u9589",color:"primary",flat:""},null,512),[[re]])])]),_:1},8,["modelValue","title"])]),_:1},512)]),_:1})]),_:1},8,["modelValue","rules"])]),Fe,l(p,{modelValue:s.tel,"onUpdate:modelValue":t[6]||(t[6]=e=>s.tel=e),rules:[y.required],mask:"####-###-###",outlined:"",square:"",dense:"",class:"text-primary"},null,8,["modelValue","rules"]),Ie,l(p,{modelValue:s.email,"onUpdate:modelValue":t[7]||(t[7]=e=>s.email=e),rules:[y.required],outlined:"",square:"",dense:"",class:"text-primary"},null,8,["modelValue","rules"]),Me,l(p,{modelValue:s.address,"onUpdate:modelValue":t[8]||(t[8]=e=>s.address=e),outlined:"",square:"",dense:"",class:"text-primary"},null,8,["modelValue"]),n("div",Te,[l(r,{square:"",flat:"",type:"submit",class:"col-4 bg-secondary text-dark q-my-sm",label:"\u9001\u51FA\u7DE8\u8F2F"}),l(r,{square:"",flat:"",outline:"",class:"col-4 bg-dark text-secondary q-my-sm",label:"\u53D6\u6D88",onClick:t[9]||(t[9]=e=>s.dialog=!1)})])]),_:1},8,["onSubmit"])]),_:1})):g("",!0)]),_:1},8,["modelValue"]),l(A,{modelValue:_.dialog,"onUpdate:modelValue":t[13]||(t[13]=e=>_.dialog=e),seamless:"",persistent:""},{default:o(()=>[l(C,{square:"",class:"row justify-center bg-info q-pa-lg"},{default:o(()=>[Ee,Re,n("div",Oe,[l(r,{onClick:t[11]||(t[11]=e=>E(U.value)),square:"",flat:"",class:"col-4 bg-secondary text-dark q-my-sm",label:"\u78BA\u5B9A\u522A\u9664\u6703\u54E1"}),l(r,{square:"",flat:"",outline:"",class:"col-4 bg-dark text-secondary q-my-sm",label:"\u53D6\u6D88",onClick:t[12]||(t[12]=e=>_.dialog=!1)})])]),_:1})]),_:1},8,["modelValue"])])]),_:1}))}};export{st as default};
