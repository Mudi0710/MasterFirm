import{p as H,s as J,r as D,a as _,o as c,c as p,w as i,Q as K,aY as V,S as b,d as l,e as o,q as m,i as r,t as U,v as g,z as W,f as P,g as S,m as u,y as f,L as k,M as X,N as Z,k as ee,j as z,bh as L}from"./index.30e3aca3.js";import{Q as te}from"./QAvatar.38559441.js";import{Q as j}from"./QTd.8bc68e44.js";import{Q as se}from"./QResponsive.c687ef6b.js";import{Q as N}from"./QCard.3f6bf113.js";import{Q as ae,a as oe}from"./QTable.cdd246b6.js";import{a as le,Q as ie}from"./QEditor.9b13f764.js";import{Q as E}from"./QDialog.789283ce.js";import{u as ne}from"./use-quasar.f527aa89.js";const re={id:"myheader",class:"row justify-end items-center",style:{width:"100%"}},de=u(" \u56DE\u524D\u53F0 "),ce=u(" \u767B\u51FA "),ue={id:"mycontent"},me={class:"row justify-between"},fe=l("div",{class:"col-auto text-h3 text-secondary q-my-sm q-pl-md"},"\u5546\u54C1\u7BA1\u7406",-1),pe=u("\u65B0\u589E\u5546\u54C1"),ge={class:"q-pa-md"},_e=["src"],be={class:"row justify-center"},xe=u("\u4FEE\u6539\u5546\u54C1 "),ye=u(" \u522A\u9664\u5546\u54C1 "),he={class:"full-width row flex-center text-accent q-gutter-sm"},ke={class:"col-12 col-sm-6 col-md-4 col-lg-3 q-pa-sm cursor-pointer"},we=["src"],ve={key:1,class:"text-left q-mx-auto"},qe={class:"row justify-between"},Ve={class:"text-accent"},Ce={class:"text-secondary text-right"},Qe={key:2,class:"text-left q-mx-auto"},De={class:"row justify-between"},Pe={class:"text-accent"},Se={class:"text-secondary text-right"},ze={key:3,class:"text-left q-mx-auto"},je={class:"row justify-between"},Ne={class:"text-accent"},Te=u("\u4FEE\u6539\u5546\u54C1"),$e={class:"row justify-end q-mt-sm",style:{height:"28.8px"}},Ie=u("\u522A\u9664\u5546\u54C1"),Ue=l("p",{class:"text-h6 text-dark"},"\u5546\u54C1\u540D\u7A31",-1),Le=l("p",{class:"text-h6 text-dark"},"\u5546\u54C1\u63CF\u8FF0",-1),Ee={class:"row q-mb-sm"},Fe={class:"column col-6"},Ae=l("div",{class:"col-6 text-h6 text-dark"},"\u5EAB\u5B58\u72C0\u614B",-1),Be={class:"column col-6"},Me=l("div",{class:"col-6 text-h6 text-dark"},"\u4E0A\u67B6\u72C0\u614B",-1),Re=l("p",{class:"text-h6 text-dark"},"\u5546\u54C1\u50F9\u683C",-1),Oe=l("p",{class:"text-h6 text-dark"},"\u5546\u54C1\u5716\u7247",-1),Ge={class:"row justify-around"},Ye=l("div",{class:"col-12 text-center text-h3 text-red q-pb-md"},"\u8B66\u544A",-1),He={class:"col-12 text-center text-h6 text-dark q-pb-md"},Je=u("\u4F60\u78BA\u5B9A\u8981\u522A\u9664"),Ke=l("br",null,null,-1),We=l("br",null,null,-1),Xe=u("\u522A\u9664\u5C07\u7121\u6CD5\u5FA9\u539F\uFF01"),Ze={class:"col-12 row justify-around"},ct={__name:"AdminProductView",setup(et){const T=H(),{logout:F}=T,{isLogin:$}=J(T),C=D(""),x=ne(),A=D(!1),d=_([]),B=_({items:[],page:1,rowsPerPage:5}),a=_({_id:"",name:"",description:"",inventory:!1,sell:!1,price:0,image:[],idx:-1,dialog:!1}),w=D(null),M=s=>{if(s.target.nodeName==="INPUT")return;let e,t;s.preventDefault(),s.stopPropagation(),s.originalEvent&&s.originalEvent.clipboardData.getData?(e=s.originalEvent.clipboardData.getData("text/plain"),w.value.runCmd("insertText",e)):s.clipboardData&&s.clipboardData.getData?(e=s.clipboardData.getData("text/plain"),w.value.runCmd("insertText",e)):window.clipboardData&&window.clipboardData.getData&&(t||(t=!0,w.value.runCmd("ms-pasteTextOnly",e)),t=!1)},y=_({required(s){return!!s||"\u5FC5\u586B\u6B04\u4F4D"},price(s){return s>-1||"\u50F9\u683C\u5FC5\u9808\u5927\u65BC\u6216\u7B49\u65BC 0"},size(s){var e,t,n;return!s||!s.length||((t=(e=s[0])==null?void 0:e.type)==null?void 0:t.includes("image"))&&((n=s[0])==null?void 0:n.size)<=1024*1024*2||"\u6A94\u6848\u683C\u5F0F\u4E0D\u7B26\uFF08\u9808\u70BA\u5716\u7247\u6A94\uFF0C\u4E14\u6A94\u6848\u5927\u5C0F 2 MB \u4EE5\u4E0B\uFF09"}}),R=async()=>{const s=new FormData;for(const e in a)if(!["_id","idx","dialog"].includes(e))if(e==="image")for(const t of a.image)s.append(e,t);else s.append(e,a[e]);try{if(a._id.length===0){const{data:e}=await V.post("/products",s);d.push(e.result),b.fire({icon:"success",title:"\u65B0\u589E\u6210\u529F",text:"\u60A8\u5DF2\u6210\u529F\u65B0\u589E\u4E00\u7B46\u5546\u54C1\uFF01"}),q()}else{const{data:e}=await V.patch("/products/"+a._id,s);d[a.idx]=e.result,b.fire({icon:"success",title:"\u4FEE\u6539\u6210\u529F",text:"\u60A8\u5DF2\u6210\u529F\u4FEE\u6539\u8A72\u7B46\u5546\u54C1\uFF01"}),q()}a.dialog=!1}catch(e){b.fire({icon:"error",title:"\u65B0\u589E\u5931\u6557",text:e.isAxiosError?e.response.data.message:e.message})}},h=_({dialog:!1}),v=_({_id:"",name:""}),I=(s,e)=>{v._id=s,v.name=e,h.dialog=!0},O=async s=>{h.dialog=!1;try{await V.delete("/products/"+s),await b.fire({icon:"success",title:"\u522A\u9664\u6210\u529F",text:"\u60A8\u5DF2\u6210\u529F\u522A\u9664\u8A72\u7B46\u5546\u54C1\uFF01"}),q()}catch(e){b.fire({icon:"error",title:"\u522A\u9664\u5931\u6557",text:e.isAxiosError?e.response.data.message:e.message})}},Q=(s,e)=>{a._id=s,e>-1?(a.name=d[e].name,a.description=d[e].description,a.inventory=d[e].inventory,a.sell=d[e].sell,a.price=d[e].price):(a.name="",a.description="",a.inventory=!1,a.sell=!1,a.price=0),a.image=[],a.idx=e,a.dialog=!0},G=[{name:"image",label:"\u5546\u54C1\u5716\u7247",align:"center",field:s=>s.image[0]},{name:"name",label:"\u5546\u54C1\u540D\u7A31",field:s=>s.name,format:s=>`${s}`,required:!0,align:"center",sortable:!0},{name:"inventory",label:"\u5EAB\u5B58\u72C0\u614B",field:s=>s.inventory?"\u6709\u73FE\u8CA8":"\u9700\u9810\u8A02",align:"center",sortable:!0},{name:"sell",label:"\u4E0A\u67B6\u72C0\u614B",field:s=>s.sell?"\u4E0A\u67B6":"\u4E0B\u67B6",align:"center",sortable:!0},{name:"price",label:"\u5546\u54C1\u50F9\u683C",field:s=>s.price,align:"center",sortable:!0},{name:"edit",label:"\u5546\u54C1\u7DE8\u8F2F",align:"center"}],q=async()=>{try{const{data:s}=await V.get("/products/all");d.splice(0,d.length),d.push(...s.result),d.reverse()}catch(s){b.fire({icon:"error",title:"\u5931\u6557",text:s.isAxiosError?s.response.data.message:s.message})}};return q(),(s,e)=>(c(),p(K,{class:"column"},{default:i(()=>[l("div",re,[o(W,{class:"text-h5 text-secondary mobile-none"},{default:i(()=>[m($)?(c(),p(r,{key:0,round:"",dense:"",flat:"",icon:"fa-solid fa-house",to:"/",class:"q-mx-xs"},{default:i(()=>[o(U,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:i(()=>[de]),_:1})]),_:1})):g("",!0),m($)?(c(),p(r,{key:1,round:"",dense:"",flat:"",icon:"fa-solid fa-right-from-bracket",onClick:m(F),class:"q-ml-xl q-mr-lg"},{default:i(()=>[o(U,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:i(()=>[ce]),_:1})]),_:1},8,["onClick"])):g("",!0)]),_:1})]),l("div",ue,[l("div",me,[fe,o(r,{onClick:e[0]||(e[0]=t=>Q("",-1)),square:"",flat:"",class:"col-auto q-mr-xl bg-secondary text-dark text-h6 q-my-sm createBtn"},{default:i(()=>[pe]),_:1})]),l("div",ge,[o(oe,{grid:m(x).screen.lt.xl,columns:G,rows:d,"row-key":"name",square:"",bordered:"","wrap-cells":"","binary-state-sort":"",dense:"",filter:C.value,loading:A.value,pagination:B,"rows-per-page-label":"\u6BCF\u9801\u986F\u793A\u7B46\u6578","no-data-label":"\u76EE\u524D\u6C92\u6709\u65B0\u589E\u4EFB\u4F55\u5546\u54C1","no-results-label":"Oops...\u627E\u4E0D\u5230\u8A72\u7B46\u5546\u54C1"},{"top-right":i(()=>[o(P,{borderless:"",dense:"",debounce:"300",modelValue:C.value,"onUpdate:modelValue":e[1]||(e[1]=t=>C.value=t),placeholder:"\xA0Search",class:"search"},{append:i(()=>[o(S,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-image":i(t=>[o(j,{img:t,align:"center",ellipsis:""},{default:i(()=>[o(te,{square:"",size:"100px"},{default:i(()=>[l("img",{src:t.row.image[0],class:"q-mb-xl",style:{"object-fit":"cover"}},null,8,_e)]),_:2},1024)]),_:2},1032,["img"])]),"body-cell-price":i(t=>[o(j,{img:t,align:"center"},{default:i(()=>[u(" NT$ "+f(t.row.price.toLocaleString()),1)]),_:2},1032,["img"])]),"body-cell-edit":i(t=>[o(j,{edit:t},{default:i(()=>[l("div",be,[o(r,{class:"col-auto q-mx-sm q-my-xs",onClick:n=>Q(t.row._id,t.rowIndex),outline:""},{default:i(()=>[xe]),_:2},1032,["onClick"]),o(r,{class:"col-auto q-mx-sm q-my-xs",onClick:n=>I(t.row._id,t.row.name),outline:""},{default:i(()=>[ye]),_:2},1032,["onClick"])])]),_:2},1032,["edit"])]),pagination:i(t=>[t.pagesNumber>1?(c(),p(r,{key:0,icon:"first_page",color:"secondary",round:"",dense:"",flat:"",disable:t.isFirstPage,onClick:t.firstPage},null,8,["disable","onClick"])):g("",!0),o(r,{icon:"chevron_left",color:"secondary",round:"",dense:"",flat:"",disable:t.isFirstPage,onClick:t.prevPage},null,8,["disable","onClick"]),o(r,{icon:"chevron_right",color:"secondary",round:"",dense:"",flat:"",disable:t.isLastPage,onClick:t.nextPage},null,8,["disable","onClick"]),t.pagesNumber>1?(c(),p(r,{key:1,icon:"last_page",color:"secondary",round:"",dense:"",flat:"",disable:t.isLastPage,onClick:t.lastPage},null,8,["disable","onClick"])):g("",!0)]),"no-data":i(({message:t})=>[l("div",he,[l("span",null,f(t),1)])]),item:i(t=>[l("div",ke,[o(N,{square:"",bordered:"",class:"bg-primary shadow"},{default:i(()=>[(c(!0),k(Z,null,X(t.cols,n=>(c(),k("div",{key:n.name,class:"q-pa-sm"},[n.name=="image"?(c(),p(se,{key:0,ratio:3/2},{default:i(()=>[l("img",{src:t.row[n.name][0],class:"col",style:{width:"100%","object-fit":"cover"}},null,8,we)]),_:2},1024)):g("",!0),n.name==="price"?(c(),k("div",ve,[l("div",qe,[l("span",Ve,f(n.label)+"\uFF1A",1),l("span",Ce,"NT$ "+f(n.value.toLocaleString()),1)])])):n.name!=="image"&&n.name!=="price"&&n.name!=="edit"?(c(),k("div",Qe,[l("div",De,[l("span",Pe,f(n.label)+"\uFF1A",1),l("span",Se,f(n.value),1)])])):n.name==="edit"?(c(),k("div",ze,[l("div",je,[l("span",Ne,f(n.label)+"\uFF1A",1),o(r,{class:"col-auto text-secondary",style:{"font-size":"small",padding:"0px 8px"},onClick:Y=>Q(t.row._id,t.rowIndex),outline:""},{default:i(()=>[Te]),_:2},1032,["onClick"])]),l("div",$e,[o(r,{class:"col-auto text-secondary",style:{"font-size":"small",padding:"0px 8px"},onClick:Y=>I(t.row._id,t.row.name),outline:""},{default:i(()=>[Ie]),_:2},1032,["onClick"])])])):g("",!0)]))),128))]),_:2},1024)])]),loading:i(()=>[o(ae,{showing:"",dark:"","transition-show":"fade",color:"primary"})]),_:1},8,["grid","rows","filter","loading","pagination"])]),o(E,{modelValue:a.dialog,"onUpdate:modelValue":e[11]||(e[11]=t=>a.dialog=t),seamless:""},{default:i(()=>[a.dialog?(c(),p(N,{key:0,id:"dialog",flat:"",square:"",bordered:"",persistent:"",class:"bg-info text-secondary shadow-white"},{default:i(()=>[o(ee,{onSubmit:z(R,["prevent"]),class:"q-pa-md"},{default:i(()=>[Ue,o(P,{modelValue:a.name,"onUpdate:modelValue":e[2]||(e[2]=t=>a.name=t),rules:[y.required],type:"text",outlined:"",square:"",dense:""},null,8,["modelValue","rules"]),Le,o(le,{model:"qeditor",modelValue:a.description,"onUpdate:modelValue":e[3]||(e[3]=t=>a.description=t),ref_key:"editorRef",ref:w,onPaste:M,rules:[y.required],outlined:"",square:"","content-class":"bg-dark","toolbar-bg":"secondary","toolbar-text-color":"dark",dense:m(x).screen.lt.lg,toolbar:[["bold","italic","strike","underline","subscript","superscript"],["left","center","right","justify"],["token","hr","link","custom_btn"],["print","fullscreen"],[{icon:m(x).iconSet.editor.formatting,fixedIcon:!1,list:"no-icons",options:["p","h1","h2","h3","h4","h5","h6","code"]},{icon:m(x).iconSet.editor.fontSize,fixedIcon:!1,list:"no-icons",options:["size-1","size-2","size-3","size-4","size-5","size-6","size-7"]},{icon:m(x).iconSet.editor.font,fixedIcon:!0,list:"no-icons",options:["default_font","arial","arial_black","comic_sans","courier_new","impact","lucida_grande","times_new_roman","verdana"]},"removeFormat"],["quote","unordered","ordered","outdent","indent"],["undo","redo"],["viewsource"]],fonts:{arial:"Arial",arial_black:"Arial Black",comic_sans:"Comic Sans MS",courier_new:"Courier New",impact:"Impact",lucida_grande:"Lucida Grande",times_new_roman:"Times New Roman",verdana:"Verdana"}},null,8,["modelValue","rules","dense","toolbar"]),l("div",Ee,[l("div",Fe,[Ae,o(L,{class:"col-6 text-dark",modelValue:a.inventory,"onUpdate:modelValue":e[4]||(e[4]=t=>a.inventory=t),label:a.inventory?"\u6709\u73FE\u8CA8":"\u6C92\u73FE\u8CA8"},null,8,["modelValue","label"])]),l("div",Be,[Me,o(L,{class:"col-6 text-dark",modelValue:a.sell,"onUpdate:modelValue":e[5]||(e[5]=t=>a.sell=t),label:a.sell?"\u4E0A\u67B6":"\u4E0B\u67B6"},null,8,["modelValue","label"])])]),Re,o(P,{modelValue:a.price,"onUpdate:modelValue":e[6]||(e[6]=t=>a.price=t),modelModifiers:{number:!0},min:"0",rules:[y.required,y.price],outlined:"",square:"",dense:"",class:"text-primary"},null,8,["modelValue","rules"]),Oe,o(ie,{modelValue:a.image,"onUpdate:modelValue":e[9]||(e[9]=t=>a.image=t),multiple:"",rules:[y.size],accept:"image/*",filled:"","bottom-slots":"",counter:""},{prepend:i(()=>[o(S,{name:"cloud_upload",onClick:e[7]||(e[7]=z(()=>{},["stop","prevent"]))})]),append:i(()=>[o(S,{name:"close",onClick:e[8]||(e[8]=z(t=>s.model=null,["stop","prevent"])),class:"cursor-pointer"})]),hint:i(()=>[]),_:1},8,["modelValue","rules"]),l("div",Ge,[o(r,{square:"",flat:"",type:"submit",class:"col-4 bg-secondary text-dark q-my-sm",label:"\u9001\u51FA\u7DE8\u8F2F"}),o(r,{square:"",flat:"",outline:"",class:"col-4 bg-dark text-secondary q-my-sm",label:"\u53D6\u6D88",onClick:e[10]||(e[10]=t=>a.dialog=!1)})])]),_:1},8,["onSubmit"])]),_:1})):g("",!0)]),_:1},8,["modelValue"]),o(E,{modelValue:h.dialog,"onUpdate:modelValue":e[14]||(e[14]=t=>h.dialog=t),seamless:"",persistent:""},{default:i(()=>[o(N,{square:"",class:"row justify-center bg-info q-pa-lg"},{default:i(()=>[Ye,l("div",He,[Je,Ke,u("\u3010"+f(v.name)+"\u3011\u55CE\uFF1F",1),We,Xe]),l("div",Ze,[o(r,{onClick:e[12]||(e[12]=t=>O(v._id)),square:"",flat:"",class:"col-4 bg-secondary text-dark q-my-sm",label:"\u522A\u9664"}),o(r,{square:"",flat:"",outline:"",class:"col-4 bg-dark text-secondary q-my-sm",label:"\u53D6\u6D88",onClick:e[13]||(e[13]=t=>h.dialog=!1)})])]),_:1})]),_:1},8,["modelValue"])])]),_:1}))}};export{ct as default};
