import{p as O,s as Y,r as b,a as _,o as d,c as m,w as o,Q as G,aY as z,S as q,d as n,e as l,q as x,i,t as B,v as f,z as H,f as v,g as V,y as k,L as h,M as J,N as K,k as W,j as C,b6 as L,m as c}from"./index.a1ab890b.js";import{Q as X}from"./QAvatar.2a28bbbd.js";import{Q as N}from"./QTd.bef30cc1.js";import{Q as Z}from"./QResponsive.3929e776.js";import{Q}from"./QCard.f1a48712.js";import{Q as ee,a as te,b as S}from"./QTable.e327fcef.js";import{Q as se}from"./QFile.08f27fd5.js";import{u as le}from"./use-quasar.5a327ee0.js";const oe={id:"myheader",class:"row justify-end items-center",style:{width:"100%"}},ae=c(" \u56DE\u524D\u53F0 "),ne=c(" \u767B\u51FA "),ie={id:"mycontent",class:""},re={class:"row justify-between"},de=n("div",{class:"col-auto text-h3 text-secondary q-my-sm"},"\u6703\u54E1\u7BA1\u7406",-1),ce=c("\u65B0\u589E\u6703\u54E1"),ue={class:"q-pa-md"},me=["src"],fe={class:"row justify-center"},pe=c("\u6703\u54E1\u8A73\u60C5"),ge=c("\u7DE8\u8F2F\u6703\u54E1"),_e=c("\u522A\u9664\u6703\u54E1"),ye={class:"full-width row flex-center text-accent q-gutter-sm"},be={class:"col-12 col-sm-6 col-md-4 col-lg-3 q-pa-sm cursor-pointer"},xe=["src"],ve={key:1,class:"text-left q-mx-auto"},ke={class:"row justify-between"},he={class:"text-accent"},we={class:"text-secondary text-right"},qe={key:2,class:"text-left q-mx-auto"},Ve={class:"row justify-between"},Ce={class:"text-accent"},Qe=c("\u7DE8\u8F2F\u6703\u54E1"),je={class:"row justify-end q-mt-sm"},Pe=c("\u522A\u9664\u6703\u54E1"),$e=n("p",{class:"text-h6 text-dark"},"\u5546\u54C1\u540D\u7A31",-1),Ue=n("p",{class:"text-h6 text-dark"},"\u5546\u54C1\u63CF\u8FF0",-1),ze={class:"row q-mb-sm"},Be={class:"column col-6"},Le=n("div",{class:"col-6 text-h6 text-dark"},"\u5EAB\u5B58\u72C0\u614B",-1),Ne={class:"column col-6"},Se=n("div",{class:"col-6 text-h6 text-dark"},"\u4E0A\u67B6\u72C0\u614B",-1),De=n("p",{class:"text-h6 text-dark"},"\u5546\u54C1\u50F9\u683C",-1),Fe=n("p",{class:"text-h6 text-dark"},"\u5546\u54C1\u5716\u7247",-1),Ie={class:"row justify-around"},Te=n("div",{class:"col-12 text-center text-h3 text-red q-pb-md"},"\u8B66\u544A",-1),Ae=n("div",{class:"col-12 text-center text-h6 text-dark q-pb-md"},[c("\u4F60\u78BA\u5B9A\u8981\u522A\u9664\u5546\u54C1\u55CE\uFF1F"),n("br"),c("\u522A\u9664\u5546\u54C1\u5C07\u7121\u6CD5\u5FA9\u539F\uFF01")],-1),Me={class:"col-12 row justify-around"},Ze={__name:"AdminMemberView",setup(Ee){const j=O(),{logout:D}=j,{isLogin:P}=Y(j),F=(s,e)=>"https://joeschmoe.io/api/v1//"+s+"/"+e;b(!0);const w=b(""),I=le(),T=b(!1),u=_([]),A=_({items:[],page:1,rowsPerPage:0}),a=_({_id:"",account:"",name:"",description:"",inventory:!1,sell:!1,price:0,image:[],idx:-1,dialog:!1}),p=_({required(s){return!!s||"\u5FC5\u586B\u6B04\u4F4D"},price(s){return s>-1||"\u50F9\u683C\u5FC5\u9808\u5927\u65BC\u6216\u7B49\u65BC 0"},size(s){var e,t,r;return!s||!s.length||((t=(e=s[0])==null?void 0:e.type)==null?void 0:t.includes("image"))&&((r=s[0])==null?void 0:r.size)<=1024*1024*2||"\u6A94\u6848\u683C\u5F0F\u4E0D\u7B26\uFF08\u9808\u70BA\u5716\u7247\u6A94\uFF0C\u4E14\u6A94\u6848\u5927\u5C0F 2 MB \u4EE5\u4E0B\uFF09"}}),g=_({dialog:!1}),$=b(""),U=s=>{$.value=s,g.dialog=!0},M=async s=>{g.dialog=!1;try{await z.delete("/products/"+s),await q.fire({icon:"success",title:"\u522A\u9664\u6210\u529F",text:"\u60A8\u5DF2\u6210\u529F\u522A\u9664\u5546\u54C1\uFF01"})}catch(e){q.fire({icon:"error",title:"\u522A\u9664\u5931\u6557",text:e.isAxiosError?e.response.data.message:e.message})}},y=(s,e)=>{a._id=s,e>-1?(a.name=u[e].name,a.description=u[e].description,a.inventory=u[e].inventory,a.sell=u[e].sell,a.price=u[e].price):(a.name="",a.description="",a.inventory=!1,a.sell=!1,a.price=0),a.image=[],a.idx=e,a.dialog=!0},E=[{name:"image",label:"\u6703\u54E1\u7167\u7247",align:"center"},{name:"account",label:"\u6703\u54E1\u5E33\u865F",align:"center",field:s=>s.account},{name:"role",label:"\u6703\u54E1\u8EAB\u4EFD",align:"center",field:s=>s.role===1?"\u7BA1\u7406\u8005":"\u4E00\u822C\u6703\u54E1"},{name:"name",label:"\u6703\u54E1\u59D3\u540D",align:"center",field:s=>s.name},{name:"tel",label:"\u6703\u54E1\u624B\u6A5F",align:"center",field:s=>s.tel},{name:"email",label:"\u6703\u54E1\u4FE1\u7BB1",align:"center",field:s=>s.email},{name:"control",label:"\u6703\u54E1\u7BA1\u7406",align:"center"}];return(async()=>{try{const{data:s}=await z.get("/users/all");u.push(...s.result)}catch(s){q.fire({icon:"error",title:"\u5931\u6557",text:s.isAxiosError?s.response.data.message:s.message})}})(),(s,e)=>(d(),m(G,{class:"column"},{default:o(()=>[n("div",oe,[l(H,{class:"text-h5 text-secondary mobile-none"},{default:o(()=>[x(P)?(d(),m(i,{key:0,round:"",dense:"",flat:"",icon:"fa-solid fa-house",to:"/",class:"q-mx-xs"},{default:o(()=>[l(B,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:o(()=>[ae]),_:1})]),_:1})):f("",!0),x(P)?(d(),m(i,{key:1,round:"",dense:"",flat:"",icon:"fa-solid fa-right-from-bracket",onClick:x(D),class:"q-ml-xl q-mr-lg"},{default:o(()=>[l(B,{"transition-show":"fade","transition-hide":"fade",offset:[0,0]},{default:o(()=>[ne]),_:1})]),_:1},8,["onClick"])):f("",!0)]),_:1})]),n("div",ie,[n("div",re,[de,l(i,{onClick:e[0]||(e[0]=t=>y("",-1)),square:"",flat:"",class:"col-auto q-mr-xl bg-secondary text-dark text-h6 q-my-sm createBtn"},{default:o(()=>[ce]),_:1})]),n("div",ue,[l(te,{grid:x(I).screen.lt.xl,columns:E,rows:u,"row-key":"name",square:"",bordered:"","wrap-cells":"","binary-state-sort":"",dense:"",filter:w.value,loading:T.value,pagination:A,"rows-per-page-label":"\u6BCF\u9801\u986F\u793A\u7B46\u6578","no-results-label":"Oops...\u627E\u4E0D\u5230\u8A72\u6703\u54E1"},{"body-cell-image":o(t=>[l(N,{img:t,align:"center",ellipsis:""},{default:o(()=>[l(X,{square:"",size:"100px"},{default:o(()=>[n("img",{src:F(t.row.gender===1?"male":"female",t.row.account),class:"q-mb-xl",style:{"object-fit":"cover"}},null,8,me)]),_:2},1024)]),_:2},1032,["img"])]),"top-right":o(()=>[l(v,{borderless:"",dense:"",debounce:"300",modelValue:w.value,"onUpdate:modelValue":e[1]||(e[1]=t=>w.value=t),placeholder:"\xA0Search",class:"search"},{append:o(()=>[l(V,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-control":o(t=>[l(N,{control:t},{default:o(()=>[n("div",fe,[l(i,{class:"col-auto q-mx-sm",onClick:e[2]||(e[2]=r=>y(s.edit.row._id,s.edit.rowIndex)),outline:""},{default:o(()=>[pe]),_:1}),l(i,{class:"col-auto q-mx-sm",onClick:e[3]||(e[3]=r=>y(s.edit.row._id,s.edit.rowIndex)),outline:""},{default:o(()=>[ge]),_:1}),l(i,{class:"col-auto q-mx-sm",onClick:e[4]||(e[4]=r=>U(s.edit.row._id)),outline:""},{default:o(()=>[_e]),_:1})])]),_:2},1032,["control"])]),pagination:o(t=>[t.pagesNumber>1?(d(),m(i,{key:0,icon:"first_page",color:"secondary",round:"",dense:"",flat:"",disable:t.isFirstPage,onClick:t.firstPage},null,8,["disable","onClick"])):f("",!0),l(i,{icon:"chevron_left",color:"secondary",round:"",dense:"",flat:"",disable:t.isFirstPage,onClick:t.prevPage},null,8,["disable","onClick"]),l(i,{icon:"chevron_right",color:"secondary",round:"",dense:"",flat:"",disable:t.isLastPage,onClick:t.nextPage},null,8,["disable","onClick"]),t.pagesNumber>1?(d(),m(i,{key:1,icon:"last_page",color:"secondary",round:"",dense:"",flat:"",disable:t.isLastPage,onClick:t.lastPage},null,8,["disable","onClick"])):f("",!0)]),"no-data":o(({message:t})=>[n("div",ye,[n("span",null,k(t),1)])]),item:o(t=>[n("div",be,[l(Q,{square:"",bordered:"",class:"bg-primary shadow"},{default:o(()=>[(d(!0),h(K,null,J(t.cols,r=>(d(),h("div",{key:r.name,class:"q-pa-sm"},[r.name=="image"?(d(),m(Z,{key:0,ratio:3/2},{default:o(()=>[n("img",{src:t.row[r.name],class:"col",style:{width:"100%"}},null,8,xe)]),_:2},1024)):r.name!=="image"&&r.name!=="edit"?(d(),h("div",ve,[n("div",ke,[n("span",he,k(r.label)+"\uFF1A",1),n("span",we,k(r.value),1)])])):r.name==="edit"?(d(),h("div",qe,[n("div",Ve,[n("span",Ce,k(r.label)+"\uFF1A",1),l(i,{class:"col-auto text-secondary",style:{"font-size":"xx-small",padding:"0px 8px"},onClick:R=>y(t.row._id,t.rowIndex),outline:""},{default:o(()=>[Qe]),_:2},1032,["onClick"])]),n("div",je,[l(i,{class:"col-auto text-secondary",style:{"font-size":"xx-small",padding:"0px 8px"},onClick:R=>U(t.row._id),outline:""},{default:o(()=>[Pe]),_:2},1032,["onClick"])])])):f("",!0)]))),128))]),_:2},1024)])]),loading:o(()=>[l(ee,{showing:"",dark:"","transition-show":"fade",color:"primary"})]),_:1},8,["grid","rows","filter","loading","pagination"])]),l(S,{modelValue:a.dialog,"onUpdate:modelValue":e[14]||(e[14]=t=>a.dialog=t),seamless:""},{default:o(()=>[a.dialog?(d(),m(Q,{key:0,id:"dialog",flat:"",square:"",bordered:"",persistent:"",class:"bg-info text-secondary shadow-white"},{default:o(()=>[l(W,{onSubmit:C(s.submitForm,["prevent"]),class:"q-pa-md"},{default:o(()=>[$e,l(v,{modelValue:a.name,"onUpdate:modelValue":e[5]||(e[5]=t=>a.name=t),rules:[p.required],type:"text",outlined:"",square:"",dense:""},null,8,["modelValue","rules"]),Ue,l(v,{modelValue:a.description,"onUpdate:modelValue":e[6]||(e[6]=t=>a.description=t),rules:[p.required],type:"textarea",outlined:"",square:"",dense:""},null,8,["modelValue","rules"]),n("div",ze,[n("div",Be,[Le,l(L,{class:"col-6 text-dark",modelValue:a.inventory,"onUpdate:modelValue":e[7]||(e[7]=t=>a.inventory=t),label:a.inventory?"\u6709\u73FE\u8CA8":"\u6C92\u73FE\u8CA8"},null,8,["modelValue","label"])]),n("div",Ne,[Se,l(L,{class:"col-6 text-dark",modelValue:a.sell,"onUpdate:modelValue":e[8]||(e[8]=t=>a.sell=t),label:a.sell?"\u4E0A\u67B6":"\u4E0B\u67B6"},null,8,["modelValue","label"])])]),De,l(v,{modelValue:a.price,"onUpdate:modelValue":e[9]||(e[9]=t=>a.price=t),modelModifiers:{number:!0},min:"0",rules:[p.required,p.price],outlined:"",square:"",dense:"",class:"text-primary"},null,8,["modelValue","rules"]),Fe,l(se,{modelValue:a.image,"onUpdate:modelValue":e[12]||(e[12]=t=>a.image=t),multiple:"",rules:[p.size],accept:"image/*",filled:"","bottom-slots":"",counter:""},{prepend:o(()=>[l(V,{name:"cloud_upload",onClick:e[10]||(e[10]=C(()=>{},["stop","prevent"]))})]),append:o(()=>[l(V,{name:"close",onClick:e[11]||(e[11]=C(t=>s.model=null,["stop","prevent"])),class:"cursor-pointer"})]),hint:o(()=>[]),_:1},8,["modelValue","rules"]),n("div",Ie,[l(i,{square:"",flat:"",type:"submit",class:"col-4 bg-secondary text-dark q-my-sm",label:"\u9001\u51FA\u7DE8\u8F2F"}),l(i,{square:"",flat:"",outline:"",class:"col-4 bg-dark text-secondary q-my-sm",label:"\u53D6\u6D88",onClick:e[13]||(e[13]=t=>a.dialog=!1)})])]),_:1},8,["onSubmit"])]),_:1})):f("",!0)]),_:1},8,["modelValue"]),l(S,{modelValue:g.dialog,"onUpdate:modelValue":e[17]||(e[17]=t=>g.dialog=t),seamless:"",persistent:""},{default:o(()=>[l(Q,{square:"",class:"row justify-center bg-info q-pa-lg"},{default:o(()=>[Te,Ae,n("div",Me,[l(i,{onClick:e[15]||(e[15]=t=>M($.value)),square:"",flat:"",class:"col-4 bg-secondary text-dark q-my-sm",label:"\u78BA\u5B9A\u522A\u9664\u5546\u54C1"}),l(i,{square:"",flat:"",outline:"",class:"col-4 bg-dark text-secondary q-my-sm",label:"\u53D6\u6D88",onClick:e[16]||(e[16]=t=>g.dialog=!1)})])]),_:1})]),_:1},8,["modelValue"])])]),_:1}))}};export{Ze as default};
